using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using Common;
using SharedMemory;
using VisionProcessing;
using Microsoft.Win32;
using System.IO;
namespace VisionProcessForm
{
    public partial class LearnPadPackageForm : Form
    {
        #region Member Variables
        private bool m_blnSaveButtonVisible = true;
        private bool m_blnSetToAllCheckboxVisible_Package = true;
        private bool m_blnSetToAllCheckboxVisible_Chipped = true;
        private bool m_blnSetToAllCheckboxVisible_Mold = true;
        private bool m_blnSetToAllCheckboxVisible_ForeignMaterial = true;

        private int m_intLearnType = 0; // 0 = Learn All, 1 : Gauge ROI, 2 : Package ROI Tolerance, 3 : Chipped Off ROI Tolerance, 4 : Mold Flash ROI Tolerance, 5 : Dont Care ROI
        private int m_intSelectedDontCareROIIndexPrev = 0;
        private Point m_pPkgTop, m_pPkgRight, m_pPkgBottom, m_pPkgLeft;
        private Point m_pForeignMaterialTop, m_pForeignMaterialRight, m_pForeignMaterialBottom, m_pForeignMaterialLeft;
        private Point m_pChippedTop, m_pChippedRight, m_pChippedBottom, m_pChippedLeft;
        private Point m_pMoldTop, m_pMoldRight, m_pMoldBottom, m_pMoldLeft;
        private bool m_blnUpdateSelectedROISetting = false;
        private bool m_blnInitGaugeAngle = false;
        private bool m_blnInitDone = false;
        private bool m_blnUserRightEnableGaugeSetting = true;
        private bool m_blnDisablePkgGaugeSetting = true;    // For advance setting
        private bool m_blnIgnoreComboboxIndexChange = false;
        private int m_intDisplayStep;
        private int m_intSelectedROIPrev = -1;
        private int m_intUserGroup;
        private float m_fStartPixelFromEdgePrev_ForeignMaterial = -1;
        private float m_fStartPixelFromRightPrev_ForeignMaterial = -1;
        private float m_fStartPixelFromBottomPrev_ForeignMaterial = -1;
        private float m_fStartPixelFromLeftPrev_ForeignMaterial = -1;
        private float m_fStartPixelFromEdgePrev = -1;
        private float m_fStartPixelFromRightPrev = -1;
        private float m_fStartPixelFromBottomPrev = -1;
        private float m_fStartPixelFromLeftPrev = -1;
        private float m_fStartPixelFromEdgePrev_Dark = -1;
        private float m_fStartPixelFromRightPrev_Dark = -1;
        private float m_fStartPixelFromBottomPrev_Dark = -1;
        private float m_fStartPixelFromLeftPrev_Dark = -1;
        private float m_fStartPixelFromEdgePrev_Chipped = -1;
        private float m_fStartPixelFromRightPrev_Chipped = -1;
        private float m_fStartPixelFromBottomPrev_Chipped = -1;
        private float m_fStartPixelFromLeftPrev_Chipped = -1;
        private float m_fStartPixelExtendFromEdgePrev_Chipped = -1;
        private float m_fStartPixelExtendFromRightPrev_Chipped = -1;
        private float m_fStartPixelExtendFromBottomPrev_Chipped = -1;
        private float m_fStartPixelExtendFromLeftPrev_Chipped = -1;
        private float m_fStartPixelFromEdgePrev_Chipped_Dark = -1;
        private float m_fStartPixelFromRightPrev_Chipped_Dark = -1;
        private float m_fStartPixelFromBottomPrev_Chipped_Dark = -1;
        private float m_fStartPixelFromLeftPrev_Chipped_Dark = -1;
        private float m_fStartPixelExtendFromEdgePrev_Chipped_Dark = -1;
        private float m_fStartPixelExtendFromRightPrev_Chipped_Dark = -1;
        private float m_fStartPixelExtendFromBottomPrev_Chipped_Dark = -1;
        private float m_fStartPixelExtendFromLeftPrev_Chipped_Dark = -1;
        private float m_fStartPixelFromEdgePrev_Mold = -1;
        private float m_fStartPixelFromRightPrev_Mold = -1;
        private float m_fStartPixelFromBottomPrev_Mold = -1;
        private float m_fStartPixelFromLeftPrev_Mold = -1;
        private float m_fStartPixelFromEdgeInnerPrev_Mold = -1;
        private float m_fStartPixelFromRightInnerPrev_Mold = -1;
        private float m_fStartPixelFromBottomInnerPrev_Mold = -1;
        private float m_fStartPixelFromLeftInnerPrev_Mold = -1;
        private string m_strFolderPath = "";
        private string m_strFolderPathPkg = "";
        private string m_strSelectedRecipe;
        private VisionInfo m_smVisionInfo;
        private CustomOption m_smCustomizeInfo;
        private ProductionInfo m_smProductionInfo;
        private UserRight m_objUserRight = new UserRight();
        private AdvancedRectGauge4LPadForm m_objAdvancedRectGauge4LForm = null;
        
        #endregion

        public LearnPadPackageForm(VisionInfo smVisionInfo, CustomOption smCustomizeInfo, string strSelectedRecipe, int intUserGroup, ProductionInfo smProductionInfo, int intLearnType)
        {
            m_smProductionInfo = smProductionInfo;
            m_intUserGroup = intUserGroup;
            m_strSelectedRecipe = strSelectedRecipe;
            m_smVisionInfo = smVisionInfo;
            m_smCustomizeInfo = smCustomizeInfo;
            
            m_intDisplayStep = 1;
            m_intLearnType = intLearnType;
            m_strFolderPath = m_smProductionInfo.g_strRecipePath + strSelectedRecipe +
                "\\" + m_smVisionInfo.g_strVisionFolderName + "\\Pad\\";
            m_strFolderPathPkg = m_smProductionInfo.g_strRecipePath + strSelectedRecipe +
              "\\" + m_smVisionInfo.g_strVisionFolderName + "\\Package\\";


            InitializeComponent();


            if (m_smVisionInfo.g_strVisionName == "PadPkg" || (m_smVisionInfo.g_arrPad.Length > 1 && !m_smVisionInfo.g_blnCheck4Sides))
            {
                pnl_Thickness.Visible = false;
            }
            else
            {
                pnl_Thickness.Visible = true;
            }

            DisableField2();
            //UpdateGUI();
            CustomizeGUI();

            m_pPkgTop = new Point(pnl_PkgTop.Location.X, pnl_PkgTop.Location.Y);
            m_pPkgRight = new Point(pnl_PkgRight.Location.X, pnl_PkgRight.Location.Y);
            m_pPkgBottom = new Point(pnl_PkgBottom.Location.X, pnl_PkgBottom.Location.Y);
            m_pPkgLeft = new Point(pnl_PkgLeft.Location.X, pnl_PkgLeft.Location.Y);

            m_pForeignMaterialTop = new Point(pnl_ForeignMaterialTop.Location.X, pnl_ForeignMaterialTop.Location.Y);
            m_pForeignMaterialRight = new Point(pnl_ForeignMaterialRight.Location.X, pnl_ForeignMaterialRight.Location.Y);
            m_pForeignMaterialBottom = new Point(pnl_ForeignMaterialBottom.Location.X, pnl_ForeignMaterialBottom.Location.Y);
            m_pForeignMaterialLeft = new Point(pnl_ForeignMaterialLeft.Location.X, pnl_ForeignMaterialLeft.Location.Y);

            m_pChippedTop = new Point(grpbox_ChippedTop.Location.X, grpbox_ChippedTop.Location.Y);
            m_pChippedRight = new Point(grpbox_ChippedRight.Location.X, grpbox_ChippedRight.Location.Y);
            m_pChippedBottom = new Point(grpbox_ChippedBottom.Location.X, grpbox_ChippedBottom.Location.Y);
            m_pChippedLeft = new Point(grpbox_ChippedLeft.Location.X, grpbox_ChippedLeft.Location.Y);

            m_pMoldTop = new Point(grp_MoldTop.Location.X, grp_MoldTop.Location.Y);
            m_pMoldRight = new Point(grp_MoldRight.Location.X, grp_MoldRight.Location.Y);
            m_pMoldBottom = new Point(grp_MoldBottom.Location.X, grp_MoldBottom.Location.Y);
            m_pMoldLeft = new Point(grp_MoldLeft.Location.X, grp_MoldLeft.Location.Y);

            switch (m_intLearnType)
            {
                case 0:
                    m_smVisionInfo.g_intLearnStepNo = 0;
                    break;
                case 1:
                    m_smVisionInfo.g_intLearnStepNo = 0;
                    break;
                case 2:
                    m_smVisionInfo.g_intLearnStepNo = 0;// Step 0 --> 1
                    break;
                case 3:
                    m_smVisionInfo.g_intLearnStepNo = 0;// Step 0 --> 2
                    break;
                case 4:
                    m_smVisionInfo.g_intLearnStepNo = 0;// Step 0 --> 3
                    break;
                case 5:
                    m_smVisionInfo.g_intLearnStepNo = 0;// Step 0 --> 11
                    break;
            }

            m_blnInitDone = true;
        }

        private void DisableField2()
        {
            m_intUserGroup = m_smProductionInfo.g_intUserGroup; // 2020-05-21 ZJYEOH : Need real time user group value as now got auto logout feature


            string strChild1 = "Package";
            string strChild2 = "Learn Page";
            string strChild3 = "Save Button";
            if (m_smVisionInfo.g_strVisionName == "BottomOrientPad" || m_smVisionInfo.g_strVisionName == "BottomOPadPkg")
            {
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetOrientationChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_GaugeSaveClose.Enabled = false; btn_GaugeSaveClose.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    btn_Save.Enabled = false; btn_Save.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnSaveButtonVisible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }
            }
            else
            {
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_GaugeSaveClose.Enabled = false; btn_GaugeSaveClose.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    btn_Save.Enabled = false; btn_Save.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnSaveButtonVisible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Gauge Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_GaugeAdvanceSetting.Enabled = false; btn_GaugeAdvanceSetting.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_ShowSamplePoints.Enabled = false; chk_ShowSamplePoints.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_ShowDraggingBox.Enabled = false; chk_ShowDraggingBox.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnUserRightEnableGaugeSetting = false;
                }

                strChild3 = "Package ROI Tolerance Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    pnl_PkgTop.Enabled = false; pnl_PkgTop.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_PkgRight.Enabled = false; pnl_PkgRight.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_PkgBottom.Enabled = false; pnl_PkgBottom.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_PkgLeft.Enabled = false; pnl_PkgLeft.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAll.Enabled = false; chk_SetToAll.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAllSideROI.Enabled = false; chk_SetToAllSideROI.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToBrightDark.Enabled = false; chk_SetToBrightDark.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    cbo_PkgDefectType.Enabled = false; cbo_PkgDefectType.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    lbl_PkgROIDefectType.Visible = srmLabel39.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnSetToAllCheckboxVisible_Package = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Chipped Off ROI Tolerance Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    grpbox_ChippedTop.Enabled = false; grpbox_ChippedTop.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grpbox_ChippedRight.Enabled = false; grpbox_ChippedRight.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grpbox_ChippedBottom.Enabled = false; grpbox_ChippedBottom.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grpbox_ChippedLeft.Enabled = false; grpbox_ChippedLeft.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAll_Chipped.Enabled = false; chk_SetToAll_Chipped.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAllSideROI_Chipped.Enabled = false; chk_SetToAllSideROI_Chipped.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToBrightDark_Chip.Enabled = false; chk_SetToBrightDark_Chip.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    cbo_ChippedOffDefectType.Enabled = false; cbo_ChippedOffDefectType.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    srmLabel16.Visible = srmLabel1.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnSetToAllCheckboxVisible_Chipped = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Mold Flash ROI Tolerance Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    grp_MoldTop.Enabled = false; grp_MoldTop.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grp_MoldRight.Enabled = false; grp_MoldRight.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grp_MoldBottom.Enabled = false; grp_MoldBottom.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    grp_MoldLeft.Enabled = false; grp_MoldLeft.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAll_Mold.Enabled = false; chk_SetToAll_Mold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAllSideROI_Mold.Enabled = false; chk_SetToAllSideROI_Mold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    srmLabel28.Visible = false;
                    m_blnSetToAllCheckboxVisible_Mold = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Foreign Material ROI Tolerance Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    pnl_ForeignMaterialTop.Enabled = false; pnl_ForeignMaterialTop.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_ForeignMaterialRight.Enabled = false; pnl_ForeignMaterialRight.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_ForeignMaterialBottom.Enabled = false; pnl_ForeignMaterialBottom.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    pnl_ForeignMaterialLeft.Enabled = false; pnl_ForeignMaterialLeft.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAll_ForeignMaterial.Enabled = false; chk_SetToAll_ForeignMaterial.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_SetToAllSideROI_ForeignMaterial.Enabled = false; chk_SetToAllSideROI_ForeignMaterial.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    srmLabel76.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    m_blnSetToAllCheckboxVisible_ForeignMaterial = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Bright Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    txt_BrightMinArea.Enabled = false; srmLabel56.Visible = txt_BrightMinArea.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Bright Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_BrightThreshold.Enabled = false; pnl_BrightThreshold.Visible = btn_BrightThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!txt_BrightMinArea.Enabled)
                    {
                        lbl_Image2_BrightField_Simple.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_Bright.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Dark Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    txt_DarkMinArea.Enabled = false; srmLabel61.Visible = txt_DarkMinArea.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Dark Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_DarkThreshold.Enabled = false; pnl_DarkThreshold.Visible = btn_DarkThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!txt_DarkMinArea.Enabled)
                    {
                        lbl_Image3_DarkField_Simple.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_Dark.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Crack Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    txt_CrackViewMinArea.Enabled = false; srmLabel41.Visible = txt_CrackViewMinArea.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Crack Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_CrackViewThreshold.Enabled = false; pnl_CrackViewThreshold.Visible = btn_CrackViewThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!txt_CrackViewMinArea.Enabled)
                    {
                        srmLabel55.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_DarkCrack.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Chipped Off Bright Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    srmInputBox5.Enabled = false; srmLabel51.Visible = srmInputBox5.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Chipped Off Bright Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_Image1SurfaceThreshold.Enabled = false; pnl_Image1SurfaceThreshold.Visible = btn_Image1SurfaceThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!srmInputBox5.Enabled)
                    {
                        srmLabel57.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_BrightChip.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Chipped Off Dark Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    srmInputBox4.Enabled = false; srmLabel48.Visible = srmInputBox4.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Chipped Off Dark Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_Image2Threshold.Enabled = false; pnl_Image2Threshold.Visible = btn_Image2Threshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!srmInputBox4.Enabled)
                    {
                        srmLabel52.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_DarkChip.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Mold Flash Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    srmInputBox2.Enabled = false; srmLabel44.Visible = srmInputBox2.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Mold Flash Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_MoldFlashThreshold.Enabled = false; pnl_MoldFlashThreshold.Visible = btn_MoldFlashThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!srmInputBox2.Enabled)
                    {
                        srmLabel53.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_BrightMold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Foreign Material Defect Min Area";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    txt_ForeignMaterialMinArea.Enabled = false; srmLabel62.Visible = txt_ForeignMaterialMinArea.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

                strChild3 = "Foreign Material Defect Threshold";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    btn_ForeignMaterialThreshold.Enabled = false; pnl_ForeignMaterialThreshold.Visible = btn_ForeignMaterialThreshold.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    if (!txt_ForeignMaterialMinArea.Enabled)
                    {
                        srmLabel67.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                        gb_BrightForeign.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    }
                }

                strChild3 = "Dont Care Area Setting";
                if (m_smProductionInfo.g_intUserGroup > m_smCustomizeInfo.objNewUserRight.GetPadChild3Group(strChild1, strChild2, strChild3))
                {
                    radio_Bright.Enabled = false; radio_Bright.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    radio_Dark.Enabled = false; radio_Dark.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    cbo_DontCareAreaDrawMethod.Enabled = false; cbo_DontCareAreaDrawMethod.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    chk_BrightAndDarkSameDontCareArea.Enabled = false; chk_BrightAndDarkSameDontCareArea.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    btn_Undo.Enabled = false; btn_Undo.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    btn_AddDontCareROI.Enabled = false; btn_AddDontCareROI.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                    btn_DeleteDontCareROI.Enabled = false; btn_DeleteDontCareROI.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;

                    lbl_DontCareAreaMode.Visible = lbl_DeleteButton.Visible = lbl_AddButton.Visible = lbl_DrawMethod.Visible = m_smProductionInfo.g_blnShowGUIForBelowUserRight;
                }

            }
        }
        private void DisableField()
        {
            string strChild1 = "Learn Page";
            string strChild2 = "Save Button";
            if (m_intUserGroup > m_objUserRight.GetGroupLevel3(strChild1, strChild2))
            {
                btn_Save.Enabled = false;
                btn_GaugeSaveClose.Enabled = false;
            }
        }

        private void AddGauge(ROI objSearchROI, List<RectGauge> arrGauge, string strVisionModule)
        {
            XmlParser objFile = new XmlParser(m_smProductionInfo.g_strRecipePath + m_strSelectedRecipe + "\\" +
                    m_smVisionInfo.g_strVisionFolderName + "\\" + strVisionModule + "\\Gauge.xml");
            objFile.GetFirstSection("RectG");

            //create new gauge and attach to selected ROI
            RectGauge objGauge = new RectGauge(m_smVisionInfo.g_WorldShape);

            //attach searcher parent
            objGauge.SetRectGaugePlacement(objSearchROI, objFile.GetValueAsFloat("Tolerance", 25),
                objFile.GetValueAsInt("SizeTolerance", 10));

            //set gauge measurement
            objGauge.ref_GaugeTransType = objFile.GetValueAsInt("TransType", 0);
            objGauge.ref_GaugeTransChoice = objFile.GetValueAsInt("TransChoice", 0);

            //set gauge setting
            objGauge.SetRectGaugeSetting(objFile.GetValueAsInt("Thickness", 13), objFile.GetValueAsInt("Filter", 1),
                objFile.GetValueAsInt("Threshold", 2), objFile.GetValueAsInt("MinAmp", 10), objFile.GetValueAsInt("MinArea", 0));

            //set gauge fitting sampling step
            objGauge.SetRectGaugeFitting(objFile.GetValueAsInt("SamplingStep", 5));

            arrGauge.Add(objGauge);
        }

        /// <summary>
        /// Add search ROI (center, top, right, bottom, left pad roi)
        /// </summary>
        /// <param name="arrROIs">ROI</param>
        private void AddSearchROI(List<List<ROI>> arrROIs)
        {
            ROI objROI;

            for (int i = 0; i < arrROIs.Count; i++)
            {
                if (arrROIs[i].Count == 0)
                {
                    if (i == 0)
                    {
                        objROI = new ROI("Center Pad ROI", 1);
                        int intPositionX = 640 - (640 / (m_smVisionInfo.g_intUnitsOnImage * 2)) - 80;
                        int intPositionY = (480 / 2) - 80;
                        objROI.LoadROISetting(intPositionX, intPositionY, 170, 170);
                    }
                    else if (i == 1)
                    {
                        objROI = new ROI("T", 1);
                        int intPostX = 640 - (640 / (m_smVisionInfo.g_intUnitsOnImage * 2)) - 65;
                        int intPostY = (480 / 2) - 180;
                        objROI.LoadROISetting(intPostX, intPostY, 150, 50);
                    }
                    else if (i == 2)
                    {
                        objROI = new ROI("R", 1);
                        int intPostXR = 640 - (640 / (m_smVisionInfo.g_intUnitsOnImage * 2)) + 120;
                        int intPostYR = (480 / 2) - 70;
                        objROI.LoadROISetting(intPostXR, intPostYR, 50, 150);
                    }
                    else if (i == 3)
                    {
                        objROI = new ROI("B", 1);
                        int intPostXB = 640 - (640 / (m_smVisionInfo.g_intUnitsOnImage * 2)) - 65;
                        int intPostYB = (480 / 2) + 120;
                        objROI.LoadROISetting(intPostXB, intPostYB, 150, 50);
                    }
                    else
                    {
                        objROI = new ROI("L", 1);
                        int intPostXL = 640 - (640 / (m_smVisionInfo.g_intUnitsOnImage * 2)) - 170;
                        int intPostYL = (480 / 2) - 70;
                        objROI.LoadROISetting(intPostXL, intPostYL, 50, 150);
                    }

                    objROI.AttachImage(m_smVisionInfo.g_arrImages[0]);
                    arrROIs[i].Add(objROI);
                }
            }
        }

        /// <summary>
        /// Add search ROI (center, top, right, bottom, left train roi)
        /// </summary>
        /// <param name="arrROIs">ROI</param>
        private void AddTrainUnitROI(List<List<ROI>> arrROIs)
        {
            ROI objROI;

            for (int i = 0; i < arrROIs.Count; i++)
            {
                if (arrROIs[i].Count == 0)
                {
                    SRMMessageBox.Show("Search ROI no exist!");
                    return;
                }

                if (arrROIs[i].Count == 1)
                {
                    if (i == 0)
                        objROI = new ROI("Gauge ROI", 2);
                    else if (i == 1)
                        objROI = new ROI("T", 2);
                    else if (i == 2)
                        objROI = new ROI("R", 2);
                    else if (i == 3)
                        objROI = new ROI("B", 2);
                    else
                        objROI = new ROI("L", 2);

                    arrROIs[i].Add(objROI);
                    arrROIs[i][1].AttachImage(arrROIs[i][0]);
                }
            }
        }

        private void AddTrainPackageROI(List<List<ROI>> arrROIs)
        {
            ROI objROI;

            for (int i = 0; i < arrROIs.Count; i++)
            {
                if (arrROIs[i].Count == 0)
                {
                    SRMMessageBox.Show("Search ROI no exist!");
                    return;
                }

                if (arrROIs[i].Count == 1)
                {
                    SRMMessageBox.Show("Unit ROI no exist!");
                }

                if (arrROIs[i].Count == 2)
                {
                    objROI = new ROI("Pkg ROI", 2);
                    arrROIs[i].Add(objROI);
                }

                arrROIs[i][2].AttachImage(arrROIs[i][0]);

                /*
                 * Algorithm:
                 * - Image 1 using side light, image 2 using coaxial light
                 * - Center Pad background is always dark color for image 1 and 2 except when pickup head side is bigger than unit size especially for very small package. 
                 * - Side Pad background is dark color for image 1 but light color for image 2.
                 * - When unit background is dark color, SizeTolerance of Unit ROI can set to 10.
                 * - When unit background is light color, SizeTolerance of Unit ROI must set to 0 
                 *   because if Unit ROI size bigger then physical unit size, then vision will confuse the unit backgroudn as pad objects.
                 */

                int intSizeTolerance = 0;
                // Set Package ROI location and size base on RectGauge4L measurement
                //if ((m_smVisionInfo.g_blnCheckPackage && ((m_smCustomizeInfo.g_intWantPackage & (1 << m_smVisionInfo.g_intVisionPos)) > 0)) ||
                //    (m_smVisionInfo.g_arrPad[i].ref_blnWantGaugeMeasurePkgSize && ((m_smCustomizeInfo.g_intWantPackage & (1 << m_smVisionInfo.g_intVisionPos)) == 0)))
                //if (chk_UseGauge.Checked)
                //{
                bool blnUnitBackgroundPickupHeadColorIsBlack = false; // Unit backgound is black when pickup size smaller than unit.
                int intPkgSizeTolerance;

                if (m_smVisionInfo.g_intSelectedImage == 0) // Image 1 where center pad and side pad background are dark 
                {
                    if (i == 0) // Center ROI
                    {
                        if (blnUnitBackgroundPickupHeadColorIsBlack)
                            intPkgSizeTolerance = intSizeTolerance;    // for pickup head size smaller than unit size, Set package ROI size 3 pixel higher than RectGauge4L measurement
                        else
                            intPkgSizeTolerance = 0;    // for pickup head size bigger than unit size, set tolerance to 0. Since the background of unit is white color, tolerance of unit cannot add. or else it will be recognized as defect area.
                    }
                    else
                        intPkgSizeTolerance = intSizeTolerance;
                }
                else // Image 2 where center pad background is dark but side pad background is light. 
                {
                    if (i == 0) // Center ROI
                    {
                        if (blnUnitBackgroundPickupHeadColorIsBlack)
                            intPkgSizeTolerance = intSizeTolerance;    // for pickup head size smaller than unit size, Set package ROI size 3 pixel higher than RectGauge4L measurement
                        else
                            intPkgSizeTolerance = 0;    // for pickup head size bigger than unit size, set tolerance to 0. Since the background of unit is white color, tolerance of unit cannot add. or else it will be recognized as defect area.
                    }
                    else
                        intPkgSizeTolerance = 0;
                }



                //arrROIs[i][2].LoadROISetting(
                //   (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //   (m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //    arrROIs[i][0].ref_ROITotalX - intPkgSizeTolerance, 0, MidpointRounding.AwayFromZero),
                //   (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //   (m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                //   arrROIs[i][0].ref_ROITotalY - intPkgSizeTolerance, 0, MidpointRounding.AwayFromZero),
                //   (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) + intPkgSizeTolerance * 2),
                //   (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) + intPkgSizeTolerance * 2));

                //      m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //  m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX  + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                // m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom));

                m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
     (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
     (m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
       m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX),//- (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
     (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
     (m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
      m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY),//- (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
     (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0)),//+ (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight),
     (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0)));//+ (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom));

                //}
                //else
                //{
                //    // since gauge is not use, so set gauge roi (arrROIs index 1)size to pkg roi.
                //    arrROIs[i][2].LoadROISetting(arrROIs[i][1].ref_ROIPositionX, arrROIs[i][1].ref_ROIPositionY,
                //        arrROIs[i][1].ref_ROIWidth, arrROIs[i][1].ref_ROIHeight);


                //}

                if (i > 0)  // For side pad only
                {
                    // Logic Max image 1 and image 2 when WantConsiderPadImage2 is true
                    if (m_smVisionInfo.g_arrPad[i].ref_blnWantConsiderPadImage2)
                    {
                        int intInternalSizeTolerance = 5;
                        ROI objImage2InternalROI = new ROI();
                        if (m_smVisionInfo.g_blnViewRotatedImage)
                            objImage2InternalROI.AttachImage(m_smVisionInfo.g_arrRotatedImages[1]);
                        else
                            objImage2InternalROI.AttachImage(m_smVisionInfo.g_arrImages[1]);

                        objImage2InternalROI.LoadROISetting(
                            (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                           (m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) +
                           intInternalSizeTolerance, 0, MidpointRounding.AwayFromZero),
                           (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                           (m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) +
                           intInternalSizeTolerance, 0, MidpointRounding.AwayFromZero),
                           (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - intInternalSizeTolerance * 2),
                           (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - intInternalSizeTolerance * 2));

                        ROI objImage1InternalROI = new ROI();
                        if (m_smVisionInfo.g_blnViewRotatedImage)
                            objImage1InternalROI.AttachImage(m_smVisionInfo.g_arrRotatedImages[0]);
                        else
                            objImage1InternalROI.AttachImage(m_smVisionInfo.g_arrImages[0]);

                        objImage1InternalROI.LoadROISetting(
                            (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                           (m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) +
                           intInternalSizeTolerance, 0, MidpointRounding.AwayFromZero),
                           (int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                           (m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) +
                           intInternalSizeTolerance, 0, MidpointRounding.AwayFromZero),
                           (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - intInternalSizeTolerance * 2),
                           (int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - intInternalSizeTolerance * 2));

                        ROI.MaxROI(objImage1InternalROI, objImage2InternalROI, ref objImage1InternalROI);
                    }
                }
            }
        }

        private void AttachImageToROI(List<List<ROI>> arrROIs, ImageDrawing objImage)
        {
            for (int i = 0; i < arrROIs.Count; i++)
            {
                for (int j = 0; j < arrROIs[i].Count; j++)
                {
                    ROI objROI = arrROIs[i][j];

                    switch (objROI.ref_intType)
                    {
                        case 1:
                            objROI.AttachImage(objImage);
                            break;
                        case 2:
                            objROI.AttachImage(arrROIs[i][0]);
                            break;
                        case 3:
                            objROI.AttachImage(arrROIs[i][1]);
                            break;
                    }

                }
            }
        }

        private void LoadGaugeSetting(string strPath, List<RectGauge> arrGauge)
        {
            arrGauge.Clear();

            XmlParser objFile = new XmlParser(strPath);
            RectGauge objRectGauge;
            int intParentCount = objFile.GetFirstSectionCount();

            for (int j = 0; j < m_smVisionInfo.g_intUnitsOnImage; j++)
            {
                if (j >= intParentCount)
                    continue;

                //create new ROI base on file read out
                objRectGauge = new RectGauge(m_smVisionInfo.g_WorldShape);
                objRectGauge.LoadGauge(strPath, "RectG" + j);

                //objFile.GetFirstSection("RectG" + j);

                ////set location,size,tolerance to place rect gauge
                //objRectGauge.SetRectGaugePlacement(
                //    objFile.GetValueAsFloat("CenterX", 0), objFile.GetValueAsFloat("CenterY", 0),
                //    objFile.GetValueAsFloat("Width", 100), objFile.GetValueAsFloat("Height", 100),
                //    objFile.GetValueAsFloat("Tolerance", 25), objFile.GetValueAsInt("SizeTolerance", 10));

                ////set type and choice of measure
                //objRectGauge.SetRectGaugeMeasurement(objFile.GetValueAsInt("TransType", 0), objFile.GetValueAsInt("TransChoice", 0));

                ////set gauge setting for analysis
                //objRectGauge.SetRectGaugeSetting(objFile.GetValueAsInt("Thickness", 13), objFile.GetValueAsInt("Filter", 1),
                //    objFile.GetValueAsInt("Threshold", 2), objFile.GetValueAsInt("MinAmp", 10), objFile.GetValueAsInt("MinArea", 0));

                ////set sampling step,interval 
                //objRectGauge.SetRectGaugeFitting(objFile.GetValueAsInt("SamplingStep", 5));

                ////Set rect gauge template
                //objRectGauge.SetRectGaugeTemplate(objFile.GetValueAsFloat("ObjectCenterX", 0),
                //    objFile.GetValueAsFloat("ObjectCenterY", 0), objFile.GetValueAsFloat("ObjectWidth", 0),
                //    objFile.GetValueAsFloat("ObjectHeight", 0));

                //add Rect Gauge into shared memory's Rect Gauge array list 
                arrGauge.Add(objRectGauge);
            }

            objRectGauge = null;
        }

        /// <summary>
        /// Load pad settings from selected path
        /// </summary>
        /// <param name="strPath">selected path</param>
        private void LoadPadSetting(string strPath)
        {
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == 0)
                {
                    m_smVisionInfo.g_arrPad[i].SetCalibrationData(
                                                  m_smVisionInfo.g_fCalibPixelX,
                                                  m_smVisionInfo.g_fCalibPixelY,
                                                  m_smVisionInfo.g_fCalibOffSetX,
                                                  m_smVisionInfo.g_fCalibOffSetY, m_smCustomizeInfo.g_intUnitDisplay);
                }
                else
                {
                    m_smVisionInfo.g_arrPad[i].SetCalibrationData(
                                                  m_smVisionInfo.g_fCalibPixelZ,
                                                  m_smVisionInfo.g_fCalibPixelZ,
                                                  m_smVisionInfo.g_fCalibOffSetZ,
                                                  m_smVisionInfo.g_fCalibOffSetZ, m_smCustomizeInfo.g_intUnitDisplay);
                }

                XmlParser objFile;
                // Load Pad Advance Setting
                objFile = new XmlParser(strPath + "Settings.xml");
                objFile.GetFirstSection("Advanced");
                m_smVisionInfo.g_arrPad[i].ref_blnWhiteOnBlack = objFile.GetValueAsBoolean("WhiteOnBlack", true, 1);

                // Load Pad Template Setting
                string strSectionName = "";
                if (i == 0)
                    strSectionName = "CenterROI";
                else if (i == 1)
                    strSectionName = "TopROI";
                else if (i == 2)
                    strSectionName = "RightROI";
                else if (i == 3)
                    strSectionName = "BottomROI";
                else if (i == 4)
                    strSectionName = "LeftROI";

                m_smVisionInfo.g_arrPad[i].LoadPad(strPath + "Template\\Template.xml", strSectionName);

                m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.LoadRectGauge4L(strPath + "RectGauge4L.xml",
                                                              "Pad" + i.ToString(), false);
            }
        }

        private void LoadROISetting(string strPath, List<List<ROI>> arrROIs, int intROICount)
        {
            arrROIs.Clear();

            XmlParser objFile = new XmlParser(strPath);
            int intChildCount;
            ROI objROI;

            for (int i = 0; i < intROICount; i++)
            {
                arrROIs.Add(new List<ROI>());
                objFile.GetFirstSection("Unit" + i);
                intChildCount = objFile.GetSecondSectionCount();
                for (int j = 0; j < intChildCount; j++)
                {
                    objROI = new ROI();
                    objFile.GetSecondSection("ROI" + j);
                    objROI.ref_strROIName = objFile.GetValueAsString("Name", "", 2);
                    objROI.ref_intType = objFile.GetValueAsInt("Type", 4, 2);
                    objROI.ref_ROIPositionX = objFile.GetValueAsInt("PositionX", 0, 2);
                    objROI.ref_ROIPositionY = objFile.GetValueAsInt("PositionY", 0, 2);
                    objROI.ref_ROIWidth = objFile.GetValueAsInt("Width", 100, 2);
                    objROI.ref_ROIHeight = objFile.GetValueAsInt("Height", 100, 2);
                    objROI.ref_intStartOffsetX = objFile.GetValueAsInt("StartOffsetX", 0, 2);
                    objROI.ref_intStartOffsetY = objFile.GetValueAsInt("StartOffsetY", 0, 2);
                    objROI.SetROIPixelAverage(objFile.GetValueAsFloat("AreaPixel", 100.0f, 2));
                    if (objROI.ref_intType > 1)
                    {
                        objROI.ref_ROIOriPositionX = objROI.ref_ROIPositionX;
                        objROI.ref_ROIOriPositionY = objROI.ref_ROIPositionY;
                    }

                    arrROIs[i].Add(objROI);
                }
            }
        }
        private bool WantSaveImageAccordingMergeType(int intImageIndex)
        {
            switch (m_smVisionInfo.g_intImageMergeType)
            {
                case 0:
                    return true;
                    break;
                case 1:
                    if (intImageIndex == 1)
                        return false;
                    break;
                case 2:
                    if ((intImageIndex == 1) || (intImageIndex == 2))
                        return false;
                    break;
                case 3:
                    if ((intImageIndex == 1) || (intImageIndex == 3))
                        return false;
                    break;
                case 4:
                    if ((intImageIndex == 1) || (intImageIndex == 2) || (intImageIndex == 4))
                        return false;
                    break;
            }

            return true;
        }
        /// <summary>
        /// Save all pad settings 
        /// </summary>
        /// <param name="strFolderPath">xml folder path</param>
        private void SavePadSetting(string strFolderPath)
        {
            /* 2019 05 03 - cceng:  
             * ---------------------
             * - Dont save g_arrPadROIs ROI althrough g_arrPadROIs[][2] size will be modified during gauge measurement in Step 1.
             * - g_arrPadROIs[][2] size has been fixed for pad template during in LearnPadForm.
             */
            //SaveROISetting(strFolderPath);

            //#region Save Orient Pattern Matching

            //for (int v = 0; v < m_smVisionInfo.g_arrPadROIs.Count; v++)
            //{
            //    if (!m_smVisionInfo.g_arrPad[v].ref_blnSelected)
            //        continue;
            //    m_smVisionInfo.g_arrPadOrient[v].SetDontCareThreshold(1);
            //    m_smVisionInfo.g_arrPadOrient[v].LearnPattern(m_smVisionInfo.g_arrPadROIs[v][0]);
            //    m_smVisionInfo.g_arrPadOrient[v].SavePattern(strFolderPath + "Template\\Template" + v + ".mch");
            //}
            //#endregion

            #region Save Template Data and Images

            CopyFiles m_objCopy = new CopyFiles();
            string strCurrentDateTIme = DateTime.Now.ToString();
            DateTime DT = Convert.ToDateTime(strCurrentDateTIme);
            string strCurrentDateTIme1 = strCurrentDateTIme.Replace(':', '.');
            string strCurrentDateTIme2 = strCurrentDateTIme.ToString();
            string strPath = m_smProductionInfo.g_strHistoryDataLocation + "Data\\" + DT.ToString("yyyy-MM") + "\\" + strCurrentDateTIme1 + "\\" + m_strSelectedRecipe + "-" + m_smVisionInfo.g_strVisionFolderName + "-Learn PadPkg\\";
            

            if (File.Exists(m_strFolderPath + "Template\\OriTemplate.bmp"))
                STDeviceEdit.SaveDeviceEditLogForImage(m_smVisionInfo.g_strVisionFolderName + ">Learn Template", m_smVisionInfo.g_strVisionFolderName + ">Learn PadPkg", "OriTemplate.bmp", "OriTemplate.bmp", strCurrentDateTIme2, m_smProductionInfo.g_strLotID);
            else
                STDeviceEdit.SaveDeviceEditLogForImage(m_smVisionInfo.g_strVisionFolderName + ">Learn Template", m_smVisionInfo.g_strVisionFolderName + ">Learn PadPkg", "", "OriTemplate.bmp", strCurrentDateTIme2, m_smProductionInfo.g_strLotID);

            m_objCopy.CopyAllImageFiles(m_strFolderPathPkg + "Template\\", strPath + "Old\\");
            
            // Save Learn Actual Image
            if ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0)
            {
                m_smVisionInfo.g_arrColorImages[0].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate.bmp");
                if ((m_smVisionInfo.g_arrColorImages.Count > 1) && WantSaveImageAccordingMergeType(1))
                    m_smVisionInfo.g_arrColorImages[1].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image1.bmp");
                if ((m_smVisionInfo.g_arrColorImages.Count > 2) && WantSaveImageAccordingMergeType(2))
                    m_smVisionInfo.g_arrColorImages[2].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image2.bmp");
                if ((m_smVisionInfo.g_arrColorImages.Count > 3) && WantSaveImageAccordingMergeType(3))
                    m_smVisionInfo.g_arrColorImages[3].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image3.bmp");
                if (m_smVisionInfo.g_arrColorImages.Count > 4 && WantSaveImageAccordingMergeType(4))
                    m_smVisionInfo.g_arrColorImages[4].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image4.bmp");
                if (m_smVisionInfo.g_arrColorImages.Count > 5 && WantSaveImageAccordingMergeType(5))
                    m_smVisionInfo.g_arrColorImages[5].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image5.bmp");
                if (m_smVisionInfo.g_arrColorImages.Count > 6 && WantSaveImageAccordingMergeType(6))
                    m_smVisionInfo.g_arrColorImages[6].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image6.bmp");
            }
            else
            {
                m_smVisionInfo.g_arrImages[0].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate.bmp");
                if ((m_smVisionInfo.g_arrImages.Count > 1) && WantSaveImageAccordingMergeType(1))
                    m_smVisionInfo.g_arrImages[1].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image1.bmp");
                if ((m_smVisionInfo.g_arrImages.Count > 2) && WantSaveImageAccordingMergeType(2))
                    m_smVisionInfo.g_arrImages[2].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image2.bmp");
                if ((m_smVisionInfo.g_arrImages.Count > 3) && WantSaveImageAccordingMergeType(3))
                    m_smVisionInfo.g_arrImages[3].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image3.bmp");
                if (m_smVisionInfo.g_arrImages.Count > 4 && WantSaveImageAccordingMergeType(4))
                    m_smVisionInfo.g_arrImages[4].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image4.bmp");
                if (m_smVisionInfo.g_arrImages.Count > 5 && WantSaveImageAccordingMergeType(5))
                    m_smVisionInfo.g_arrImages[5].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image5.bmp");
                if (m_smVisionInfo.g_arrImages.Count > 6 && WantSaveImageAccordingMergeType(6))
                    m_smVisionInfo.g_arrImages[6].SaveImage(m_strFolderPathPkg + "Template\\OriTemplate_Image6.bmp");
            }

            m_objCopy.CopyAllImageFiles(m_strFolderPathPkg + "Template\\", strPath + "New\\");

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                    continue;

                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                string strSectionName = "";
                if (i == 0)
                    strSectionName = "CenterROI";
                else if (i == 1)
                    strSectionName = "TopROI";
                else if (i == 2)
                    strSectionName = "RightROI";
                else if (i == 3)
                    strSectionName = "BottomROI";
                else if (i == 4)
                    strSectionName = "LeftROI";

                // 2019 10 31 - Do not save Pad ROI here in LearnPadPackageFrom. Pad ROI can only be saved in LearnPadForm.
                //if(m_smVisionInfo.g_intLearnStepNo==0)
                //SaveROISetting(strFolderPath);

                m_smVisionInfo.g_arrPad[i].SavePad(strFolderPath + "Template\\Template.xml",
                    false, strSectionName, true);

                m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.SaveRectGauge4L(
                   strFolderPath + "RectGauge4L.xml",
                   false,
                   "Pad" + i.ToString(),
                   true,
                   false);  // Dun save template size when save gauge at padpkg learn form. Template size will only save at gauge adv setting form. 

                // Save Learn Template Search ROI image, unit image
                //m_smVisionInfo.g_arrPad[i].SavePadTemplateImage(m_strFolderPath + "Template\\",
                //                                                m_smVisionInfo.g_arrRotatedImages[0],
                //                                                m_smVisionInfo.g_arrPadROIs[i], i);
                m_smVisionInfo.g_arrPad[i].SavePadPackageTemplateImage(m_strFolderPathPkg + "Template\\",
                                                                m_smVisionInfo.g_arrRotatedImages[0],
                                                                m_smVisionInfo.g_arrPadROIs[i], i);
            }

            //Load Package Image
            for (int intPadIndex = 0; intPadIndex < m_smVisionInfo.g_arrPad.Length; intPadIndex++)
            {
                if (intPadIndex > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadTemplateImage(strFolderPath + "Template\\", intPadIndex);
                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadPackageTemplateImage(m_strFolderPathPkg + "Template\\", intPadIndex);
            }
            #endregion
        }

        private void SaveROISetting(string strFolderPath)
        {
            XmlParser objFile = new XmlParser(strFolderPath + "ROI.xml", false);

            ROI objROI;
            for (int t = 0; t < m_smVisionInfo.g_arrPadROIs.Count; t++)
            {
                if (t > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (!m_smVisionInfo.g_arrPad[t].ref_blnSelected)
                    continue;

                objFile.WriteSectionElement("Unit" + t, true);

                for (int j = 0; j < m_smVisionInfo.g_arrPadROIs[t].Count; j++)
                {
                    objROI = m_smVisionInfo.g_arrPadROIs[t][j];
                    objFile.WriteElement1Value("ROI" + j, "");

                    objFile.WriteElement2Value("Name", objROI.ref_strROIName);
                    objFile.WriteElement2Value("Type", objROI.ref_intType);
                    objFile.WriteElement2Value("PositionX", objROI.ref_ROIPositionX);
                    objFile.WriteElement2Value("PositionY", objROI.ref_ROIPositionY);
                    objFile.WriteElement2Value("Width", objROI.ref_ROIWidth);
                    objFile.WriteElement2Value("Height", objROI.ref_ROIHeight);
                    objFile.WriteElement2Value("StartOffsetX", objROI.ref_intStartOffsetX);
                    objFile.WriteElement2Value("StartOffsetY", objROI.ref_intStartOffsetY);
                }
            }
            objFile.WriteEndElement();

        }

        /// <summary>
        /// Setup each learning steps
        /// </summary>
        private void SetupSteps(bool blnForward)
        {
            switch (m_smVisionInfo.g_intLearnStepNo)
            {
                case 0: //Define Unit ROI (Package)
                    btn_GaugeSaveClose.Visible = m_blnSaveButtonVisible;//true
                    //m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[0].ref_intPadPkgSizeImageViewNo, m_smVisionInfo.g_intVisionIndex);

                    DefineMostSelectedImageNo(); // 2020-02-17 ZJYEOH : Display the image selected from gauge advance setting

                    AddSearchROI(m_smVisionInfo.g_arrPadROIs); // Add Search ROI

                    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                            break;

                        //PointF pCenter = new PointF(m_smVisionInfo.g_arrPadROIs[i][1].ref_ROITotalCenterX,
                        //                            m_smVisionInfo.g_arrPadROIs[i][1].ref_ROITotalCenterY);

                        m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.SetEdgeROIPlacementLimit2(m_smVisionInfo.g_arrPadROIs[i][0]);
                        m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.SetGaugePlace_BasedOnEdgeROI();
                    }

                    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                        {
                            //m_smVisionInfo.g_arrPad[i].ref_intCheckPadDimensionImageIndex = m_smVisionInfo.g_intSelectedImage;    // 2020 01 06 - CCENG: pad dimension image index should always 0
                            m_smVisionInfo.g_arrPad[i].ref_intGaugeSizeImageIndex = m_smVisionInfo.g_intSelectedImage;
                        }
                    }

                    m_smVisionInfo.g_blnViewRotatedImage = false;
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]);

                    // Clear ROI drag handler
                    for (int i = 0; i < m_smVisionInfo.g_arrPadROIs.Count; i++)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count >= 2)
                            if (m_smVisionInfo.g_arrPadROIs[i][1].GetROIHandle())
                                m_smVisionInfo.g_arrPadROIs[i][1].ClearDragHandle();
                    }

                    AddTrainUnitROI(m_smVisionInfo.g_arrPadROIs);

                    m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].CopyTo(ref m_smVisionInfo.g_objPackageImage);
                    //switch (m_smVisionInfo.g_arrPad[0].ref_objRectGauge4L.GetGaugeImageMode(0))
                    //{
                    //    default:
                    //    case 0:
                    //        {
                    //            m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPackageImage, m_smVisionInfo.g_arrPad[0].ref_fImageGain);
                    //        }
                    //        break;
                    //    case 1:
                    //        {
                    //            m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPkgProcessImage, m_smVisionInfo.g_arrPad[0].ref_fImageGain);
                    //            m_smVisionInfo.g_objPkgProcessImage.AddPrewitt(ref m_smVisionInfo.g_objPackageImage);
                    //        }
                    //        break;
                    //}

                    //m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPackageImage, m_smVisionInfo.g_arrPad[0].ref_fImageGain);
                    AttachImageToROI(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_objPackageImage);
                    m_smVisionInfo.g_blnViewPackageImage = true;

                    if (blnForward)
                    {
                        for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                        {
                            //m_smVisionInfo.g_arrPad[i].ref_blnWantGaugeMeasurePkgSize = true; // 2019 06 24 - CCENG: WantGaugeMeasurePkgSize is used in learnPadForm to decide use gauge or PR before do pad inspection.
                        }

                        // Set RectGauge4L Placement
                        for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                        {
                            if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                                break;

                            //PointF pCenter = new PointF(m_smVisionInfo.g_arrPadROIs[i][1].ref_ROITotalCenterX,
                            //                            m_smVisionInfo.g_arrPadROIs[i][1].ref_ROITotalCenterY);

                            m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.SetGaugePlace_BasedOnEdgeROI();

                            m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ResetGaugeSettingToUserVariables();

                            bool blnGaugeResult;
                            if (m_smVisionInfo.g_blnViewPackageImage)
                            {
                                if (i == 0 && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                                {
                                    // 2020-03-24 ZJYEOH : no need measure center ROI gauge if use side pkg to measure center pkg
                                    blnGaugeResult = true;
                                }
                                else //2020-04-05 ZJYEOH : Need use this new measure gauge function as all ROIs have separated Image/Gain
                                    blnGaugeResult = m_smVisionInfo.g_arrPad[i].MeasureEdge_UsingRectGauge4L(m_smVisionInfo.g_arrImages, m_smVisionInfo.g_objWhiteImage, true);//m_smVisionInfo.g_objPackageImage
                            }
                            else
                            {
                                if (i == 0 && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                                {
                                    // 2020-03-24 ZJYEOH : no need measure center ROI gauge if use side pkg to measure center pkg
                                    blnGaugeResult = true;
                                }
                                else //2020-04-05 ZJYEOH : Need use this new measure gauge function as all ROIs have separated Image/Gain
                                    blnGaugeResult = m_smVisionInfo.g_arrPad[i].MeasureEdge_UsingRectGauge4L(m_smVisionInfo.g_arrImages, m_smVisionInfo.g_objWhiteImage, true);//m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]
                            }

                            if (!blnGaugeResult)
                            {
                                m_smVisionInfo.g_strErrorMessage = "*" + m_smVisionInfo.g_arrPad[i].ref_strErrorMessage;
                                m_smVisionInfo.VM_AT_UpdateErrorMessage = true;
                            }
                        }
                    }

                    m_smVisionInfo.g_blnViewROI = true;
                    m_smVisionInfo.g_blnViewSearchROI = true;
                    m_smVisionInfo.g_blnViewGauge = true;
                    m_smVisionInfo.g_blnDragROI = true;
                    m_smVisionInfo.g_blnViewPackageImage = true;
                    m_smVisionInfo.g_blnViewObjectsBuilded = false;
                    m_smVisionInfo.g_blnUpdateSelectedROI = true;
                    m_smVisionInfo.g_blnViewRotatedImage = false;
                    m_smVisionInfo.g_blnViewColorImage = false;

                    lbl_StepNo.BringToFront();
                    lbl_TitleStep1.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step1;
                    btn_Previous.Enabled = false;
                    if (m_intLearnType == 1)
                        btn_Next.Enabled = false;
                    else if (m_intLearnType == 2 || m_intLearnType == 3 || m_intLearnType == 4 || m_intLearnType == 5)
                    {
                        btn_Next.PerformClick();
                    }
                    break;
                case 1: // Define Package ROI
                    m_smVisionInfo.g_intSelectedImage = 0;
                    bool blnGaugeOK = true;
                    if (m_intLearnType > 1)
                    {
                        for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                        {
                            if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                                break;

                            if (i == 0 && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                                continue;

                            //if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            //    continue;

                            if (!m_smVisionInfo.g_arrPad[i].IsGaugeMeasureOK(i))
                            {
                                string strDirectionName;
                                switch (i)
                                {
                                    case 0:
                                    default:
                                        strDirectionName = "Center";
                                        break;
                                    case 1:
                                        strDirectionName = "Top";
                                        break;
                                    case 2:
                                        strDirectionName = "Right";
                                        break;
                                    case 3:
                                        strDirectionName = "Bottom";
                                        break;
                                    case 4:
                                        strDirectionName = "Left";
                                        break;

                                }
                                m_smVisionInfo.g_strErrorMessage += "*Gauge measurement in " + strDirectionName + " ROI is not good. Please adjust the ROI or gauge setting.";

                                blnGaugeOK = false;
                                break;
                            }
                        }

                        if (!blnGaugeOK)
                        {
                            m_smVisionInfo.VM_AT_UpdateErrorMessage = true;
                        }
                        else
                        {
                            if (m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_blnCheck4Sides)
                            {

                                if (!m_smVisionInfo.g_arrPad[0].MeasureEdge_UsingSidePkgCornerPoint(
                                    m_smVisionInfo.g_arrPad[1].ref_objRectGauge4L.ref_arrRectCornerPoints[0].X,
                                    m_smVisionInfo.g_arrPad[4].ref_objRectGauge4L.ref_arrRectCornerPoints[0].Y,
                                    m_smVisionInfo.g_arrPad[1].ref_objRectGauge4L.ref_arrRectCornerPoints[1].X,
                                    m_smVisionInfo.g_arrPad[2].ref_objRectGauge4L.ref_arrRectCornerPoints[1].Y,
                                    m_smVisionInfo.g_arrPad[3].ref_objRectGauge4L.ref_arrRectCornerPoints[2].X,
                                    m_smVisionInfo.g_arrPad[2].ref_objRectGauge4L.ref_arrRectCornerPoints[2].Y,
                                    m_smVisionInfo.g_arrPad[3].ref_objRectGauge4L.ref_arrRectCornerPoints[3].X,
                                    m_smVisionInfo.g_arrPad[4].ref_objRectGauge4L.ref_arrRectCornerPoints[3].Y))
                                {
                                    m_smVisionInfo.g_strErrorMessage += "*Fail to find center unit. Side ROI Measure Edge Fail.";
                                }
                            }
                        }
                    }
                    else
                    {
                        for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                        {
                            if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                                break;

                            if (i == 0 && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                                continue;

                            //if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            //    continue;

                            if (!m_smVisionInfo.g_arrPad[i].IsGaugeMeasureOK(i))
                            {
                                string strDirectionName;
                                switch (i)
                                {
                                    case 0:
                                    default:
                                        strDirectionName = "Center";
                                        break;
                                    case 1:
                                        strDirectionName = "Top";
                                        break;
                                    case 2:
                                        strDirectionName = "Right";
                                        break;
                                    case 3:
                                        strDirectionName = "Bottom";
                                        break;
                                    case 4:
                                        strDirectionName = "Left";
                                        break;

                                }
                                SRMMessageBox.Show("Gauge measurement in " + strDirectionName + " ROI is not good. Please adjust the ROI or gauge setting.");
                                m_smVisionInfo.g_intLearnStepNo--;
                                //m_intDisplayStepNo--;
                                blnGaugeOK = false;
                                break;
                            }
                        }

                        if (!blnGaugeOK)
                        {
                            break;
                        }

                    }

                    btn_GaugeSaveClose.Visible = false;

                    if (blnForward)
                    {
                        // Set last gauge measurement size as Unit size template
                        SetLastGaugeMeasureSizeAsTemplateUnitSize();
                    }

                    RotateImage();  // Note: need rotate image as well when user press previouse button to this step bcos image has been modify during step 4. 
                    if ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0)
                        RotateColorImage();

                    // Add Package ROI
                    AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs);

                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = true;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = false;

                    m_smVisionInfo.g_blnViewGauge = false;
                    m_smVisionInfo.g_blnDragROI = false;
                    m_smVisionInfo.g_blnViewRotatedImage = true;
                    m_smVisionInfo.g_blnViewObjectsBuilded = false;
                    m_smVisionInfo.g_blnViewPackageImage = false;
                    m_smVisionInfo.g_blnUpdateSelectedROI = true;

                    lbl_TitleStep2.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step2;
                    btn_Next.Enabled = true;
                    btn_Previous.Enabled = true;
                    if (m_intLearnType == 2)
                    {
                        tp_Step2.Controls.Add(btn_Save);
                        btn_Next.Enabled = false;
                        btn_Previous.Enabled = false;
                    }
                    if (m_intLearnType == 3)
                    {
                        btn_Next.PerformClick();
                    }
                    if (m_intLearnType == 4)
                    {
                        m_smVisionInfo.g_intLearnStepNo = 3;
                        SetupSteps(true);
                    }
                    if (m_intLearnType == 5)
                    {
                        m_smVisionInfo.g_intLearnStepNo = 11;
                        SetupSteps(true);
                    }
                    break;
                case 2: // Define Chipped ROI
                    //m_smVisionInfo.g_intSelectedImage = 0;
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);
                    //bool blnGaugeOK = true;
                    //for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    //{
                    //    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    //        break;

                    //    //if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                    //    //    continue;

                    //    if (!m_smVisionInfo.g_arrPad[i].IsGaugeMeasureOK(i))
                    //    {
                    //        string strDirectionName;
                    //        switch (i)
                    //        {
                    //            case 0:
                    //            default:
                    //                strDirectionName = "Center";
                    //                break;
                    //            case 1:
                    //                strDirectionName = "Top";
                    //                break;
                    //            case 2:
                    //                strDirectionName = "Right";
                    //                break;
                    //            case 3:
                    //                strDirectionName = "Bottom";
                    //                break;
                    //            case 4:
                    //                strDirectionName = "Left";
                    //                break;

                    //        }
                    //        SRMMessageBox.Show("Gauge measurement in " + strDirectionName + " ROI is not good. Please adjust the ROI or gauge setting.");
                    //        m_smVisionInfo.g_intLearnStepNo--;
                    //        //m_intDisplayStepNo--;
                    //        blnGaugeOK = false;
                    //        break;
                    //    }
                    //}

                    //if (!blnGaugeOK)
                    //{
                    //    break;
                    //}

                    if (blnForward)
                    {
                        // Set last gauge measurement size as Unit size template
                        SetLastGaugeMeasureSizeAsTemplateUnitSize();
                    }

                    RotateImage();  // Note: need rotate image as well when user press previouse button to this step bcos image has been modify during step 4. 
                    if ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0)
                        RotateColorImage();
                    // Add Package ROI
                    //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs);

                    m_smVisionInfo.g_blnViewGauge = false;
                    m_smVisionInfo.g_blnDragROI = false;
                    m_smVisionInfo.g_blnViewRotatedImage = true;
                    m_smVisionInfo.g_blnViewObjectsBuilded = false;
                    m_smVisionInfo.g_blnViewPackageImage = false;
                    m_smVisionInfo.g_blnUpdateSelectedROI = true;

                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = true;
                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;

                    lbl_TitleStep10.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step2_1;
                    btn_Next.Enabled = true;
                    btn_Previous.Enabled = true;
                    if (m_intLearnType == 3)
                    {
                        tp_Step2_1.Controls.Add(btn_Save);
                        btn_Next.Enabled = false;
                        btn_Previous.Enabled = false;
                    }
                    break;
                case 3: // Define Mold Flash ROI
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgMoldFlashImageViewNo, m_smVisionInfo.g_intVisionIndex);
                    //bool blnGaugeOK = true;
                    //for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    //{
                    //    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    //        break;

                    //    //if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                    //    //    continue;

                    //    if (!m_smVisionInfo.g_arrPad[i].IsGaugeMeasureOK(i))
                    //    {
                    //        string strDirectionName;
                    //        switch (i)
                    //        {
                    //            case 0:
                    //            default:
                    //                strDirectionName = "Center";
                    //                break;
                    //            case 1:
                    //                strDirectionName = "Top";
                    //                break;
                    //            case 2:
                    //                strDirectionName = "Right";
                    //                break;
                    //            case 3:
                    //                strDirectionName = "Bottom";
                    //                break;
                    //            case 4:
                    //                strDirectionName = "Left";
                    //                break;

                    //        }
                    //        SRMMessageBox.Show("Gauge measurement in " + strDirectionName + " ROI is not good. Please adjust the ROI or gauge setting.");
                    //        m_smVisionInfo.g_intLearnStepNo--;
                    //        //m_intDisplayStepNo--;
                    //        blnGaugeOK = false;
                    //        break;
                    //    }
                    //}

                    //if (!blnGaugeOK)
                    //{
                    //    break;
                    //}

                    if (blnForward)
                    {
                        // Set last gauge measurement size as Unit size template
                        SetLastGaugeMeasureSizeAsTemplateUnitSize();
                    }

                    RotateImage();  // Note: need rotate image as well when user press previouse button to this step bcos image has been modify during step 4. 
                    if ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0)
                        RotateColorImage();
                    // Add Package ROI
                    //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs);

                    m_smVisionInfo.g_blnViewGauge = false;
                    m_smVisionInfo.g_blnDragROI = false;
                    m_smVisionInfo.g_blnViewRotatedImage = true;
                    m_smVisionInfo.g_blnViewObjectsBuilded = false;
                    m_smVisionInfo.g_blnViewPackageImage = false;
                    m_smVisionInfo.g_blnUpdateSelectedROI = true;

                    lbl_TitleStep11.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step2_2;
                    btn_Next.Enabled = true;
                    btn_Previous.Enabled = true;
                    if (m_intLearnType == 4)
                    {
                        tp_Step2_2.Controls.Add(btn_Save);
                        btn_Next.Enabled = false;
                        btn_Previous.Enabled = false;
                    }
                    break;
                case 4:// Learn Image 1 surface Threshold
                    label5.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage1LowSurfaceThreshold.ToString();
                    label4.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage1HighSurfaceThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    //if (blnForward)
                    //{
                    //    float fUnitWidth;
                    //    float fUnitHeight;
                    //    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    //    {
                    //        fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                    //        fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                    //        //if (fUnitWidth < fUnitHeight)
                    //        //{
                    //        if (Convert.ToSingle(txt_StartPixelFromLeft.Text) >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                    //        {
                    //            SRMMessageBox.Show("Edge tolerance can only goto a quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //            txt_StartPixelFromLeft.Text = "0";
                    //            m_fStartPixelFromLeftPrev = 0;

                    //            for (int j = 0; j < m_smVisionInfo.g_arrPad.Length; j++)
                    //            {
                    //                m_smVisionInfo.g_arrPad[j].ref_fPkgStartPixelFromLeft = 0;
                    //            }
                    //            break;
                    //        }
                    //        if (Convert.ToSingle(txt_StartPixelFromRight.Text) >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                    //        {
                    //            SRMMessageBox.Show("Edge tolerance can only goto a quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);

                    //            txt_StartPixelFromRight.Text = "0";
                    //            m_fStartPixelFromRightPrev = 0;
                    //            for (int j = 0; j < m_smVisionInfo.g_arrPad.Length; j++)
                    //            {
                    //                m_smVisionInfo.g_arrPad[j].ref_fPkgStartPixelFromRight = 0;
                    //            }
                    //            break;
                    //        }
                    //        //}
                    //        //else
                    //        //{
                    //        if (Convert.ToSingle(txt_StartPixelFromEdge.Text) >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                    //        {
                    //            SRMMessageBox.Show("Edge tolerance can only goto a quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //            txt_StartPixelFromEdge.Text = "0";
                    //            m_fStartPixelFromEdgePrev = 0;

                    //            for (int j = 0; j < m_smVisionInfo.g_arrPad.Length; j++)
                    //            {
                    //                m_smVisionInfo.g_arrPad[j].ref_fPkgStartPixelFromEdge = 0;
                    //            }
                    //            break;
                    //        }
                    //        if (Convert.ToSingle(txt_StartPixelFromBottom.Text) >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                    //        {
                    //            SRMMessageBox.Show("Edge tolerance can only goto a quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //            txt_StartPixelFromBottom.Text = "0";
                    //            m_fStartPixelFromBottomPrev = 0;

                    //            for (int j = 0; j < m_smVisionInfo.g_arrPad.Length; j++)
                    //            {
                    //                m_smVisionInfo.g_arrPad[j].ref_fPkgStartPixelFromBottom = 0;
                    //            }
                    //            break;
                    //        }
                    //        //}
                    //    }
                    //}

                    //m_smVisionInfo.g_intSelectedImage = 0;
                    //ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[0]);

                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = true;
                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;

                    lbl_TitleStep3.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step3;
                    if (m_smVisionInfo.g_arrImages.Count == 1)
                    {
                        btn_Next.Enabled = false;
                        tp_Step3.Controls.Add(btn_Save);
                    }
                    else
                        btn_Next.Enabled = true;
                    break;
                case 5:// Learn Image 2 Threshold
                       // m_smVisionInfo.g_arrPadROIs[0][2].SaveImage("D:\\g_arrPadROIs.bmp");
                    label3.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage2LowThreshold.ToString();
                    label2.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage2HighThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = false;
                    m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = true;

                    lbl_TitleStep4.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step4;
                    btn_Next.Enabled = true;
                    break;
                case 6:// Learn Mold Flash Threshold
                    label1.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage1MoldFlashThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgMoldFlashImageViewNo, m_smVisionInfo.g_intVisionIndex); // (1)
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    lbl_TitleStep5.BringToFront();
                    if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage && !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    {
                        lbl_TitleStep5.Text = srmLabel53.Text;
                    }
                    pic_Image3Picture.SelectedTab = tp_Step5;
                    btn_Previous.Enabled = true;
                    btn_Next.Enabled = true;
                    break;
                case 7:// Learn void Threshold
                    lbl_VoidViewThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2VoidThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    lbl_TitleStep8.BringToFront();

                    pic_Image3Picture.SelectedTab = tp_Step6;
                    btn_Previous.Enabled = true;
                    btn_Next.Enabled = true;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = false;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = true;
                    if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage && !m_smVisionInfo.g_blnWantDontCareArea_Package)
                    {
                        lbl_TitleStep8.Text = srmLabel54.Text;
                        tp_Step6.Controls.Add(btn_Save);
                        btn_Next.Enabled = false;
                    }
                    break;
                case 8:// Learn Crack Threshold
                    lbl_LowCrackViewThreshold.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage2LowCrackThreshold.ToString();
                    lbl_HighCrackViewThreshold.Text = m_smVisionInfo.g_arrPad[0].ref_intPkgImage2HighCrackThreshold.ToString();

                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = false;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = true;
                    lbl_TitleStep9.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step7;
                    btn_Previous.Enabled = true;
                    btn_Next.Enabled = true;
                    if (m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage && !m_smVisionInfo.g_blnWantDontCareArea_Package)
                    {
                        btn_Next.Enabled = false;
                    }
                    else
                    {
                        if (tp_Step7.Controls.Contains(btn_Save))
                            tp_Step7.Controls.Remove(btn_Save);
                    }
                    break;
                case 9:// Learn Bright Threshold Simple
                    txt_BrightMinArea.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intBrightFieldMinArea.ToString();
                    lbl_BrightThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intBrightFieldLowThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgBrightFieldImageViewNo, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    lbl_TitleBrightFieldSimple.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Bright;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = true;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = false;
                    m_smVisionInfo.g_blnDragROI = false;    // 2020 05 26 - CCENG: Press Previous button from Dont Care Area page will cause this g_blnDragROI value true.
                    btn_Previous.Enabled = true;
                    btn_Next.Enabled = true;
                    break;
                case 10:// Learn Dark Threshold Simple
                    txt_DarkMinArea.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intDarkFieldMinArea.ToString();
                    lbl_DarkThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intDarkFieldLowThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgDarkFieldImageViewNo, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    lbl_TitleDarkFieldSimple.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Dark;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = false;
                    m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = true;
                    m_smVisionInfo.g_blnDragROI = false;    // 2020 05 26 - CCENG: Press Previous button from Dont Care Area page will cause this g_blnDragROI value true.
                    //btn_Previous.Enabled = true;
                    //tp_Dark.Controls.Add(btn_Save);
                    btn_Next.Enabled = true;
                    if (!m_smVisionInfo.g_blnWantDontCareArea_Package)
                    {
                        btn_Next.Enabled = false;
                        tp_Dark.Controls.Add(btn_Save);
                    }

                    break;
                case 11:  //Learn Foreign Material ROI
                    m_smVisionInfo.g_intSelectedImage = 0;

                    if (blnForward)
                    {
                        // Set last gauge measurement size as Unit size template
                        SetLastGaugeMeasureSizeAsTemplateUnitSize();
                    }

                    RotateImage();  // Note: need rotate image as well when user press previouse button to this step bcos image has been modify during step 4. 
                    if ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0)
                        RotateColorImage();
                    // Add Package ROI
                    //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs);

                    m_smVisionInfo.g_blnViewGauge = false;
                    m_smVisionInfo.g_blnDragROI = false;
                    m_smVisionInfo.g_blnViewRotatedImage = true;
                    m_smVisionInfo.g_blnViewObjectsBuilded = false;
                    m_smVisionInfo.g_blnViewPackageImage = false;
                    m_smVisionInfo.g_blnUpdateSelectedROI = true;

                    lbl_TitleForeignMaterial.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_ForeignMaterialROI;
                    btn_Next.Enabled = true;
                    btn_Previous.Enabled = true;
                    break;
                case 12:// Learn Foreign Material Threshold
                    txt_ForeignMaterialMinArea.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intForeignMaterialBrightFieldMinArea.ToString();
                    lbl_ForeignMaterialThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intForeignMaterialBrightFieldThreshold.ToString();
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgBrightFieldImageViewNo, m_smVisionInfo.g_intVisionIndex);
                    ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    lbl_TitleForeignMaterial.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_ForeignMaterial;

                    m_smVisionInfo.g_blnDragROI = false;    // 2020 05 26 - CCENG: Press Previous button from Dont Care Area page will cause this g_blnDragROI value true.
                    btn_Previous.Enabled = true;
                    btn_Next.Enabled = true;
                    if (!m_smVisionInfo.g_blnWantDontCareArea_Package)
                    {
                        btn_Next.Enabled = false;
                        tp_ForeignMaterial.Controls.Add(btn_Save);
                    }
                    break;
                case 13: //Define Don Care Area't

                    for (int u = 0; u < m_smVisionInfo.g_arrPolygon_PadPackage.Count; u++)
                    {
                        for (int i = 0; i < m_smVisionInfo.g_arrPolygon_PadPackage[u].Count; i++)
                        {
                            for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[u][i].Count; j++)
                            {
                                m_smVisionInfo.g_arrPolygon_PadPackage[u][i][j].ClearPolygon();
                            }
                        }
                    }

                    for (int i = 0; i < m_smVisionInfo.g_arrPadPackageDontCareROIs.Count; i++)
                    {
                        if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                        if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());

                        for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count; j++)
                        {
                            for (int k = 0; k < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j].Count; k++)
                            {
                                m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                            }
                        }

                    }

                    //for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    //{
                    //    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    //        break;

                    //    for (int j = 0; j < 2; j++)
                    //    {
                    //        m_smVisionInfo.g_arrPolygon_PadPackage[i][j].CheckDontCarePosition(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
                    //    }
                    //}
                    m_smVisionInfo.g_blnDragROI = true;
                    //m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);

                    if (radio_Bright.Checked)
                    {
                        m_smVisionInfo.g_intSelectedType = 0;
                        m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);
                    }
                    else
                    {
                        m_smVisionInfo.g_intSelectedType = 1;
                        m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                    }
            
                    lbl_TitleStep12.BringToFront();
                    pic_Image3Picture.SelectedTab = tp_Step11;
                    tp_Step11.Controls.Add(btn_Save);
                    btn_Next.Enabled = false;
                    if (m_intLearnType == 5)
                    {
                        btn_Previous.Enabled = false;
                    }
                    break;
                default:
                    break;
            }
        }

        private void SetLastGaugeMeasureSizeAsTemplateUnitSize()
        {
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                m_smVisionInfo.g_arrPad[i].SetCurrentMeasureSizeAsUnitSize();
            }
        }

        private void RotateImage()
        {
            if (m_smVisionInfo.g_intSelectedImage == -1)
            {
                //if (m_smVisionInfo.g_arrPad[0].ref_blnWantGaugeMeasurePkgSize)
                if (true)
                {
                    // Define rotation ROI with ROI center point same as gauge unit center point
                    float fROIWidth = Math.Min(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X - m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalX,
                                        m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[0][0].ref_ROIWidth - m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X);
                    float fROIHeight = Math.Min(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y - m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalY,
                                        m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[0][0].ref_ROIHeight - m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y);

                    ROI objRotateROI = new ROI();
                    objRotateROI.AttachImage(m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]);
                    objRotateROI.LoadROISetting((int)Math.Round(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X - fROIWidth, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y - fROIHeight, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(fROIWidth * 2, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(fROIHeight * 2, 0, MidpointRounding.AwayFromZero));

                    // Rotate image to zero degree using RectGauge4L angle result
                    ROI.Rotate0Degree(m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage], objRotateROI, // Middle Pad Search ROI
                                      m_smVisionInfo.g_arrPad[0].GetResultAngle_RectGauge4L(),
                    ref m_smVisionInfo.g_arrRotatedImages, m_smVisionInfo.g_intSelectedImage);
                    m_smVisionInfo.g_blnViewRotatedImage = true;

                    m_smVisionInfo.g_arrPadROIs[0][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                }
                else
                {
                    m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].CopyTo(ref m_smVisionInfo.g_arrRotatedImages, m_smVisionInfo.g_intSelectedImage);
                    m_smVisionInfo.g_blnViewRotatedImage = true;

                    m_smVisionInfo.g_arrPadROIs[0][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                }
            }
            else
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                        break;

                    //if (m_smVisionInfo.g_arrPad[i].ref_blnWantGaugeMeasurePkgSize)
                    if (true)
                    {
                        //m_smVisionInfo.g_arrPad[i].MeasureEdge_UsingRectGauge4L(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                        m_smVisionInfo.g_arrPadROIs[i][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                        if (i > 0 && m_smVisionInfo.g_intSelectedImage == 1)    // For side pad and when background is white color.
                            m_smVisionInfo.g_arrPad[i].AddGrayColorOuterGaugePoint(m_smVisionInfo.g_arrPadROIs[i][0], (Pad.PadIndex)i);



                        // Define rotation ROI with ROI center point same as gauge unit center point
                        //float fROIWidth = Math.Min(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().X - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX,
                        //                    m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth - m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().X);
                        //float fROIHeight = Math.Min(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().Y - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY,
                        //                    m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight - m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().Y);

                        //float fROIWidth = m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2 + 3;
                        //float fROIHeight = m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2 + 3;


                        //objRotateROI.AttachImage(m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]);
                        //objRotateROI.LoadROISetting((int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().X - fROIWidth, 0, MidpointRounding.AwayFromZero),
                        //                                        (int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().Y - fROIHeight, 0, MidpointRounding.AwayFromZero),
                        //                                        (int)Math.Round(fROIWidth * 2, 0, MidpointRounding.AwayFromZero),
                        //                                        (int)Math.Round(fROIHeight * 2, 0, MidpointRounding.AwayFromZero));

                        // --------- 2018 10 19 - CCENG: Use this new formula define ROI position and size. --------------------
                        // ----------------------------: Rotate at gauge center but using search ROI size ----------------------
                        // ----------------------------: Not using gauge size to prevent rotation defect near unit edge --------

                        int intRotateCenterX = (int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().X, 0, MidpointRounding.AwayFromZero);
                        int intRotateCenterY = (int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().Y, 0, MidpointRounding.AwayFromZero);

                        int intStartX = Math.Max(0, intRotateCenterX - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth / 2);
                        int intEndX = Math.Min(m_smVisionInfo.g_arrImages[0].ref_intImageWidth, intRotateCenterX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth / 2);
                        int intHalfWidth = Math.Min(intRotateCenterX - intStartX, intEndX - intRotateCenterX);
                        intStartX = intRotateCenterX - intHalfWidth;

                        int intStartY = Math.Max(0, intRotateCenterY - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight / 2);
                        int intEndY = Math.Min(m_smVisionInfo.g_arrImages[0].ref_intImageHeight, intRotateCenterY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight / 2);
                        int intHalfHeight = Math.Min(intRotateCenterY - intStartY, intEndY - intRotateCenterY);
                        intStartY = intRotateCenterY - intHalfHeight;

                        ROI objRotateROI = new ROI();
                        objRotateROI.AttachImage(m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]);    // 2018 10 18 - CCENG: New empty ROI must attach to any image. Without attach any image, the TotalOrgXY value will be 0.
                        objRotateROI.LoadROISetting(intStartX, intStartY, intHalfWidth * 2, intHalfHeight * 2);


                        // Rotate image to zero degree using RectGauge4L angle result
                        if (i == 0)
                        {
                            for (int j = 0; j < m_smVisionInfo.g_arrImages.Count; j++)
                            {
                                ROI.Rotate0Degree(m_smVisionInfo.g_arrImages[j], objRotateROI, // Middle Pad Search ROI
                                                  m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(),
                                ref m_smVisionInfo.g_arrRotatedImages, j);
                            }
                        }
                        else
                        {
                            for (int j = 0; j < m_smVisionInfo.g_arrImages.Count; j++)
                            {
                                ROI.Rotate0Degree(objRotateROI, // Middle Pad Search ROI
                                              m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(),
                            ref m_smVisionInfo.g_arrRotatedImages, j);
                            }
                        }

                        // if side pad + selected learn image is index 0 + WantConsiderImage2 is true, then rotate image index 1 as well before logic Add image index 1 apply to image index 0 
                        if (i > 0 && m_smVisionInfo.g_intSelectedImage == 0 && m_smVisionInfo.g_arrPad[i].ref_blnWantConsiderPadImage2)
                        {
                            if (i == 1)
                            {
                                ROI.Rotate0Degree(m_smVisionInfo.g_arrImages[1], objRotateROI, // Middle Pad Search ROI
                                                  m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(),
                                ref m_smVisionInfo.g_arrRotatedImages, 1);
                            }
                            else
                            {
                                ROI.Rotate0Degree(objRotateROI, // Middle Pad Search ROI
                                                  m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(),
                                ref m_smVisionInfo.g_arrRotatedImages, 1);
                            }
                        }

                        m_smVisionInfo.g_blnViewRotatedImage = true;

                        m_smVisionInfo.g_arrPadROIs[i][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                    }
                    //else
                    //{
                    //    //if (!m_smVisionInfo.g_blnViewRotatedImage)    // Need to re-rotate and re-copy where the ViewRotatedImage is true or not. Bcos Rotated image has been modified for dont care area 
                    //    {
                    //        float fRotatedDegree = float.Parse(txt_RotateDegree.Text) * -1f;
                    //        if (Math.Abs(fRotatedDegree) > 0)
                    //        {
                    //            ROI.Rotate0Degree(m_smVisionInfo.g_arrImages[0], m_smVisionInfo.g_arrPadROIs[0][0], fRotatedDegree, ref m_smVisionInfo.g_arrRotatedImages, 0);
                    //            m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPackageImage, m_smVisionInfo.g_arrPad[0].ref_fImageGain);

                    //            m_smVisionInfo.g_blnViewRotatedImage = true;
                    //            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;

                    //        }
                    //        else
                    //        {

                    //            m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].CopyTo(ref m_smVisionInfo.g_arrRotatedImages, m_smVisionInfo.g_intSelectedImage);
                    //            m_smVisionInfo.g_arrPadROIs[i][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    //            m_smVisionInfo.g_blnViewRotatedImage = true;
                    //            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
                    //        }
                    //    }
                    //}
                }
            }
        }

        private void RotateColorImage()
        {
            if (m_smVisionInfo.g_intSelectedImage == -1)
            {
                if (m_smVisionInfo.g_arrPad[0].ref_blnWantGaugeMeasurePkgSize)
                {
                    // Define rotation ROI with ROI center point same as gauge unit center point
                    float fROIWidth = Math.Min(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X - m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalX,
                                        m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[0][0].ref_ROIWidth - m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X);
                    float fROIHeight = Math.Min(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y - m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalY,
                                        m_smVisionInfo.g_arrPadROIs[0][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[0][0].ref_ROIHeight - m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y);

                    CROI objRotateROI = new CROI();
                    objRotateROI.AttachImage(m_smVisionInfo.g_arrColorImages[m_smVisionInfo.g_intSelectedImage]);
                    objRotateROI.LoadROISetting((int)Math.Round(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().X - fROIWidth, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(m_smVisionInfo.g_arrPad[0].GetResultCenterPoint_RectGauge4L().Y - fROIHeight, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(fROIWidth * 2, 0, MidpointRounding.AwayFromZero),
                                                            (int)Math.Round(fROIHeight * 2, 0, MidpointRounding.AwayFromZero));

                    // Rotate image to zero degree using RectGauge4L angle result
                    CROI.Rotate0Degree(m_smVisionInfo.g_arrColorImages[m_smVisionInfo.g_intSelectedImage], objRotateROI, // Middle Pad Search ROI
                                      m_smVisionInfo.g_arrPad[0].GetResultAngle_RectGauge4L(), 8,
                    ref m_smVisionInfo.g_arrColorRotatedImages, m_smVisionInfo.g_intSelectedImage);
                    m_smVisionInfo.g_blnViewRotatedImage = true;

                    m_smVisionInfo.g_arrPadColorROIs[0][0].AttachImage(m_smVisionInfo.g_arrColorRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                }
                else
                {
                    m_smVisionInfo.g_arrColorImages[m_smVisionInfo.g_intSelectedImage].CopyTo(ref m_smVisionInfo.g_arrColorRotatedImages, m_smVisionInfo.g_intSelectedImage);
                    m_smVisionInfo.g_blnViewRotatedImage = true;

                    m_smVisionInfo.g_arrPadColorROIs[0][0].AttachImage(m_smVisionInfo.g_arrColorRotatedImages[m_smVisionInfo.g_intSelectedImage]);
                }
            }
            else
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                        break;

                    if (m_smVisionInfo.g_arrPad[i].ref_blnWantGaugeMeasurePkgSize)
                    {
                        //m_smVisionInfo.g_arrPad[i].MeasureEdge_UsingRectGauge4L(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                        //if (i > 0 && m_smVisionInfo.g_intSelectedImage == 1)    // For side pad and when background is white color.
                        //    m_smVisionInfo.g_arrPad[i].AddGrayColorOuterGaugePoint(m_smVisionInfo.g_arrPadROIs[i][0], (Pad.PadIndex)i);

                        // --------- 2018 10 19 - CCENG: Use this new formula define ROI position and size. --------------------
                        // ----------------------------: Rotate at gauge center but using search ROI size ----------------------
                        // ----------------------------: Not using gauge size to prevent rotation defect near unit edge --------

                        int intRotateCenterX = (int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().X, 0, MidpointRounding.AwayFromZero);
                        int intRotateCenterY = (int)Math.Round(m_smVisionInfo.g_arrPad[i].GetResultCenterPoint_RectGauge4L().Y, 0, MidpointRounding.AwayFromZero);

                        int intStartX = Math.Max(0, intRotateCenterX - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth / 2);
                        int intEndX = Math.Min(m_smVisionInfo.g_arrImages[0].ref_intImageWidth, intRotateCenterX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth / 2);
                        int intHalfWidth = Math.Min(intRotateCenterX - intStartX, intEndX - intRotateCenterX);
                        intStartX = intRotateCenterX - intHalfWidth;

                        int intStartY = Math.Max(0, intRotateCenterY - m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight / 2);
                        int intEndY = Math.Min(m_smVisionInfo.g_arrImages[0].ref_intImageHeight, intRotateCenterY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight / 2);
                        int intHalfHeight = Math.Min(intRotateCenterY - intStartY, intEndY - intRotateCenterY);
                        intStartY = intRotateCenterY - intHalfHeight;

                        CROI objRotateROI = new CROI();
                        objRotateROI.AttachImage(m_smVisionInfo.g_arrColorImages[m_smVisionInfo.g_intSelectedImage]);    // 2018 10 18 - CCENG: New empty ROI must attach to any image. Without attach any image, the TotalOrgXY value will be 0.
                        objRotateROI.LoadROISetting(intStartX, intStartY, intHalfWidth * 2, intHalfHeight * 2);

                        // Rotate image to zero degree using RectGauge4L angle result
                        if (i == 0)
                        {
                            CROI.Rotate0Degree(m_smVisionInfo.g_arrColorImages[m_smVisionInfo.g_intSelectedImage], objRotateROI, // Middle Pad Search ROI
                                     m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(), 8,
                    ref m_smVisionInfo.g_arrColorRotatedImages, m_smVisionInfo.g_intSelectedImage);
                        }
                        else
                        {
                            if (m_smVisionInfo.g_arrPad[i].ref_blnWantRotateSidePadImage)
                            {
                                CROI.Rotate0Degree(objRotateROI, // Middle Pad Search ROI
                                                  m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(), 8,
                                ref m_smVisionInfo.g_arrColorRotatedImages, m_smVisionInfo.g_intSelectedImage);
                            }
                        }

                        // if side pad + selected learn image is index 0 + WantConsiderImage2 is true, then rotate image index 1 as well before logic Add image index 1 apply to image index 0 
                        if (i > 0 && m_smVisionInfo.g_intSelectedImage == 0 && m_smVisionInfo.g_arrPad[i].ref_blnWantConsiderPadImage2)
                        {
                            if (m_smVisionInfo.g_arrPad[i].ref_blnWantRotateSidePadImage)
                            {
                                if (i == 1)
                                {
                                    CROI.Rotate0Degree(m_smVisionInfo.g_arrColorImages[1], objRotateROI, // Middle Pad Search ROI
                                                      m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(), 8,
                                    ref m_smVisionInfo.g_arrColorRotatedImages, 1);
                                }
                                else
                                {
                                    CROI.Rotate0Degree(objRotateROI, // Middle Pad Search ROI
                                                      m_smVisionInfo.g_arrPad[i].GetResultAngle_RectGauge4L(), 8,
                                    ref m_smVisionInfo.g_arrColorRotatedImages, 1);
                                }
                            }
                        }

                        m_smVisionInfo.g_blnViewRotatedImage = true;

                        if (m_smVisionInfo.g_arrPadColorROIs[i].Count > 0)
                            m_smVisionInfo.g_arrPadColorROIs[i][0].AttachImage(m_smVisionInfo.g_arrColorRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                    }
                }
            }

        }

        /// <summary>
        /// Customize GUI either pad or Pad5s
        /// </summary>
        private void CustomizeGUI()
        {
            m_blnUpdateSelectedROISetting = true;

            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey1 = key.CreateSubKey("SVG\\AutoMode");
            chk_SetToAll.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllEdges_PadPackage", false));
            chk_SetToAll_Chipped.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllEdges_PadPackage_Chipped", false));
            chk_SetToAll_ForeignMaterial.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllEdges_PadPackage_ForeignMaterial", false));
            chk_SetToAll_Mold.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllEdges_PadPackage_Mold", false));
            if ((m_smCustomizeInfo.g_intWantPad5S & (1 << m_smVisionInfo.g_intVisionPos)) > 0 && m_smVisionInfo.g_blnCheck4Sides)
            {
                chk_SetToAllSideROI.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllSide_PadPackage", false));
                chk_SetToAllSideROI_Chipped.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllSide_PadPackage_Chipped", false));
                chk_SetToAllSideROI_ForeignMaterial.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllSide_PadPackage_ForeignMaterial", false));
                chk_SetToAllSideROI_Mold.Checked = Convert.ToBoolean(subkey1.GetValue("SetToAllSide_PadPackage_Mold", false));

                chk_SetToAllSideROI.Visible = m_blnSetToAllCheckboxVisible_Package;
                chk_SetToAllSideROI_Chipped.Visible = m_blnSetToAllCheckboxVisible_Chipped;
                chk_SetToAllSideROI_ForeignMaterial.Visible = m_blnSetToAllCheckboxVisible_ForeignMaterial;
                chk_SetToAllSideROI_Mold.Visible = m_blnSetToAllCheckboxVisible_Mold;
            }
            else
            {
                chk_SetToAllSideROI.Visible = false;
                chk_SetToAllSideROI_Chipped.Visible = false;
                chk_SetToAllSideROI_ForeignMaterial.Visible = false;
                chk_SetToAllSideROI_Mold.Visible = false;
            }
            chk_SetToBrightDark_Chip.Checked = Convert.ToBoolean(subkey1.GetValue("SetToBrightDark_PadPackage_Chipped", false));
            chk_SetToBrightDark.Checked = Convert.ToBoolean(subkey1.GetValue("SetToBrightDark_PadPackage", false)); 
            m_smVisionInfo.g_blnUseSameDontCareForBrightAndDark = chk_BrightAndDarkSameDontCareArea.Checked = Convert.ToBoolean(subkey1.GetValue("BrightAndDarkSameDontCareArea_PadPackage", false));
            cbo_PkgDefectType.SelectedIndex = 0;
            cbo_ChippedOffDefectType.SelectedIndex = 0;
            m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = true;
            m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;

            if (!m_smVisionInfo.g_arrPad[0].ref_blnSeperateBrightDarkROITolerance)
            {
                lbl_PkgROIDefectType.Visible = false;
                chk_SetToBrightDark.Checked = chk_SetToBrightDark.Visible = false;
                cbo_PkgDefectType.Visible = false;
                cbo_PkgDefectType.SelectedIndex = 0;
            }

            if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
            {
                if (!m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    srmLabel53.Text = "Image 1 : Bright Field";
                srmLabel54.Text = "Image 2 : Dark Field";
            }

            // Package size
            txt_UnitSizeMinWidth.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitWidthMin.ToString("F4");
            txt_UnitSizeMinHeight.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitHeightMin.ToString("F4");
            txt_UnitSizeMaxWidth.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitWidthMax.ToString("F4");
            txt_UnitSizeMaxHeight.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitHeightMax.ToString("F4");
            txt_UnitSizeMinThickness.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitThicknessMin.ToString("F4");
            txt_UnitSizeMaxThickness.Text = m_smVisionInfo.g_arrPad[0].ref_fUnitThicknessMax.ToString("F4");
            txt_ImageGain.Value = Convert.ToDecimal(m_smVisionInfo.g_arrPad[0].ref_fImageGain);
            //txt_StartPixelFromEdge.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromEdge(1).ToString("F4");
            //txt_StartPixelFromRight.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromRight(1).ToString("F4");
            //txt_StartPixelFromBottom.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromBottom(1).ToString("F4");
            //txt_StartPixelFromLeft.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromLeft(1).ToString("F4");

            if (cbo_PkgDefectType.SelectedIndex == 0 || !m_smVisionInfo.g_arrPad[0].ref_blnSeperateBrightDarkROITolerance)
            {
                txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge).ToString();
                txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight).ToString();
                txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom).ToString();
                txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft).ToString();
            }
            else
            {
                txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark).ToString();
                txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark).ToString();
                txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark).ToString();
                txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark).ToString();
            }

            m_fStartPixelFromEdgePrev = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge);
            m_fStartPixelFromRightPrev = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight);
            m_fStartPixelFromBottomPrev = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom);
            m_fStartPixelFromLeftPrev = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft);

            m_fStartPixelFromEdgePrev_Dark = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark);
            m_fStartPixelFromRightPrev_Dark = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark);
            m_fStartPixelFromBottomPrev_Dark = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark);
            m_fStartPixelFromLeftPrev_Dark = (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark);

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge).ToString();
                txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight).ToString();
                txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom).ToString();
                txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft).ToString();
            }
            else
            {
                txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge_Dark).ToString();
                txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight_Dark).ToString();
                txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom_Dark).ToString();
                txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft_Dark).ToString();
            }

            m_fStartPixelFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge);
            m_fStartPixelFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight);
            m_fStartPixelFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom);
            m_fStartPixelFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft);

            m_fStartPixelFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge_Dark);
            m_fStartPixelFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight_Dark);
            m_fStartPixelFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom_Dark);
            m_fStartPixelFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft_Dark);

            txt_StartPixelFromEdge_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromEdge).ToString();
            txt_StartPixelFromRight_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromRight).ToString();
            txt_StartPixelFromBottom_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromBottom).ToString();
            txt_StartPixelFromLeft_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromLeft).ToString();

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge).ToString();
                txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight).ToString();
                txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom).ToString();
                txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft).ToString();
            }
            else
            {
                txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge_Dark).ToString();
                txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight_Dark).ToString();
                txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom_Dark).ToString();
                txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft_Dark).ToString();
            }

            m_fStartPixelExtendFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge);
            m_fStartPixelExtendFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight);
            m_fStartPixelExtendFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom);
            m_fStartPixelExtendFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft);

            m_fStartPixelExtendFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge_Dark);
            m_fStartPixelExtendFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight_Dark);
            m_fStartPixelExtendFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom_Dark);
            m_fStartPixelExtendFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft_Dark);

            m_fStartPixelFromEdgePrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromEdge);
            m_fStartPixelFromRightPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromRight);
            m_fStartPixelFromBottomPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromBottom);
            m_fStartPixelFromLeftPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[0].ref_fForeignMaterialStartPixelFromLeft);

            txt_StartPixelFromEdge_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge).ToString();
            txt_StartPixelFromRight_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight).ToString();
            txt_StartPixelFromBottom_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom).ToString();
            txt_StartPixelFromLeft_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft).ToString();

            m_fStartPixelFromEdgePrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge);
            m_fStartPixelFromRightPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight);
            m_fStartPixelFromBottomPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom);
            m_fStartPixelFromLeftPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft);

            txt_StartPixelFromEdgeInner_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromEdge).ToString();
            txt_StartPixelFromRightInner_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromRight).ToString();
            txt_StartPixelFromBottomInner_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromBottom).ToString();
            txt_StartPixelFromLeftInner_Mold.Text = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromLeft).ToString();

            m_fStartPixelFromEdgeInnerPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromEdge);
            m_fStartPixelFromRightInnerPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromRight);
            m_fStartPixelFromBottomInnerPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromBottom);
            m_fStartPixelFromLeftInnerPrev_Mold = (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelInnerFromLeft);

            if (m_smVisionInfo.g_strVisionName == "Pad5S")
                picUnitROI.Image = ils_ImageListTree.Images[7];
            else
                picUnitROI.Image = ils_ImageListTree.Images[4];

            cbo_ImagesList.Items.Clear();
            for (int i = 0; i < m_smVisionInfo.g_arrImages.Count; i++)
            {
                cbo_ImagesList.Items.Add("Grab Image " + (i + 1));
            }

            chk_ShowDraggingBox.Checked = true;
            chk_ShowSamplePoints.Checked = true;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnDrawDraggingBox = chk_ShowDraggingBox.Checked;
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnDrawSamplingPoint = chk_ShowSamplePoints.Checked;
            }

            m_smVisionInfo.g_intSelectedROI = 0;

            //fix use gauge for measurement
            chk_UseGauge.Checked = true; //m_smVisionInfo.g_arrPad[0].ref_blnWantGaugeMeasurePkgSize;

            chk_ShowDraggingBox.Enabled = m_blnUserRightEnableGaugeSetting;
            chk_ShowSamplePoints.Enabled = m_blnUserRightEnableGaugeSetting;
            btn_GaugeAdvanceSetting.Enabled = m_blnUserRightEnableGaugeSetting;
            //gp_Rotation.Visible = false;
            //btn_GaugeSaveClose.Text = "Save Gauge && Close";
            m_smVisionInfo.g_blnViewGauge = true;

            //if (m_smVisionInfo.g_arrPad.Length > 1)
            //{
            //    // Display "Selected all Pads ROI" if center pad and side pad image index are same
            //    if (m_smVisionInfo.g_arrPad[0].ref_intCheckPadDimensionImageIndex == m_smVisionInfo.g_arrPad[1].ref_intCheckPadDimensionImageIndex)
            //        cbo_SelectPadROIs.SelectedIndex = 0;    // Select all pads
            //    else
            //    {
            //        cbo_SelectPadROIs.SelectedIndex = 1;    // Display Center ROIs
            //    }
            //}
            //else
            //{
            //    // Hide combo box since got 1 pad only.
            //    srmLabel27.Visible = false;
            //    cbo_SelectPadROIs.Visible = false;
            //    cbo_SelectPadROIs.SelectedIndex = 0;    // Select all pads
            //}

            cbo_ImagesList.SelectedIndex = m_smVisionInfo.g_arrPad[0].ref_intCheckPadDimensionImageIndex;      // Select images 1

            //if (cbo_SelectPadROIs.SelectedIndex == 0)
            //{
            //    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            //    {
            //        m_smVisionInfo.g_arrPad[i].ref_blnSelected = true;
            //    }

            //}
            //else
            //{
            //    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            //    {
            //        if (i == 0)
            //            m_smVisionInfo.g_arrPad[i].ref_blnSelected = true;
            //        else
            //            m_smVisionInfo.g_arrPad[i].ref_blnSelected = false;
            //    }
            //}

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnSelected = true;
            }

            m_blnUpdateSelectedROISetting = false;
            cbo_DontCareAreaDrawMethod.SelectedIndex = 0;
            radio_Bright.Checked = true;
            m_smVisionInfo.g_intSelectedType = 0; // 2020-02-27 ZJYEOH : Need to reset m_smVisionInfo.g_intSelectedType to 0 so that dark dont care area will not draw on white image when user previously exit form by selecting dark image

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs.Count > m_smVisionInfo.g_intSelectedROI && m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count > 1)
            {
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count == 0 && m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count == 0)
                {
                    txt_DunCareROIBright.Text = 0.ToString();
                    txt_DunCareROIDark.Text = 0.ToString();
                }
                else
                {
                    txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count.ToString();
                    txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count.ToString();
                }
            }
            else
            {
                txt_DunCareROIBright.Text = 0.ToString();
                txt_DunCareROIDark.Text = 0.ToString();
            }

        }

        private void UpdateGUI()
        {
            m_blnUpdateSelectedROISetting = true;
           
            // Package size
            txt_UnitSizeMinWidth.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitWidthMin.ToString("F4");
            txt_UnitSizeMinHeight.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitHeightMin.ToString("F4");
            txt_UnitSizeMaxWidth.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitWidthMax.ToString("F4");
            txt_UnitSizeMaxHeight.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitHeightMax.ToString("F4");
            txt_UnitSizeMinThickness.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitThicknessMin.ToString("F4");
            txt_UnitSizeMaxThickness.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fUnitThicknessMax.ToString("F4");
            txt_ImageGain.Value = Convert.ToDecimal(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fImageGain);
            //txt_StartPixelFromEdge.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromEdge(1).ToString("F4");
            //txt_StartPixelFromRight.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromRight(1).ToString("F4");
            //txt_StartPixelFromBottom.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromBottom(1).ToString("F4");
            //txt_StartPixelFromLeft.Text = m_smVisionInfo.g_arrPad[0].GetPkgStartPixelFromLeft(1).ToString("F4");
            switch (m_smVisionInfo.g_intSelectedROI)
            {
                case 0:
                case 1:
                    if (cbo_PkgDefectType.SelectedIndex == 0 || !m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_blnSeperateBrightDarkROITolerance)
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft).ToString();
                    }
                    else
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark).ToString();
                    }

                    m_fStartPixelFromEdgePrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge);
                    m_fStartPixelFromRightPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight);
                    m_fStartPixelFromBottomPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom);
                    m_fStartPixelFromLeftPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft);

                    m_fStartPixelFromEdgePrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark);
                    m_fStartPixelFromRightPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark);
                    m_fStartPixelFromBottomPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark);
                    m_fStartPixelFromLeftPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark);

                    txt_StartPixelFromEdge_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge).ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight).ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom).ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft).ToString();

                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                    {
                        txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge).ToString();
                        txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight).ToString();
                        txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom).ToString();
                        txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft).ToString();
                    }
                    else
                    {
                        txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark).ToString();
                        txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark).ToString();
                        txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark).ToString();
                        txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark).ToString();
                    }

                    m_fStartPixelFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge);
                    m_fStartPixelFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight);
                    m_fStartPixelFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom);
                    m_fStartPixelFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft);

                    m_fStartPixelFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark);
                    m_fStartPixelFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark);
                    m_fStartPixelFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark);
                    m_fStartPixelFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark);

                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                    {
                        txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge).ToString();
                        txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight).ToString();
                        txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom).ToString();
                        txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft).ToString();
                    }
                    else
                    {
                        txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark).ToString();
                        txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark).ToString();
                        txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark).ToString();
                        txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark).ToString();
                    }

                    m_fStartPixelExtendFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge);
                    m_fStartPixelExtendFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight);
                    m_fStartPixelExtendFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom);
                    m_fStartPixelExtendFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft);

                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark);
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark);
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark);
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark);

                    m_fStartPixelFromEdgePrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge);
                    m_fStartPixelFromRightPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight);
                    m_fStartPixelFromBottomPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom);
                    m_fStartPixelFromLeftPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft);

                    txt_StartPixelFromEdge_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge).ToString();
                    txt_StartPixelFromRight_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight).ToString();
                    txt_StartPixelFromBottom_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom).ToString();
                    txt_StartPixelFromLeft_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft).ToString();

                    m_fStartPixelFromEdgePrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge);
                    m_fStartPixelFromRightPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight);
                    m_fStartPixelFromBottomPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom);
                    m_fStartPixelFromLeftPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft);

                    txt_StartPixelFromEdgeInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge).ToString();
                    txt_StartPixelFromRightInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight).ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom).ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft).ToString();

                    m_fStartPixelFromEdgeInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge);
                    m_fStartPixelFromRightInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight);
                    m_fStartPixelFromBottomInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom);
                    m_fStartPixelFromLeftInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft);
                    break;
                case 2:
                    if (cbo_PkgDefectType.SelectedIndex == 0 || !m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_blnSeperateBrightDarkROITolerance)
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge).ToString();
                    }
                    else
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark).ToString();
                    }

                    m_fStartPixelFromEdgePrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight);
                    m_fStartPixelFromRightPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom);
                    m_fStartPixelFromBottomPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft);
                    m_fStartPixelFromLeftPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge);

                    m_fStartPixelFromEdgePrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark);
                    m_fStartPixelFromRightPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark);
                    m_fStartPixelFromBottomPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark);
                    m_fStartPixelFromLeftPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark);

                    txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight).ToString();
                    txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom).ToString();
                    txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft).ToString();
                    txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge).ToString();

                    m_fStartPixelFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight);
                    m_fStartPixelFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom);
                    m_fStartPixelFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft);
                    m_fStartPixelFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge);

                    m_fStartPixelFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark);
                    m_fStartPixelFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark);
                    m_fStartPixelFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark);
                    m_fStartPixelFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark);

                    txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight).ToString();
                    txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom).ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft).ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge).ToString();

                    txt_StartPixelFromEdge_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight).ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom).ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft).ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge).ToString();

                    m_fStartPixelFromEdgePrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight);
                    m_fStartPixelFromRightPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom);
                    m_fStartPixelFromBottomPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft);
                    m_fStartPixelFromLeftPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge);


                    m_fStartPixelExtendFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight);
                    m_fStartPixelExtendFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom);
                    m_fStartPixelExtendFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft);
                    m_fStartPixelExtendFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge);

                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark);
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark);
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark);
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark);

  
                    txt_StartPixelFromEdge_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight).ToString();
                    txt_StartPixelFromRight_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom).ToString();
                    txt_StartPixelFromBottom_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft).ToString();
                    txt_StartPixelFromLeft_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge).ToString();

                    m_fStartPixelFromEdgePrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight);
                    m_fStartPixelFromRightPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom);
                    m_fStartPixelFromBottomPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft);
                    m_fStartPixelFromLeftPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge);

                    txt_StartPixelFromEdgeInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight).ToString();
                    txt_StartPixelFromRightInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom).ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft).ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge).ToString();

                    m_fStartPixelFromEdgeInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight);
                    m_fStartPixelFromRightInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom);
                    m_fStartPixelFromBottomInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft);
                    m_fStartPixelFromLeftInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge);
                    break;
                case 3:
                    if (cbo_PkgDefectType.SelectedIndex == 0 || !m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_blnSeperateBrightDarkROITolerance)
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight).ToString();
                    }
                    else
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark).ToString();
                    }

                    m_fStartPixelFromEdgePrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom);
                    m_fStartPixelFromRightPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft);
                    m_fStartPixelFromBottomPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge);
                    m_fStartPixelFromLeftPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight);

                    m_fStartPixelFromEdgePrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark);
                    m_fStartPixelFromRightPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark);
                    m_fStartPixelFromBottomPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark);
                    m_fStartPixelFromLeftPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark);

                    txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom).ToString();
                    txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft).ToString();
                    txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge).ToString();
                    txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight).ToString();

                    m_fStartPixelFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom);
                    m_fStartPixelFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft);
                    m_fStartPixelFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge);
                    m_fStartPixelFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight);

                    txt_StartPixelFromEdge_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom).ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft).ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge).ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight).ToString();

                    m_fStartPixelFromEdgePrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom);
                    m_fStartPixelFromRightPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft);
                    m_fStartPixelFromBottomPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge);
                    m_fStartPixelFromLeftPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight);

                    m_fStartPixelFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark);
                    m_fStartPixelFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark);
                    m_fStartPixelFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark);
                    m_fStartPixelFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark);

                    txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom).ToString();
                    txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft).ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge).ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight).ToString();

                    m_fStartPixelExtendFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom);
                    m_fStartPixelExtendFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft);
                    m_fStartPixelExtendFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge);
                    m_fStartPixelExtendFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight);

                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark);
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark);
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark);
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark);

                    txt_StartPixelFromEdge_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom).ToString();
                    txt_StartPixelFromRight_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft).ToString();
                    txt_StartPixelFromBottom_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge).ToString();
                    txt_StartPixelFromLeft_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight).ToString();

                    m_fStartPixelFromEdgePrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom);
                    m_fStartPixelFromRightPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft);
                    m_fStartPixelFromBottomPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge);
                    m_fStartPixelFromLeftPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight);

                    txt_StartPixelFromEdgeInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom).ToString();
                    txt_StartPixelFromRightInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft).ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge).ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight).ToString();

                    m_fStartPixelFromEdgeInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom);
                    m_fStartPixelFromRightInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft);
                    m_fStartPixelFromBottomInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge);
                    m_fStartPixelFromLeftInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight);
                    break;
                case 4:
                    if (cbo_PkgDefectType.SelectedIndex == 0 || !m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_blnSeperateBrightDarkROITolerance)
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom).ToString();
                    }
                    else
                    {
                        txt_StartPixelFromEdge.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark).ToString();
                        txt_StartPixelFromRight.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark).ToString();
                        txt_StartPixelFromBottom.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark).ToString();
                        txt_StartPixelFromLeft.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark).ToString();
                    }

                    m_fStartPixelFromEdgePrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft);
                    m_fStartPixelFromRightPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge);
                    m_fStartPixelFromBottomPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight);
                    m_fStartPixelFromLeftPrev = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom);

                    m_fStartPixelFromEdgePrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark);
                    m_fStartPixelFromRightPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark);
                    m_fStartPixelFromBottomPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark);
                    m_fStartPixelFromLeftPrev_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark);

                    txt_StartPixelFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft).ToString();
                    txt_StartPixelFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge).ToString();
                    txt_StartPixelFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight).ToString();
                    txt_StartPixelFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom).ToString();

                    m_fStartPixelFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft);
                    m_fStartPixelFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge);
                    m_fStartPixelFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight);
                    m_fStartPixelFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom);

                    txt_StartPixelFromEdge_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft).ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge).ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight).ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom).ToString();

                    m_fStartPixelFromEdgePrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromLeft);
                    m_fStartPixelFromRightPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromEdge);
                    m_fStartPixelFromBottomPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromRight);
                    m_fStartPixelFromLeftPrev_ForeignMaterial = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fForeignMaterialStartPixelFromBottom);

                    m_fStartPixelFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark);
                    m_fStartPixelFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark);
                    m_fStartPixelFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark);
                    m_fStartPixelFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark);

                    txt_StartPixelExtendFromEdge_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft).ToString();
                    txt_StartPixelExtendFromRight_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge).ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight).ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom).ToString();

                    m_fStartPixelExtendFromEdgePrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft);
                    m_fStartPixelExtendFromRightPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge);
                    m_fStartPixelExtendFromBottomPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight);
                    m_fStartPixelExtendFromLeftPrev_Chipped = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom);

                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark);
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark);
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark);
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark);

                    txt_StartPixelFromEdge_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft).ToString();
                    txt_StartPixelFromRight_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge).ToString();
                    txt_StartPixelFromBottom_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight).ToString();
                    txt_StartPixelFromLeft_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom).ToString();

                    m_fStartPixelFromEdgePrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft);
                    m_fStartPixelFromRightPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge);
                    m_fStartPixelFromBottomPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight);
                    m_fStartPixelFromLeftPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom);

                    txt_StartPixelFromEdgeInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft).ToString();
                    txt_StartPixelFromRightInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge).ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight).ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom).ToString();

                    m_fStartPixelFromEdgeInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft);
                    m_fStartPixelFromRightInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge);
                    m_fStartPixelFromBottomInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight);
                    m_fStartPixelFromLeftInnerPrev_Mold = (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom);
                    break;
            }

            CheckPkgROISetting();
            CheckChippedOffOutwardROISetting();
            CheckChippedOffInwardROISetting();
            CheckMoldFlashOuterROISetting();
            CheckMoldFlashInnerROISetting();
            m_blnUpdateSelectedROISetting = false;
        }

        private void SaveDontCareSetting(string strFolderPath)
        {
            ImageDrawing objImage = new ImageDrawing();
            ImageDrawing objFinalImage = new ImageDrawing();
            //for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            //{
            //    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
            //        break;

            //    for (int j = 0; j < 2; j++)
            //    {
            //        ////Check is the ROI for drawing dont care changed
            //        //m_smVisionInfo.g_arrPolygon_Package[i][j].CheckDontCarePosition(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
            //        Polygon.CreateDontCareImageWithPolygonPattern(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_arrPolygon_PadPackage[i][j], m_smVisionInfo.g_objBlackImage, ref objImage, m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
            //        objImage.SaveImage(strFolderPath + "DontCareImage" + i.ToString() + "_" + j.ToString() + ".bmp");
            //    }
            //}

            //if (chk_BrightAndDarkSameDontCareArea.Checked)
            //{
            //    for (int i = 0; i < m_smVisionInfo.g_arrPadROIs.Count; i++)
            //    {
            //        if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
            //            break;
            //        if (m_smVisionInfo.g_intSelectedType == 0)
            //        {
            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Clear();
            //            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count > 1)
            //                m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1].Clear();
            //        }
            //        else
            //        {
            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Clear();
            //            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count > 0)
            //                m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0].Clear();
            //        }

            //        if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0].Count == 0)
            //        {
            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Clear();
            //        }
            //        if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1].Count == 0)
            //        {
            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Clear();
            //        }
            //    }
            //}

            for (int i = 0; i < m_smVisionInfo.g_arrPadPackageDontCareROIs.Count; i++)
            {
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());

                for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count; j++)
                {
                    for (int k = 0; k < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j].Count; k++)
                    {
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                    }
                }

            }

            for (int i = 0; i < m_smVisionInfo.g_arrPolygon_PadPackage.Count; i++)
            {
                for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i].Count; j++)
                {
                    //if (m_smVisionInfo.g_intSelectedType == j)
                    //{
                    for (int k = 0; k < m_smVisionInfo.g_arrPolygon_PadPackage[i][j].Count; k++)
                    {
                        if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j].Count > k)
                        {
                            //if (chk_BrightAndDarkSameDontCareArea.Checked)
                            //{
                            //    if (m_smVisionInfo.g_intSelectedType == 0)
                            //    {
                            //        if (m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Count <= k)
                            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Add(new Polygon());
                            //    }
                            //    else
                            //    {
                            //        if (m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Count <= k)
                            //            m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Add(new Polygon());
                            //    }
                            //}

                            if (m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].ref_intFormMode != 2)
                            {
                                m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].AddPoint(new PointF(m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROITotalX * m_smVisionInfo.g_fScaleX,
                                    m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROITotalY * m_smVisionInfo.g_fScaleY));
                                m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].AddPoint(new PointF((m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROITotalX + m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROIWidth) * m_smVisionInfo.g_fScaleX,
                                    (m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROITotalY + m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROIHeight) * m_smVisionInfo.g_fScaleY));

                                m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].AddPolygon((int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterX * m_smVisionInfo.g_fScaleX), (int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterY * m_smVisionInfo.g_fScaleY));
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].ResetPointsUsingOffset(m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROICenterX * m_smVisionInfo.g_fScaleX / m_smVisionInfo.g_fZoomScale, m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].ref_ROICenterY * m_smVisionInfo.g_fScaleY / m_smVisionInfo.g_fZoomScale);
                                m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].AddPolygon((int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterX * m_smVisionInfo.g_fScaleX / m_smVisionInfo.g_fZoomScale), (int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterY * m_smVisionInfo.g_fScaleY / m_smVisionInfo.g_fZoomScale));
                            }
                        }
                    }
                    //}
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPolygon_PadPackage.Count; i++)
            {
                if (chk_BrightAndDarkSameDontCareArea.Checked)
                {
                    if (m_smVisionInfo.g_intSelectedType == 0)
                    {
                        for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Count; j++)
                        {
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j].ClearPolygon();
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][m_smVisionInfo.g_intSelectedType][j].CopyAllTo(m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j]);
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j].AddPolygon((int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterX * m_smVisionInfo.g_fScaleX / m_smVisionInfo.g_fZoomScale), (int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterY * m_smVisionInfo.g_fScaleY / m_smVisionInfo.g_fZoomScale));
                        }
                    }
                    else
                    {
                        for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Count; j++)
                        {
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j].ClearPolygon();
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][m_smVisionInfo.g_intSelectedType][j].CopyAllTo(m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j]);
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j].AddPolygon((int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterX * m_smVisionInfo.g_fScaleX / m_smVisionInfo.g_fZoomScale), (int)(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalCenterY * m_smVisionInfo.g_fScaleY / m_smVisionInfo.g_fZoomScale));
                        }
                    }

                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPolygon_PadPackage.Count; i++)
            {
                for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i].Count; j++)
                {
                    m_smVisionInfo.g_objBlackImage.CopyTo(objFinalImage);
                    for (int k = 0; k < m_smVisionInfo.g_arrPolygon_PadPackage[i][j].Count; k++)
                    {
                        //m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].CheckDontCarePosition(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
                        //Polygon.CreateDontCareImageWithPolygonPattern(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k], m_smVisionInfo.g_objBlackImage, ref objImage, m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
                        if (m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k].ref_intFormMode != 2)
                            Polygon.CreateDontCareImageWithPolygonPattern_ExtendEdge(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k], m_smVisionInfo.g_objBlackImage, ref objImage, m_smVisionInfo.g_fScaleX, m_smVisionInfo.g_fScaleY);
                        else
                            Polygon.CreateDontCareImageWithPolygonPattern(m_smVisionInfo.g_arrPadROIs[i][2], m_smVisionInfo.g_arrPolygon_PadPackage[i][j][k], m_smVisionInfo.g_objBlackImage, ref objImage, m_smVisionInfo.g_fScaleX / m_smVisionInfo.g_fZoomScale, m_smVisionInfo.g_fScaleY / m_smVisionInfo.g_fZoomScale);

                        ImageDrawing.AddTwoImageTogether(ref objImage, ref objFinalImage);
                    }
                    objFinalImage.SaveImage(strFolderPath + "DontCareImage" + i.ToString() + "_" + j.ToString() + ".bmp");
                }
            }

            objImage.Dispose();
            objFinalImage.Dispose();
            Polygon.SavePolygon(strFolderPath + "Polygon.xml", m_smVisionInfo.g_arrPolygon_PadPackage);
        }


        private void txt_StartPixelFromEdge_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromEdge.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromEdge.Text == "" || fStartPixelFromEdge < 0)
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;

            // int intEdgeDistance = (int)Math.Round(Convert.ToSingle(fStartPixelFromEdge) * m_smVisionInfo.g_fCalibPixelY, 0, MidpointRounding.AwayFromZero);


            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                //if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromEdge.Text = m_fStartPixelFromEdgePrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}
                //else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromEdge.Text = m_fStartPixelFromEdgePrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}

                if ((i == 0 || i == 1) && ((fStartPixelFromEdge + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromEdgePrev.ToString();
                    else
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromEdgePrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 3) && ((fStartPixelFromEdge + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromBottomPrev.ToString();
                    else
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromBottomPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2) && ((fStartPixelFromEdge + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromRightPrev.ToString();
                    else
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromRightPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 4) && ((fStartPixelFromEdge + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromLeftPrev.ToString();
                    else
                        txt_StartPixelFromEdge.Text = m_fStartPixelFromLeftPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll.Checked)
                {
                    txt_StartPixelFromRight.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;
                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                }
                //m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionY + (int)fStartPixelFromEdge,
                //                         m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight,
                //                         m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight - (int)fStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom);

                //  m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //  m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                // m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + (int)fStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - (int)fStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom));


                m_smVisionInfo.g_arrPadROIs[i][2].AttachImage(m_smVisionInfo.g_arrPadROIs[i][0]);

            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromEdge;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }
            if (cbo_PkgDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromEdgePrev = fStartPixelFromEdge;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromEdgePrev_Dark = fStartPixelFromEdge;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Dark = fStartPixelFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelFromEdgePrev_Dark = fStartPixelFromEdge;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Dark = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromEdgePrev = fStartPixelFromEdge;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev = fStartPixelFromEdge;
                    }
                }
            }

            CheckPkgROISetting();

            //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs, (int)Math.Round(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetPkgStartPixelFromEdge(-1), 0, MidpointRounding.AwayFromZero));
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromRight_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromRight = 0;
            if (!float.TryParse(txt_StartPixelFromRight.Text, out fStartPixelFromRight))
                return;

            if (!m_blnInitDone || txt_StartPixelFromRight.Text == "" || fStartPixelFromRight < 0)
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                //if ((i == 0 || i == 1 || i == 3) && fStartPixelFromRight >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromRight.Text = m_fStartPixelFromRightPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}
                //else if ((i == 2 || i == 4) && fStartPixelFromRight >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromRight.Text = m_fStartPixelFromRightPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}

                if ((i == 0 || i == 1) && ((fStartPixelFromRight + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight.Text = m_fStartPixelFromRightPrev.ToString();
                    else
                        txt_StartPixelFromRight.Text = m_fStartPixelFromRightPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 3) && ((fStartPixelFromRight + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight.Text = m_fStartPixelFromLeftPrev.ToString();
                    else
                        txt_StartPixelFromRight.Text = m_fStartPixelFromLeftPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2) && ((fStartPixelFromRight + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight.Text = m_fStartPixelFromBottomPrev.ToString();
                    else
                        txt_StartPixelFromRight.Text = m_fStartPixelFromBottomPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 4) && ((fStartPixelFromRight + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight.Text = m_fStartPixelFromEdgePrev.ToString();
                    else
                        txt_StartPixelFromRight.Text = m_fStartPixelFromEdgePrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll.Checked)
                {
                    txt_StartPixelFromEdge.Text = fStartPixelFromRight.ToString();
                    txt_StartPixelFromBottom.Text = fStartPixelFromRight.ToString();
                    txt_StartPixelFromLeft.Text = fStartPixelFromRight.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;
                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                }
                            }
                        }
                        break;
                }
                //m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)fStartPixelFromRight,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom);

                //   m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //  m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                // m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)fStartPixelFromRight),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom));

                m_smVisionInfo.g_arrPadROIs[i][2].AttachImage(m_smVisionInfo.g_arrPadROIs[i][0]);
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromRight;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromRight;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromRight;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromRight;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromRight;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromRight;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_PkgDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromRightPrev = fStartPixelFromRight;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromEdgePrev = fStartPixelFromRight;
                    m_fStartPixelFromBottomPrev = fStartPixelFromRight;
                    m_fStartPixelFromLeftPrev = fStartPixelFromRight;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromRightPrev_Dark = fStartPixelFromRight;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Dark = fStartPixelFromRight;
                        m_fStartPixelFromBottomPrev_Dark = fStartPixelFromRight;
                        m_fStartPixelFromLeftPrev_Dark = fStartPixelFromRight;
                    }
                }
            }
            else
            {
                m_fStartPixelFromRightPrev_Dark = fStartPixelFromRight;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromEdgePrev_Dark = fStartPixelFromRight;
                    m_fStartPixelFromBottomPrev_Dark = fStartPixelFromRight;
                    m_fStartPixelFromLeftPrev_Dark = fStartPixelFromRight;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromRightPrev = fStartPixelFromRight;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromEdgePrev = fStartPixelFromRight;
                        m_fStartPixelFromBottomPrev = fStartPixelFromRight;
                        m_fStartPixelFromLeftPrev = fStartPixelFromRight;
                    }
                }
            }

            CheckPkgROISetting();
            //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs, (int)Math.Round(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetPkgStartPixelFromEdge(-1), 0, MidpointRounding.AwayFromZero));
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromBottom_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromBottom = 0;
            if (!float.TryParse(txt_StartPixelFromBottom.Text, out fStartPixelFromBottom))
                return;

            if (!m_blnInitDone || txt_StartPixelFromBottom.Text == "" || fStartPixelFromBottom < 0)
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                //if ((i == 0 || i == 1 || i == 3) && fStartPixelFromBottom >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}
                //else if ((i == 2 || i == 4) && fStartPixelFromBottom >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}

                if ((i == 0 || i == 1) && ((fStartPixelFromBottom + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 3) && ((fStartPixelFromBottom + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromEdgePrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromEdgePrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2) && ((fStartPixelFromBottom + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromLeftPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromLeftPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 4) && ((fStartPixelFromBottom + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromRightPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromRightPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll.Checked)
                {
                    txt_StartPixelFromEdge.Text = fStartPixelFromBottom.ToString();
                    txt_StartPixelFromRight.Text = fStartPixelFromBottom.ToString();
                    txt_StartPixelFromLeft.Text = fStartPixelFromBottom.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                }
                            }
                        }
                        break;
                }
                //m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)fStartPixelFromBottom);

                //        m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //  m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                // m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)fStartPixelFromBottom));

                m_smVisionInfo.g_arrPadROIs[i][2].AttachImage(m_smVisionInfo.g_arrPadROIs[i][0]);
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromBottom;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromBottom;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromBottom;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromBottom;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromBottom;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromBottom;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_PkgDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromBottomPrev = fStartPixelFromBottom;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev = fStartPixelFromBottom;
                    m_fStartPixelFromEdgePrev = fStartPixelFromBottom;
                    m_fStartPixelFromLeftPrev = fStartPixelFromBottom;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromBottomPrev_Dark = fStartPixelFromBottom;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev_Dark = fStartPixelFromBottom;
                        m_fStartPixelFromEdgePrev_Dark = fStartPixelFromBottom;
                        m_fStartPixelFromLeftPrev_Dark = fStartPixelFromBottom;
                    }
                }
            }
            else
            {
                m_fStartPixelFromBottomPrev_Dark = fStartPixelFromBottom;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev_Dark = fStartPixelFromBottom;
                    m_fStartPixelFromEdgePrev_Dark = fStartPixelFromBottom;
                    m_fStartPixelFromLeftPrev_Dark = fStartPixelFromBottom;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromBottomPrev = fStartPixelFromBottom;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev = fStartPixelFromBottom;
                        m_fStartPixelFromEdgePrev = fStartPixelFromBottom;
                        m_fStartPixelFromLeftPrev = fStartPixelFromBottom;
                    }
                }
            }

            CheckPkgROISetting();
            //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs, (int)Math.Round(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetPkgStartPixelFromEdge(-1), 0, MidpointRounding.AwayFromZero));
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromLeft_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromLeft = 0;
            if (!float.TryParse(txt_StartPixelFromLeft.Text, out fStartPixelFromLeft))
                return;

            if (!m_blnInitDone || txt_StartPixelFromLeft.Text == "" || fStartPixelFromLeft < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                //if ((i == 0 || i == 1 || i == 3) && fStartPixelFromLeft >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromLeft.Text = m_fStartPixelFromLeftPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}
                //else if ((i == 2 || i == 4) && fStartPixelFromLeft >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                //{
                //    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                //    txt_StartPixelFromLeft.Text = m_fStartPixelFromLeftPrev.ToString();
                //    m_blnUpdateSelectedROISetting = false;
                //    return;
                //}

                if ((i == 0 || i == 1) && ((fStartPixelFromLeft + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromLeftPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromLeftPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 3) && ((fStartPixelFromLeft + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft) >= (fUnitWidth * m_smVisionInfo.g_fCalibPixelX)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromRightPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromRightPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2) && ((fStartPixelFromLeft + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromEdgePrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromEdgePrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 4) && ((fStartPixelFromLeft + m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge) >= (fUnitHeight * m_smVisionInfo.g_fCalibPixelY)))
                {
                    SRMMessageBox.Show("Edge tolerance cannot goes beyond opposite direction tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_PkgDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev.ToString();
                    else
                        txt_StartPixelFromBottom.Text = m_fStartPixelFromBottomPrev_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll.Checked)
                {
                    txt_StartPixelFromEdge.Text = fStartPixelFromLeft.ToString();
                    txt_StartPixelFromRight.Text = fStartPixelFromLeft.ToString();
                    txt_StartPixelFromBottom.Text = fStartPixelFromLeft.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_PkgDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                            }

                            if (chk_SetToBrightDark.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                }
                            }
                        }
                        break;
                }
                //m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionX + (int)fStartPixelFromLeft, m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIPositionY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth - (int)fStartPixelFromLeft - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight,
                //                          m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom);

                //       m_smVisionInfo.g_arrPadROIs[i][2].LoadROISetting(
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.X -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) / 2) -
                //  m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + (int)fStartPixelFromLeft, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Round(m_smVisionInfo.g_arrPad[i].ref_objRectGauge4L.ref_pRectCenterPoint.Y -
                //(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) / 2) -
                // m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge, 0, MidpointRounding.AwayFromZero),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxWidth_RectGauge4L(0) - (int)fStartPixelFromLeft +- (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight),
                //(int)Math.Ceiling(m_smVisionInfo.g_arrPad[i].GetResultMaxHeight_RectGauge4L(0) - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge - (int)m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom));

                m_smVisionInfo.g_arrPadROIs[i][2].AttachImage(m_smVisionInfo.g_arrPadROIs[i][0]);
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_PkgDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom_Dark = fStartPixelFromLeft;
                                if (chk_SetToAll.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight_Dark = fStartPixelFromLeft;
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft_Dark = fStartPixelFromLeft;
                                }

                                if (chk_SetToBrightDark.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromBottom = fStartPixelFromLeft;
                                    if (chk_SetToAll.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromEdge = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromRight = fStartPixelFromLeft;
                                        m_smVisionInfo.g_arrPad[i].ref_fPkgStartPixelFromLeft = fStartPixelFromLeft;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_PkgDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromLeftPrev = fStartPixelFromLeft;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev = fStartPixelFromLeft;
                    m_fStartPixelFromEdgePrev = fStartPixelFromLeft;
                    m_fStartPixelFromBottomPrev = fStartPixelFromLeft;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromLeftPrev_Dark = fStartPixelFromLeft;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev_Dark = fStartPixelFromLeft;
                        m_fStartPixelFromEdgePrev_Dark = fStartPixelFromLeft;
                        m_fStartPixelFromBottomPrev_Dark = fStartPixelFromLeft;
                    }
                }
            }
            else
            {
                m_fStartPixelFromLeftPrev_Dark = fStartPixelFromLeft;
                if (chk_SetToAll.Checked)
                {
                    m_fStartPixelFromRightPrev_Dark = fStartPixelFromLeft;
                    m_fStartPixelFromEdgePrev_Dark = fStartPixelFromLeft;
                    m_fStartPixelFromBottomPrev_Dark = fStartPixelFromLeft;
                }

                if (chk_SetToBrightDark.Checked)
                {
                    m_fStartPixelFromLeftPrev = fStartPixelFromLeft;
                    if (chk_SetToAll.Checked)
                    {
                        m_fStartPixelFromRightPrev = fStartPixelFromLeft;
                        m_fStartPixelFromEdgePrev = fStartPixelFromLeft;
                        m_fStartPixelFromBottomPrev = fStartPixelFromLeft;
                    }
                }
            }

            CheckPkgROISetting();
            //AddTrainPackageROI(m_smVisionInfo.g_arrPadROIs, (int)Math.Round(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetPkgStartPixelFromEdge(-1), 0, MidpointRounding.AwayFromZero));
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }


        private void btn_Cancel_Click(object sender, EventArgs e)
        {
            LoadROISetting(m_strFolderPath + "ROI.xml", m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrPad.Length);
            ROI.LoadFile(m_strFolderPathPkg + "DontCareROI.xml", m_smVisionInfo.g_arrPadPackageDontCareROIs);
            for (int i = 0; i < m_smVisionInfo.g_arrPadPackageDontCareROIs.Count; i++)
            {
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());

                for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count; j++)
                {
                    for (int k = 0; k < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j].Count; k++)
                    {
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                    }
                }

            }
            LoadPadSetting(m_strFolderPath);
            Polygon.LoadPolygon(m_strFolderPathPkg + "Template\\Polygon.xml", m_smVisionInfo.g_arrPolygon_PadPackage, false);
            AttachImageToROI(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrImages[0]);

            DialogResult = DialogResult.Cancel;
            Close();
            Dispose();
        }

        private void btn_RotateUnit_Click(object sender, EventArgs e)
        {

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;

            btn_ClockWise.Enabled = true;
            btn_CounterClockWise.Enabled = true;
        }
        private void UpdateMoldFlashForeColor()
        {
            if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge < m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromEdge)
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;
                        break;
                    case 2:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;
                        break;
                    case 3:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;
                        break;
                    case 4:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Red;
                        break;
                }
            }
            else
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
                        break;
                    case 2:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
                        break;
                    case 3:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
                        break;
                    case 4:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
                        break;
                }
            }

            if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight < m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromRight)
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Red;
                        break;
                    case 2:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;
                        break;
                    case 3:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;
                        break;
                    case 4:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;
                        break;
                }
            }
            else
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
                        break;
                    case 2:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
                        break;
                    case 3:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
                        break;
                    case 4:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
                        break;
                }
            }

            if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom < m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromBottom)
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;
                        break;
                    case 2:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Red;
                        break;
                    case 3:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;
                        break;
                    case 4:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;
                        break;
                }
            }
            else
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
                        break;
                    case 2:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
                        break;
                    case 3:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
                        break;
                    case 4:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
                        break;
                }
            }

            if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft < m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelInnerFromLeft)
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;
                        break;
                    case 2:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;
                        break;
                    case 3:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Red;
                        break;
                    case 4:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Red;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;
                        break;
                }
            }
            else
            {
                switch (m_smVisionInfo.g_intSelectedROI)
                {
                    case 0:
                    case 1:
                        txt_StartPixelFromLeft_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
                        break;
                    case 2:
                        txt_StartPixelFromBottom_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
                        break;
                    case 3:
                        txt_StartPixelFromRight_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
                        break;
                    case 4:
                        txt_StartPixelFromEdge_Mold.ForeColor = Color.Black;
                        txt_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
                        break;
                }
            }
        }
        private void btn_Next_Click(object sender, EventArgs e)
        {
            if (m_smVisionInfo.g_intLearnStepNo == 2) // Chipped off ROI setting form
            {
                if (!IsChipInwardOutwardSettingCorrect(true))
                    return;
            }

            // 2020 11 28 - CCENG: Package tolerance setting no need to diplay and checking in step 1, but should display in tolerance page only which is more clean and clear.
            //if (m_smVisionInfo.g_intLearnStepNo == 0 && m_intLearnType < 2)
            //{
            //    if (Convert.ToDecimal(txt_UnitSizeMinWidth.Text) <= 0 || Convert.ToDecimal(txt_UnitSizeMinHeight.Text) <= 0 ||
            //        Convert.ToDecimal(txt_UnitSizeMaxWidth.Text) <= 0 || Convert.ToDecimal(txt_UnitSizeMaxHeight.Text) <= 0)
            //    {
            //        SRMMessageBox.Show("Width or Height Min Max setting cannot be zero.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }

            //    if (Convert.ToDecimal(txt_UnitSizeMaxWidth.Text) <= Convert.ToDecimal(txt_UnitSizeMinWidth.Text))
            //    {
            //        SRMMessageBox.Show("Min Width cannot be larger than or equal to Max Width.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (Convert.ToDecimal(txt_UnitSizeMaxHeight.Text) <= Convert.ToDecimal(txt_UnitSizeMinHeight.Text))
            //    {
            //        SRMMessageBox.Show("Min Height cannot be larger than or equal to Max Height.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (Convert.ToDecimal(txt_UnitSizeMaxWidth.Text) <= Convert.ToDecimal(lbl_SizeWidthResult.Text))
            //    {
            //        SRMMessageBox.Show("Max Width cannot be smaller than or equal to measured Width.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (Convert.ToDecimal(txt_UnitSizeMaxHeight.Text) <= Convert.ToDecimal(lbl_SizeHeightResult.Text))
            //    {
            //        SRMMessageBox.Show("Max Height cannot be smaller than or equal to measured Height.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (Convert.ToDecimal(txt_UnitSizeMinWidth.Text) >= Convert.ToDecimal(lbl_SizeWidthResult.Text))
            //    {
            //        SRMMessageBox.Show("Min Width cannot be larger than or equal to measured Width.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (Convert.ToDecimal(txt_UnitSizeMinHeight.Text) >= Convert.ToDecimal(lbl_SizeHeightResult.Text))
            //    {
            //        SRMMessageBox.Show("Min Height cannot be larger than or equal to measured Height.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //        return;
            //    }
            //    if (pnl_Thickness.Visible)
            //    {
            //        if (Convert.ToDecimal(txt_UnitSizeMinThickness.Text) <= 0 || Convert.ToDecimal(txt_UnitSizeMaxThickness.Text) <= 0)
            //        {
            //            SRMMessageBox.Show("Thickness Min Max setting cannot be zero.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //            return;
            //        }

            //        if (Convert.ToDecimal(txt_UnitSizeMaxThickness.Text) <= Convert.ToDecimal(txt_UnitSizeMinThickness.Text))
            //        {
            //            SRMMessageBox.Show("Min Thickness cannot be larger than or equal to Max Thickness.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //            return;
            //        }
            //        if (lbl_SizeThicknessResult.Text == "NaN")
            //        {
            //            SRMMessageBox.Show("Thickness Measurement is not valid.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //            return;
            //        }
            //        if (Convert.ToDecimal(txt_UnitSizeMaxThickness.Text) <= Convert.ToDecimal(lbl_SizeThicknessResult.Text))
            //        {
            //            SRMMessageBox.Show("Max Thickness cannot be smaller than or equal to measured Thickness.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //            return;
            //        }
            //        if (Convert.ToDecimal(txt_UnitSizeMinThickness.Text) >= Convert.ToDecimal(lbl_SizeThicknessResult.Text))
            //        {
            //            SRMMessageBox.Show("Min Thickness cannot be larger than or equal to measured Thickness.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
            //            return;
            //        }
            //    }

            //}

            if (m_smVisionInfo.g_intLearnStepNo == 3)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                        break;

                    if ((m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge < m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge) ||
                        (m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight < m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight) ||
                        (m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom < m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom) ||
                        (m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft < m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft))
                    {
                        SRMMessageBox.Show("Mold Flash Outer tolerance cannot less than Inner tolerance.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        return;
                    }
                }
            }

            if (false)//m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage) //temporary use simple mode
            {
                if (m_smVisionInfo.g_intLearnStepNo < 10)
                    m_smVisionInfo.g_intLearnStepNo++;

                //if (m_smVisionInfo.g_intLearnStepNo == 2)
                //    if (m_smVisionInfo.g_arrImages.Count < 3)
                //    {
                //        m_smVisionInfo.g_intLearnStepNo++;
                //    }

                //if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                //{
                //    if (m_smVisionInfo.g_intLearnStepNo == 4)
                //        m_smVisionInfo.g_intLearnStepNo = 6;
                //}

            }
            else
            {
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = false;
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;

                if (m_smVisionInfo.g_intLearnStepNo < 14)
                    m_smVisionInfo.g_intLearnStepNo++;

                if (m_smVisionInfo.g_intLearnStepNo == 2 &&
                    !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                    !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
                    !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 9;

                if (m_smVisionInfo.g_intLearnStepNo == 2 &&
             !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
             !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 8;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 3 &&
             m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
             !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 4;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 2 &&
          !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 3;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 4 &&
         !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 6;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 7 &&
       !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 9;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 7 &&
   m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 8;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 6 &&
            !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting &&
            !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 9;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 6 &&
         m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting &&
            !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                {
                    m_smVisionInfo.g_intLearnStepNo = 8;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 9 &&
                    m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting &&
                    m_smVisionInfo.g_blnWantDontCareArea_Package)
                {
                    m_smVisionInfo.g_intLearnStepNo = 13;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 11 && !m_smVisionInfo.g_arrPad[0].ref_blnSeperateForeignMaterialDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 13;
            }

            m_intDisplayStep++;
            SetupSteps(true);

            if (m_intDisplayStep > 10)
                lbl_StepNo.Text = lbl_StepNo.Text.Substring(0, lbl_StepNo.Text.Length - 3) + m_intDisplayStep.ToString() + ":";
            else
                lbl_StepNo.Text = lbl_StepNo.Text.Substring(0, lbl_StepNo.Text.Length - 2) + m_intDisplayStep.ToString() + ":";

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_Previous_Click(object sender, EventArgs e)
        {
            if (m_smVisionInfo.g_intLearnStepNo == 2) // Chipped off ROI setting form
            {
                if (!IsChipInwardOutwardSettingCorrect(true))
                    return;
            }

            if (m_smVisionInfo.g_intLearnStepNo > 0)
                m_smVisionInfo.g_intLearnStepNo--;

            //if (m_smVisionInfo.g_intLearnStepNo == 2)
            //    if (m_smVisionInfo.g_arrImages.Count < 3)
            //    {
            //        m_smVisionInfo.g_intLearnStepNo--;
            //    }

            if (true)//!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage) //Temporary use simple mode
            {
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = false;
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;
                //if (m_smVisionInfo.g_intLearnStepNo == 5)
                //    m_smVisionInfo.g_intLearnStepNo = 3;

                if (m_smVisionInfo.g_intLearnStepNo == 10 &&
                    m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
                    m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting &&
                    m_smVisionInfo.g_blnWantDontCareArea_Package)
                {
                    m_smVisionInfo.g_intLearnStepNo = 8;
                }

                if (m_smVisionInfo.g_intLearnStepNo == 8 &&
                   !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                   !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
                   !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 1;

                if (m_smVisionInfo.g_intLearnStepNo == 7 &&
                  !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                  !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 1;

                if (m_smVisionInfo.g_intLearnStepNo == 7 &&
                m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 6;

                if (m_smVisionInfo.g_intLearnStepNo == 7 &&
                m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
                !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 5;

                if (m_smVisionInfo.g_intLearnStepNo == 8 &&
                m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
                !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 6;

                if (m_smVisionInfo.g_intLearnStepNo == 8 &&
              m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
              !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting &&
              !m_smVisionInfo.g_arrPad[0].ref_blnSeperateCrackDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 5;

                if (m_smVisionInfo.g_intLearnStepNo == 5 &&
           !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
           !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 1;

                if (m_smVisionInfo.g_intLearnStepNo == 3 &&
        m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
        !m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 2;

                if (m_smVisionInfo.g_intLearnStepNo == 5 &&
         !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting &&
         m_smVisionInfo.g_arrPad[0].ref_blnSeperateMoldFlashDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 3;

                if (m_smVisionInfo.g_intLearnStepNo == 2 &&
        !m_smVisionInfo.g_arrPad[0].ref_blnSeperateChippedOffDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 1;

                if (m_smVisionInfo.g_intLearnStepNo == 12 && !m_smVisionInfo.g_arrPad[0].ref_blnSeperateForeignMaterialDefectSetting)
                    m_smVisionInfo.g_intLearnStepNo = 10;
            }


            m_intDisplayStep--;
            SetupSteps(false);

            if (m_intDisplayStep > 8)
                lbl_StepNo.Text = lbl_StepNo.Text.Substring(0, lbl_StepNo.Text.Length - 3) + m_intDisplayStep.ToString() + ":";
            else
                lbl_StepNo.Text = lbl_StepNo.Text.Substring(0, lbl_StepNo.Text.Length - 2) + m_intDisplayStep.ToString() + ":";
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }
        private void SaveDontCareROISetting(string strFolderPath)
        {
            XmlParser objFile = new XmlParser(strFolderPath + "DontCareROI.xml", false);

            ROI objROI;
            for (int t = 0; t < m_smVisionInfo.g_arrPadPackageDontCareROIs.Count; t++)
            {
                if (!m_smVisionInfo.g_arrPad[t].ref_blnSelected)
                    continue;

                objFile.WriteSectionElement("Unit" + t, true);

                for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[t].Count; j++)
                {
                    objFile.WriteElement1Value("BrightOrDark" + j, "");
                    for (int k = 0; k < m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j].Count; k++)
                    {
                        //objROI = m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k];
                        objFile.WriteElement2Value("ROI" + k, "");

                        objFile.WriteElement3Value("Name", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_strROIName);
                        objFile.WriteElement3Value("Type", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_intType);
                        objFile.WriteElement3Value("PositionX", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_ROIPositionX);
                        objFile.WriteElement3Value("PositionY", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_ROIPositionY);
                        objFile.WriteElement3Value("Width", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_ROIWidth);
                        objFile.WriteElement3Value("Height", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_ROIHeight);
                        objFile.WriteElement3Value("StartOffsetX", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_intStartOffsetX);
                        objFile.WriteElement3Value("StartOffsetY", m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].ref_intStartOffsetY);
                        //m_smVisionInfo.g_arrPadPackageDontCareROIs[t][j][k].AttachImage(m_smVisionInfo.g_arrPadROIs[t][2]);

                    }
                }
            }
            objFile.WriteEndElement();


        }
        private void btn_Save_Click(object sender, EventArgs e)
        {
            float fTotalThickness = 0;
            for (int i = 1; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == 1 || i == 3)
                    fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2;
                else if (i == 2 || i == 4)
                    fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2;
            }

            //Save template width, height, thickness
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                m_smVisionInfo.g_arrPad[i].ref_fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[0].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                m_smVisionInfo.g_arrPad[i].ref_fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[0].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                if (m_smVisionInfo.g_blnCheck4Sides)
                    m_smVisionInfo.g_arrPad[i].ref_fUnitThickness = (float)Math.Round(fTotalThickness / 4, 4, MidpointRounding.AwayFromZero);
            }

            SavePadSetting(m_strFolderPath);

          
            ////Load Package Image
            //for (int intPadIndex = 0; intPadIndex < m_smVisionInfo.g_arrPad.Length; intPadIndex++)
            //{
            //    if (intPadIndex > 0 && !m_smVisionInfo.g_blnCheck4Sides)
            //        break;


            //    m_smVisionInfo.g_arrPad[intPadIndex].LoadPadTemplateImage(m_strFolderPath + "Template\\", intPadIndex);
            //    m_smVisionInfo.g_arrPad[intPadIndex].LoadPadPackageTemplateImage(m_strFolderPathPkg + "Template\\", intPadIndex);
            //}

            LoadROISetting(m_strFolderPath + "ROI.xml", m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrPad.Length);

            AttachImageToROI(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrImages[0]);

            if (m_smVisionInfo.g_blnWantDontCareArea_Package)
            {
                SaveDontCareSetting(m_strFolderPathPkg + "Template\\");
                SaveDontCareROISetting(m_strFolderPathPkg);
                ROI.LoadFile(m_strFolderPathPkg + "DontCareROI.xml", m_smVisionInfo.g_arrPadPackageDontCareROIs);
                for (int i = 0; i < m_smVisionInfo.g_arrPadPackageDontCareROIs.Count; i++)
                {
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());

                    for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count; j++)
                    {
                        for (int k = 0; k < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j].Count; k++)
                        {
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][j][k].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                        }
                    }

                }

                RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
                RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
                subkey.SetValue("BrightAndDarkSameDontCareArea_PadPackage", chk_BrightAndDarkSameDontCareArea.Checked);
            }

            //Load Package Image // 2020 07 08 - Move this Load Template function after dont caer. If no, will load old template which is not correct.
            for (int intPadIndex = 0; intPadIndex < m_smVisionInfo.g_arrPad.Length; intPadIndex++)
            {
                if (intPadIndex > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;


                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadTemplateImage(m_strFolderPath + "Template\\", intPadIndex);
                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadPackageTemplateImage(m_strFolderPathPkg + "Template\\", intPadIndex);
            }

            DialogResult = DialogResult.OK;

            if (m_smCustomizeInfo.g_blnConfigShowNetwork && m_smCustomizeInfo.g_blnWantNetwork)
                m_smProductionInfo.g_blnSaveRecipeToServer = true;

            m_smVisionInfo.g_blnUpdateSECSGEMFile = true;

            Close();
            Dispose();
        }



        private void LearnPackageForm_Load(object sender, EventArgs e)
        {
            m_smVisionInfo.g_blnReferTemplateSize = true;
            Cursor.Current = Cursors.Default;
            m_smProductionInfo.g_DTStartAutoMode = m_smProductionInfo.g_DTStartAutoMode_IndividualForm = DateTime.Now;
            m_smVisionInfo.g_blnViewROI = true;
            lbl_StepNo.BringToFront();

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadPackageDontCareROIs.Count == i)
                {
                    m_smVisionInfo.g_arrPadPackageDontCareROIs.Add(new List<List<ROI>>());
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                }
                else
                {
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 0)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Count == 1)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i].Add(new List<ROI>());
                }

                if (m_smVisionInfo.g_arrPolygon_PadPackage.Count == i)
                {
                    m_smVisionInfo.g_arrPolygon_PadPackage.Add(new List<List<Polygon>>());
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[i].Count == 0)
                        m_smVisionInfo.g_arrPolygon_PadPackage[i].Add(new List<Polygon>());
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[i].Count == 1)
                        m_smVisionInfo.g_arrPolygon_PadPackage[i].Add(new List<Polygon>());
                }
                else
                {
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[i].Count == 0)
                        m_smVisionInfo.g_arrPolygon_PadPackage[i].Add(new List<Polygon>());
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[i].Count == 1)
                        m_smVisionInfo.g_arrPolygon_PadPackage[i].Add(new List<Polygon>());
                }
            }

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count > m_smVisionInfo.g_intSelectedType)
            {
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                {
                    cbo_DontCareAreaDrawMethod.SelectedIndex = m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_intSelectedDontCareROIIndex].ref_intFormMode;
                }
                else
                    cbo_DontCareAreaDrawMethod.SelectedIndex = 0;
            }
            else
                cbo_DontCareAreaDrawMethod.SelectedIndex = 0;

            if (cbo_DontCareAreaDrawMethod.SelectedIndex == 2)
            {
                pnl_DontCareFreeShape.Visible = true;
            }
            else
            {
                pnl_DontCareFreeShape.Visible = false;
            }

            m_intSelectedDontCareROIIndexPrev = m_smVisionInfo.g_intSelectedDontCareROIIndex;


            m_smVisionInfo.g_intLearnStepNo = 0;
            SetupSteps(true);

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
            m_smVisionInfo.VM_AT_SettingInDialog = true;
            m_smVisionInfo.g_blncboImageView = false;
        }

        private void LearnPackageForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            
            STDeviceEdit.SaveDeviceEditLog(m_smVisionInfo.g_strVisionFolderName + ">Learn Pad Package Form Closed", "Exit Learn Pad Package Form", "", "", m_smProductionInfo.g_strLotID);
            
            m_smVisionInfo.g_intSelectedDontCareROIIndex = 0;
            m_smVisionInfo.g_intLearnStepNo = 0;
            m_smVisionInfo.g_blncboImageView = true;
            m_smVisionInfo.g_blnViewROI = false;
            m_smVisionInfo.g_blnDragROI = false;
            m_smVisionInfo.g_blnViewPackageImage = false;
            m_smVisionInfo.g_blnViewPackageMaskROI = false;
            m_smVisionInfo.g_blnViewPkgProcessImage = false;
            m_smVisionInfo.g_blnViewPackageTrainROI = false;
            m_smVisionInfo.g_blnViewPackageObjectBuilded = false;
            m_smVisionInfo.g_blnPackageInspected = false;
            m_smVisionInfo.g_blnViewRotatedPackageImage = false;
            m_smVisionInfo.g_blnViewRotatedImage = false;
            m_smVisionInfo.g_blnViewColorImage = ((m_smCustomizeInfo.g_intUseColorCamera & (1 << m_smVisionInfo.g_intVisionPos)) > 0);
            m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = false;
            m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;
            m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = false;
            m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
            m_smVisionInfo.VM_AT_SettingInDialog = false;


        }

        private void cbo_ImagesList_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            m_smVisionInfo.g_intSelectedImage = cbo_ImagesList.SelectedIndex + 1;


            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void timer1_Tick(object sender, EventArgs e)
        {
            if (m_smProductionInfo.AT_ALL_InAuto && m_smProductionInfo.g_intAutoLogOutMinutes > 0 && m_intUserGroup != 5)
            {
                DateTime t = DateTime.Now;
                TimeSpan tSpan = t - m_smProductionInfo.g_DTStartAutoMode_IndividualForm;

                if (tSpan.Minutes >= m_smProductionInfo.g_intAutoLogOutMinutes)
                {
                    m_smProductionInfo.g_intUserGroup = 5;
                    m_smProductionInfo.g_DTStartAutoMode_IndividualForm = DateTime.Now;
                    DisableField2();
                }
            }

            if(m_smVisionInfo.g_blnWantDontCareArea_Package)
            {
                txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count.ToString();
                txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count.ToString();
            }

            if (m_intSelectedDontCareROIIndexPrev != m_smVisionInfo.g_intSelectedDontCareROIIndex)
            {
                m_intSelectedDontCareROIIndexPrev = m_smVisionInfo.g_intSelectedDontCareROIIndex;
                if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count > m_smVisionInfo.g_intSelectedType)
                {
                    if (m_smVisionInfo.g_arrPolygon_PadPackage.Count > m_smVisionInfo.g_intSelectedUnit &&
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedUnit].Count > m_smVisionInfo.g_intSelectedType &&
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedUnit][m_smVisionInfo.g_intSelectedType].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                    {
                        if ((m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex) && (m_smVisionInfo.g_intSelectedDontCareROIIndex != -1))
                            cbo_DontCareAreaDrawMethod.SelectedIndex = m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_intSelectedDontCareROIIndex].ref_intFormMode;
                    }
                }
                else
                    cbo_DontCareAreaDrawMethod.SelectedIndex = 0;

                if (cbo_DontCareAreaDrawMethod.SelectedIndex == 2)
                {
                    pnl_DontCareFreeShape.Visible = true;
                }
                else
                {
                    pnl_DontCareFreeShape.Visible = false;
                }
            }

            if (m_intSelectedROIPrev != m_smVisionInfo.g_intSelectedROI)
            {
                m_intSelectedROIPrev = m_smVisionInfo.g_intSelectedROI;
                cbo_SelectROI.SelectedIndex = m_smVisionInfo.g_intSelectedROI;
                cbo_selectROI2.SelectedIndex = m_smVisionInfo.g_intSelectedROI;

                if (m_smVisionInfo.g_intLearnStepNo == 3 || m_smVisionInfo.g_intLearnStepNo == 6)
                {
                    m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPadPkgMoldFlashImageViewNo, m_smVisionInfo.g_intVisionIndex);
                    UpdateMoldFlashForeColor();
                }

                // 2019 02 15 - CCENG: Display all width, height and thickness. Easier for user setting.
                //if (m_smVisionInfo.g_intSelectedROI != 0)
                //{
                //    pnl_widthHeight.Visible = false;
                //    pnl_Thickness.Visible = true;
                //}
                //else
                //{
                //    pnl_widthHeight.Visible = true;
                //    pnl_Thickness.Visible = false;
                //}
            }

            if (m_smVisionInfo.g_blnViewGauge)
            {
                float fWidth = (m_smVisionInfo.g_arrPad[0].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultDownWidth_RectGauge4L(1)) / 2;

                // 2019-10-25 ZJYEOH : Add Offset to package width
                fWidth += m_smVisionInfo.g_arrPad[0].ref_fPackageWidthOffsetMM;

                string strResult = fWidth.ToString("F4");
                if (strResult != lbl_SizeWidthResult.Text)
                {
                    lbl_SizeWidthResult.Text = strResult;
                }

                float fHeight = (m_smVisionInfo.g_arrPad[0].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultRightHeight_RectGauge4L(1)) / 2;

                // 2019-10-25 ZJYEOH : Add Offset to package height
                fHeight += m_smVisionInfo.g_arrPad[0].ref_fPackageHeightOffsetMM;

                strResult = fHeight.ToString("F4");
                if (strResult != lbl_SizeHeightResult.Text)
                {
                    lbl_SizeHeightResult.Text = strResult;
                }

                // 2019 02 15 - CCENG: Do not need to display each side ROI thickness. Direct display average of 4 thickness
                //if (m_smVisionInfo.g_intSelectedROI == 1 || m_smVisionInfo.g_intSelectedROI == 3)
                //{
                //    strResult = ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetResultRightHeight_RectGauge4L(1)) / 2).ToString("F4");
                //    if (strResult != lbl_SizeThicknessResult.Text)
                //    {
                //        lbl_SizeThicknessResult.Text = strResult;
                //    }
                //}
                //else if (m_smVisionInfo.g_intSelectedROI == 2 || m_smVisionInfo.g_intSelectedROI == 4)
                //{
                //    strResult = ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetResultDownWidth_RectGauge4L(1)) / 2).ToString("F4");
                //    if (strResult != lbl_SizeThicknessResult.Text)
                //    {
                //        lbl_SizeThicknessResult.Text = strResult;
                //    }
                //}
                float fThickness = 0;
                float fTotalThickness = 0;
                for (int i = 1; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (i == 1 || i == 3)
                        fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2;
                    else if (i == 2 || i == 4)
                        fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2;
                }
                fThickness = fTotalThickness / 4;

                // 2019-10-25 ZJYEOH : Add Offset to package thickness
                if (m_smVisionInfo.g_arrPad.Length > 1)
                    fThickness += m_smVisionInfo.g_arrPad[1].ref_fPackageThicknessOffsetMM;

                strResult = fThickness.ToString("F4");
                if (strResult != lbl_SizeThicknessResult.Text)
                {
                    lbl_SizeThicknessResult.Text = strResult;
                }

                strResult = m_smVisionInfo.g_arrPad[0].GetResultAngle_RectGauge4L().ToString("F4");
                if (strResult != lbl_AngleResult.Text)
                {
                    lbl_AngleResult.Text = strResult;
                }

                bool blnResult = false;
                if (m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                {
                    // 2020 02 23 - CCENG: check 4 sides ROI only if ref_blnMeasureCenterPkgSizeUsingSidePkg is true
                    blnResult = m_smVisionInfo.g_arrPad[1].GetRectGauge4LPassFail(1) &&
                                m_smVisionInfo.g_arrPad[2].GetRectGauge4LPassFail(2) &&
                                m_smVisionInfo.g_arrPad[3].GetRectGauge4LPassFail(3) &&
                                m_smVisionInfo.g_arrPad[4].GetRectGauge4LPassFail(4);
                }
                else if (m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_blnCheck4Sides)
                {
                    // 2020 02 23 - CCENG: check 5 sides ROI if ref_blnMeasureCenterPkgSizeUsingSidePkg is false
                    blnResult = m_smVisionInfo.g_arrPad[0].GetRectGauge4LPassFail(0) &&
                                m_smVisionInfo.g_arrPad[1].GetRectGauge4LPassFail(1) &&
                                m_smVisionInfo.g_arrPad[2].GetRectGauge4LPassFail(2) &&
                                m_smVisionInfo.g_arrPad[3].GetRectGauge4LPassFail(3) &&
                                m_smVisionInfo.g_arrPad[4].GetRectGauge4LPassFail(4);
                }
                else
                {
                    // 2020 02 23 - check selected ROI if not 5S or no check side roi.
                    blnResult = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetRectGauge4LPassFail(m_smVisionInfo.g_intSelectedROI);
                }

                if (!blnResult)
                {
                    lbl_ScoreResult.Text = "Fail";
                    lbl_ScoreResult.ForeColor = Color.Red;
                }
                else
                {
                    lbl_ScoreResult.Text = "Pass";
                    lbl_ScoreResult.ForeColor = Color.Green;
                }
            }

            if (m_smVisionInfo.g_blnUpdateSelectedROI)
            {
                m_smVisionInfo.g_blnUpdateSelectedROI = false;
                UpdateGUI();
                if (m_smVisionInfo.g_intLearnStepNo == 0)
                {
                    switch (m_smVisionInfo.g_intSelectedROI)
                    {
                        case 0:
                            picUnitROI.Image = ils_ImageListTree.Images[13];
                            break;
                        case 1:
                            picUnitROI.Image = ils_ImageListTree.Images[14];
                            break;
                        case 2:
                            picUnitROI.Image = ils_ImageListTree.Images[15];
                            break;
                        case 3:
                            picUnitROI.Image = ils_ImageListTree.Images[16];
                            break;
                        case 4:
                            picUnitROI.Image = ils_ImageListTree.Images[17];
                            break;
                    }
                    CheckPkgROISetting();

                    int[] arrPackageSizeImageIndex = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].GetEdgeImageViewNo(), m_smVisionInfo.g_intVisionIndex);
                    for (int j = 0; j < 4; j++)
                    {
                        if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_objRectGauge4L.ref_arrEdgeROI[j].GetROIHandle())
                        {
                            m_smVisionInfo.g_intSelectedImage = arrPackageSizeImageIndex[j];
                        }
                    }
                }

                if (m_smVisionInfo.g_intLearnStepNo == 1)
                {
                    switch (m_smVisionInfo.g_intSelectedROI)
                    {
                        case 0:
                            picPkgROI.Image = ils_ImageListTree.Images[18];
                            break;
                        case 1:
                            picPkgROI.Image = ils_ImageListTree.Images[19];
                            break;
                        case 2:
                            picPkgROI.Image = ils_ImageListTree.Images[20];
                            break;
                        case 3:
                            picPkgROI.Image = ils_ImageListTree.Images[21];
                            break;
                        case 4:
                            picPkgROI.Image = ils_ImageListTree.Images[22];
                            break;
                    }
                }
                if (m_smVisionInfo.g_intLearnStepNo == 2)
                {

                    switch (m_smVisionInfo.g_intSelectedROI)
                    {
                        case 0:
                            picPkgROI_Chip.Image = ils_ImageListTree.Images[23];
                            break;
                        case 1:
                            picPkgROI_Chip.Image = ils_ImageListTree.Images[24];
                            break;
                        case 2:
                            picPkgROI_Chip.Image = ils_ImageListTree.Images[25];
                            break;
                        case 3:
                            picPkgROI_Chip.Image = ils_ImageListTree.Images[26];
                            break;
                        case 4:
                            picPkgROI_Chip.Image = ils_ImageListTree.Images[27];
                            break;
                    }
                    CheckChippedOffOutwardROISetting();
                    CheckChippedOffInwardROISetting();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 3)
                {
                    switch (m_smVisionInfo.g_intSelectedROI)
                    {
                        case 0:
                            picPkgROI_Mold.Image = ils_ImageListTree.Images[28];
                            break;
                        case 1:
                            picPkgROI_Mold.Image = ils_ImageListTree.Images[29];
                            break;
                        case 2:
                            picPkgROI_Mold.Image = ils_ImageListTree.Images[30];
                            break;
                        case 3:
                            picPkgROI_Mold.Image = ils_ImageListTree.Images[31];
                            break;
                        case 4:
                            picPkgROI_Mold.Image = ils_ImageListTree.Images[32];
                            break;
                    }
                }
                if (m_smVisionInfo.g_intLearnStepNo == 11)
                {
                    switch (m_smVisionInfo.g_intSelectedROI)
                    {
                        case 0:
                            picPkgROI_ForeignMaterial.Image = ils_ImageListTree.Images[18];
                            break;
                        case 1:
                            picPkgROI_ForeignMaterial.Image = ils_ImageListTree.Images[19];
                            break;
                        case 2:
                            picPkgROI_ForeignMaterial.Image = ils_ImageListTree.Images[20];
                            break;
                        case 3:
                            picPkgROI_ForeignMaterial.Image = ils_ImageListTree.Images[21];
                            break;
                        case 4:
                            picPkgROI_ForeignMaterial.Image = ils_ImageListTree.Images[22];
                            break;
                    }

                    CheckMoldFlashOuterROISetting();
                    CheckMoldFlashInnerROISetting();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 4)
                {
                    label5.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage1LowSurfaceThreshold.ToString();
                    label4.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage1HighSurfaceThreshold.ToString();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 5)
                {
                    label3.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2LowThreshold.ToString();
                    label2.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2HighThreshold.ToString();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 6)
                {
                    label1.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage1MoldFlashThreshold.ToString();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 7)
                {
                    lbl_VoidViewThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2VoidThreshold.ToString();
                }
                if (m_smVisionInfo.g_intLearnStepNo == 8)
                {
                    lbl_LowCrackViewThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2LowCrackThreshold.ToString();
                    lbl_HighCrackViewThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2HighCrackThreshold.ToString();
                }

                if (m_smVisionInfo.g_intLearnStepNo == 12)
                {
                    lbl_ForeignMaterialThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intForeignMaterialBrightFieldThreshold.ToString();
                }


            }

            switch (m_smVisionInfo.g_intSelectedROI)
            {
                case 0:
                case 1:
                    pnl_PkgTop.Location = m_pPkgTop;
                    pnl_PkgRight.Location = m_pPkgRight;
                    pnl_PkgBottom.Location = m_pPkgBottom;
                    pnl_PkgLeft.Location = m_pPkgLeft;

                    grpbox_ChippedTop.Location = m_pChippedTop;
                    grpbox_ChippedRight.Location = m_pChippedRight;
                    grpbox_ChippedBottom.Location = m_pChippedBottom;
                    grpbox_ChippedLeft.Location = m_pChippedLeft;

                    grp_MoldTop.Location = m_pMoldTop;
                    grp_MoldRight.Location = m_pMoldRight;
                    grp_MoldBottom.Location = m_pMoldBottom;
                    grp_MoldLeft.Location = m_pMoldLeft;

                    pnl_ForeignMaterialTop.Location = m_pForeignMaterialTop;
                    pnl_ForeignMaterialRight.Location = m_pForeignMaterialRight;
                    pnl_ForeignMaterialBottom.Location = m_pForeignMaterialBottom;
                    pnl_ForeignMaterialLeft.Location = m_pForeignMaterialLeft;

                    break;
                case 2:
                    pnl_PkgTop.Location = m_pPkgRight;
                    pnl_PkgRight.Location = m_pPkgBottom;
                    pnl_PkgBottom.Location = m_pPkgLeft;
                    pnl_PkgLeft.Location = m_pPkgTop;

                    grpbox_ChippedTop.Location = m_pChippedRight;
                    grpbox_ChippedRight.Location = m_pChippedBottom;
                    grpbox_ChippedBottom.Location = m_pChippedLeft;
                    grpbox_ChippedLeft.Location = m_pChippedTop;

                    pnl_ForeignMaterialTop.Location = m_pForeignMaterialRight;
                    pnl_ForeignMaterialRight.Location = m_pForeignMaterialBottom;
                    pnl_ForeignMaterialBottom.Location = m_pForeignMaterialLeft;
                    pnl_ForeignMaterialLeft.Location = m_pForeignMaterialTop;

                    grp_MoldTop.Location = m_pMoldRight;
                    grp_MoldRight.Location = m_pMoldBottom;
                    grp_MoldBottom.Location = m_pMoldLeft;
                    grp_MoldLeft.Location = m_pMoldTop;
                    break;
                case 3:
                    pnl_PkgTop.Location = m_pPkgBottom;
                    pnl_PkgRight.Location = m_pPkgLeft;
                    pnl_PkgBottom.Location = m_pPkgTop;
                    pnl_PkgLeft.Location = m_pPkgRight;

                    grpbox_ChippedTop.Location = m_pChippedBottom;
                    grpbox_ChippedRight.Location = m_pChippedLeft;
                    grpbox_ChippedBottom.Location = m_pChippedTop;
                    grpbox_ChippedLeft.Location = m_pChippedRight;

                    pnl_ForeignMaterialTop.Location = m_pForeignMaterialBottom;
                    pnl_ForeignMaterialRight.Location = m_pForeignMaterialLeft;
                    pnl_ForeignMaterialBottom.Location = m_pForeignMaterialTop;
                    pnl_ForeignMaterialLeft.Location = m_pForeignMaterialRight;

                    grp_MoldTop.Location = m_pMoldBottom;
                    grp_MoldRight.Location = m_pMoldLeft;
                    grp_MoldBottom.Location = m_pMoldTop;
                    grp_MoldLeft.Location = m_pMoldRight;
                    break;
                case 4:
                    pnl_PkgTop.Location = m_pPkgLeft;
                    pnl_PkgRight.Location = m_pPkgTop;
                    pnl_PkgBottom.Location = m_pPkgRight;
                    pnl_PkgLeft.Location = m_pPkgBottom;

                    grpbox_ChippedTop.Location = m_pChippedLeft;
                    grpbox_ChippedRight.Location = m_pChippedTop;
                    grpbox_ChippedBottom.Location = m_pChippedRight;
                    grpbox_ChippedLeft.Location = m_pChippedBottom;

                    pnl_ForeignMaterialTop.Location = m_pForeignMaterialLeft;
                    pnl_ForeignMaterialRight.Location = m_pForeignMaterialTop;
                    pnl_ForeignMaterialBottom.Location = m_pForeignMaterialRight;
                    pnl_ForeignMaterialLeft.Location = m_pForeignMaterialBottom;

                    grp_MoldTop.Location = m_pMoldLeft;
                    grp_MoldRight.Location = m_pMoldTop;
                    grp_MoldBottom.Location = m_pMoldRight;
                    grp_MoldLeft.Location = m_pMoldBottom;
                    break;
            }

            if (m_objAdvancedRectGauge4LForm != null)
            {
                if (!m_objAdvancedRectGauge4LForm.ref_blnShowForm)
                {
                    m_smVisionInfo.g_blnReferTemplateSize = true;
                    //m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[0].ref_intPadPkgSizeImageViewNo, m_smVisionInfo.g_intVisionIndex);

                    DefineMostSelectedImageNo(); // 2020-02-17 ZJYEOH : Display the image selected from gauge advance setting

                    m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].CopyTo(ref m_smVisionInfo.g_objPackageImage);

                    for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        m_smVisionInfo.g_arrPad[i].ref_blnDrawDraggingBox = chk_ShowDraggingBox.Checked;
                        m_smVisionInfo.g_arrPad[i].ref_blnDrawSamplingPoint = chk_ShowSamplePoints.Checked;
                        m_smVisionInfo.g_arrPad[i].ref_blnDrawTransitionTypeArrow = false;
                    }

                    m_smVisionInfo.ALL_VM_UpdatePictureBox = true;

                    m_objAdvancedRectGauge4LForm.Close();
                    m_objAdvancedRectGauge4LForm.Dispose();
                    m_objAdvancedRectGauge4LForm = null;

                    btn_Next.Enabled = btn_Save.Enabled = btn_GaugeSaveClose.Enabled = btn_Cancel.Enabled = btn_GaugeAdvanceSetting.Enabled = chk_ShowDraggingBox.Enabled = chk_ShowSamplePoints.Enabled = true;
                }
                else
                    m_smVisionInfo.g_blnReferTemplateSize = false;
            }
        }

        private void btn_GaugeAdvanceSetting_Click(object sender, EventArgs e)
        {
            int intPadSelectedIndex = m_smVisionInfo.g_intSelectedROI;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnDrawDraggingBox = true;
                m_smVisionInfo.g_arrPad[i].ref_blnDrawSamplingPoint = true;
                m_smVisionInfo.g_arrPad[i].ref_blnDrawTransitionTypeArrow = true;
            }

            string strRectGaugePath = m_smProductionInfo.g_strRecipePath +
                                m_strSelectedRecipe + "\\" + m_smVisionInfo.g_strVisionFolderName + "\\Pad\\RectGauge4L.xml";

            string strVisionFolderPath = m_smProductionInfo.g_strRecipePath + m_strSelectedRecipe + "\\" + m_smVisionInfo.g_strVisionFolderName;

            m_objAdvancedRectGauge4LForm = new AdvancedRectGauge4LPadForm(m_smVisionInfo, intPadSelectedIndex, strRectGaugePath, strVisionFolderPath, m_smProductionInfo, m_smCustomizeInfo, 2);

            m_objAdvancedRectGauge4LForm.StartPosition = FormStartPosition.Manual;
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            m_objAdvancedRectGauge4LForm.Location = new Point(resolution.Width - m_objAdvancedRectGauge4LForm.Size.Width, 0);   // 2020 03 09 - CCENG: display gauge form from top.
            m_objAdvancedRectGauge4LForm.Show();

            btn_Next.Enabled = btn_Save.Enabled = btn_GaugeSaveClose.Enabled = btn_Cancel.Enabled = btn_GaugeAdvanceSetting.Enabled = false;
        }

        private void cbo_MarkViewImageList_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            m_smVisionInfo.g_intSelectedImage = cbo_MarkViewImageList.SelectedIndex;

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void cbo_PkgViewImageList_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            m_smVisionInfo.g_intSelectedImage = cbo_PkgViewImageList.SelectedIndex;

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_UnitSize_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            for (int i = 0; i < m_smVisionInfo.g_arrPadROIs.Count; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_fUnitWidthMin = Convert.ToSingle(txt_UnitSizeMinWidth.Text);
                m_smVisionInfo.g_arrPad[i].ref_fUnitHeightMin = Convert.ToSingle(txt_UnitSizeMinHeight.Text);
                m_smVisionInfo.g_arrPad[i].ref_fUnitWidthMax = Convert.ToSingle(txt_UnitSizeMaxWidth.Text);
                m_smVisionInfo.g_arrPad[i].ref_fUnitHeightMax = Convert.ToSingle(txt_UnitSizeMaxHeight.Text);
                m_smVisionInfo.g_arrPad[i].ref_fUnitThicknessMin = Convert.ToSingle(txt_UnitSizeMinThickness.Text);
                m_smVisionInfo.g_arrPad[i].ref_fUnitThicknessMax = Convert.ToSingle(txt_UnitSizeMaxThickness.Text);
            }
        }

        private void chk_ShowDraggingBox_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnDrawDraggingBox = chk_ShowDraggingBox.Checked;
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_ShowSamplePoints_Click(object sender, EventArgs e)
        {
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                m_smVisionInfo.g_arrPad[i].ref_blnDrawSamplingPoint = chk_ShowSamplePoints.Checked;
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_CameraGain_ValueChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            float fImageGain = Convert.ToSingle(txt_ImageGain.Value);

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                    m_smVisionInfo.g_arrPad[i].ref_fImageGain = fImageGain;
            }

            switch (m_smVisionInfo.g_arrPad[0].ref_objRectGauge4L.GetGaugeImageMode(0))
            {
                default:
                case 0:
                    {
                        if (m_smVisionInfo.g_blnViewRotatedImage)
                        {
                            m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPackageImage, fImageGain);
                        }
                        else
                        {
                            m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPackageImage, fImageGain);
                        }
                    }
                    break;
                case 1:
                    {
                        if (m_smVisionInfo.g_blnViewRotatedImage)
                        {
                            m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPkgProcessImage, fImageGain);
                            m_smVisionInfo.g_objPkgProcessImage.AddPrewitt(ref m_smVisionInfo.g_objPackageImage);
                        }
                        else
                        {
                            m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage].AddGain(ref m_smVisionInfo.g_objPkgProcessImage, fImageGain);
                            m_smVisionInfo.g_objPkgProcessImage.AddPrewitt(ref m_smVisionInfo.g_objPackageImage);
                        }

                    }
                    break;
            }

            m_smVisionInfo.g_blnViewPackageImage = true;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_Image1SurfaceThreshold_Click(object sender, EventArgs e)
        {
            int intPadSelectedIndex = m_smVisionInfo.g_intSelectedROI;

            m_smVisionInfo.g_intSelectedImage = 0;

            int intLowThreshold = m_smVisionInfo.g_intLowThresholdValue = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1LowSurfaceThreshold;
            int intHighThreshold = m_smVisionInfo.g_intHighThresholdValue = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1HighSurfaceThreshold;

            ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[0]);
            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            DoubleThresholdForm objThresholdForm = new DoubleThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intPadSelectedIndex][1], false, blnWantSetToAllROICheckBox);
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(670, 200);
            if (objThresholdForm.ShowDialog() == DialogResult.Cancel)
            {
                m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1LowSurfaceThreshold = intLowThreshold;
                m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1HighSurfaceThreshold = intHighThreshold;
            }
            else
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intPadSelectedIndex, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage1LowSurfaceThreshold = m_smVisionInfo.g_intLowThresholdValue;
                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage1HighSurfaceThreshold = m_smVisionInfo.g_intHighThresholdValue;
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1LowSurfaceThreshold = m_smVisionInfo.g_intLowThresholdValue;
                    m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1HighSurfaceThreshold = m_smVisionInfo.g_intHighThresholdValue;
                }
                label5.Text = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1LowSurfaceThreshold.ToString();
                label4.Text = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage1HighSurfaceThreshold.ToString();
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_Image2Threshold_Click(object sender, EventArgs e)
        {
            int intPadSelectedIndex = m_smVisionInfo.g_intSelectedROI;

            //m_smVisionInfo.g_intSelectedImage = 2;    // 2019 02 13 - CCENG: Not need to set here. g_intSelectedImage will be set in SetupSteps() when user press Next button.

            int intLowThreshold = m_smVisionInfo.g_intLowThresholdValue = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2LowThreshold;
            int intHighThreshold = m_smVisionInfo.g_intHighThresholdValue = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2HighThreshold;

            ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            DoubleThresholdForm objThresholdForm = new DoubleThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intPadSelectedIndex][2], false, blnWantSetToAllROICheckBox); //[1]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(670, 200);
            if (objThresholdForm.ShowDialog() == DialogResult.Cancel)
            {
                m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2LowThreshold = intLowThreshold;
                m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2HighThreshold = intHighThreshold;
            }
            else
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intPadSelectedIndex, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage2LowThreshold = m_smVisionInfo.g_intLowThresholdValue;
                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage2HighThreshold = m_smVisionInfo.g_intHighThresholdValue;
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2LowThreshold = m_smVisionInfo.g_intLowThresholdValue;
                    m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2HighThreshold = m_smVisionInfo.g_intHighThresholdValue;
                }
                label3.Text = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2LowThreshold.ToString();
                label2.Text = m_smVisionInfo.g_arrPad[intPadSelectedIndex].ref_intPkgImage2HighThreshold.ToString();
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_MoldFlashThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            //m_smVisionInfo.g_intSelectedImage = 0;    // 2019 02 13 - CCENG: Not need to set here. g_intSelectedImage will be set in SetupSteps() when user press Next button.    
            m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1MoldFlashThreshold;

            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            List<int> arrrThreshold = new List<int>();
            if (m_smVisionInfo.g_arrPad.Length > 0)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[0].ref_intPkgImage1MoldFlashThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 1)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[1].ref_intPkgImage1MoldFlashThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 2)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[2].ref_intPkgImage1MoldFlashThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 3)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[3].ref_intPkgImage1MoldFlashThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 4)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[4].ref_intPkgImage1MoldFlashThreshold);

            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            ThresholdForm objThresholdForm = new ThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][0], true, blnWantSetToAllROICheckBox, arrrThreshold); //[0]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(769, 310);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage1MoldFlashThreshold = m_smVisionInfo.g_intThresholdValue;
                        if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage1LowSurfaceThreshold = m_smVisionInfo.g_intThresholdValue;
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage1HighSurfaceThreshold = 255;
                        }
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1MoldFlashThreshold = m_smVisionInfo.g_intThresholdValue;
                    if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                    {
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1LowSurfaceThreshold = m_smVisionInfo.g_intThresholdValue;
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1HighSurfaceThreshold = 255;
                    }
                }
                label1.Text = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1MoldFlashThreshold.ToString();
            }
            else
            {
                m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage1MoldFlashThreshold;
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_SetToAll_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllEdges_PadPackage", chk_SetToAll.Checked);

            CheckPkgROISetting();
        }

        private void chk_SetToAll_Chipped_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllEdges_PadPackage_Chipped", chk_SetToAll_Chipped.Checked);

            CheckChippedOffOutwardROISetting();
            CheckChippedOffInwardROISetting();
        }

        private void chk_SetToAll_Mold_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllEdges_PadPackage_Mold", chk_SetToAll_Mold.Checked);

            CheckMoldFlashOuterROISetting();
            CheckMoldFlashInnerROISetting();

        }

        private void btn_VoidViewThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            //m_smVisionInfo.g_intSelectedImage = 0;    // 2019 02 13 - CCENG: Not need to set here. g_intSelectedImage will be set in SetupSteps() when user press Next button.    
            m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2VoidThreshold;

            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            List<int> arrrThreshold = new List<int>();
            if (m_smVisionInfo.g_arrPad.Length > 0)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[0].ref_intPkgImage2VoidThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 1)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[1].ref_intPkgImage2VoidThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 2)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[2].ref_intPkgImage2VoidThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 3)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[3].ref_intPkgImage2VoidThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 4)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[4].ref_intPkgImage2VoidThreshold);

            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            ThresholdForm objThresholdForm = new ThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][0], true, blnWantSetToAllROICheckBox, arrrThreshold); //[0]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(769, 310);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage2VoidThreshold = m_smVisionInfo.g_intThresholdValue;
                        if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage2LowThreshold = m_smVisionInfo.g_intThresholdValue;
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage2HighThreshold = 255;
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage2LowCrackThreshold = m_smVisionInfo.g_intThresholdValue;
                            m_smVisionInfo.g_arrPad[i].ref_intPkgImage2HighCrackThreshold = 255;
                        }
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2VoidThreshold = m_smVisionInfo.g_intThresholdValue;
                    if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                    {
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2LowThreshold = m_smVisionInfo.g_intThresholdValue;
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2HighThreshold = 255;
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2LowCrackThreshold = m_smVisionInfo.g_intThresholdValue;
                        m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2HighCrackThreshold = 255;
                    }
                }
                lbl_VoidViewThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intPkgImage2VoidThreshold.ToString();
            }
            else
            {

                m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2VoidThreshold;
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_CrackViewThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }


            m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            m_smVisionInfo.g_intLowThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2LowCrackThreshold;
            m_smVisionInfo.g_intHighThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2HighCrackThreshold;

            ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            DoubleThresholdForm objThresholdForm = new DoubleThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][2], false, blnWantSetToAllROICheckBox);
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(670, 200);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage2LowCrackThreshold = m_smVisionInfo.g_intLowThresholdValue;
                        m_smVisionInfo.g_arrPad[i].ref_intPkgImage2HighCrackThreshold = m_smVisionInfo.g_intHighThresholdValue;

                        lbl_LowCrackViewThreshold.Text = m_smVisionInfo.g_intLowThresholdValue.ToString();
                        lbl_HighCrackViewThreshold.Text = m_smVisionInfo.g_intHighThresholdValue.ToString();
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2LowCrackThreshold = m_smVisionInfo.g_intLowThresholdValue;
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2HighCrackThreshold = m_smVisionInfo.g_intHighThresholdValue;

                    lbl_LowCrackViewThreshold.Text = m_smVisionInfo.g_intLowThresholdValue.ToString();
                    lbl_HighCrackViewThreshold.Text = m_smVisionInfo.g_intHighThresholdValue.ToString();
                }
            }
            else
            {
                m_smVisionInfo.g_intLowThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2LowCrackThreshold;
                m_smVisionInfo.g_intHighThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPkgImage2HighCrackThreshold;

            }


            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromEdge_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromEdge_Chipped.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromEdge_Chipped.Text == "" || fStartPixelFromEdge < 0)
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge_Chipped.Text = m_fStartPixelFromEdgePrev_Chipped.ToString();
                    else
                        txt_StartPixelFromEdge_Chipped.Text = m_fStartPixelFromEdgePrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromEdge_Chipped.Text = m_fStartPixelFromEdgePrev_Chipped.ToString();
                    else
                        txt_StartPixelFromEdge_Chipped.Text = m_fStartPixelFromEdgePrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelFromRight_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Chipped.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                    }
                }
            }

            CheckChippedOffInwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromRight_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromRight_Chipped.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromRight_Chipped.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight_Chipped.Text = m_fStartPixelFromRightPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromRight_Chipped.Text = m_fStartPixelFromRightPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromRight_Chipped.Text = m_fStartPixelFromRightPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromRight_Chipped.Text = m_fStartPixelFromRightPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelFromEdge_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Chipped.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }
                            
                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                    }
                }
            }

            CheckChippedOffInwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromBottom_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromBottom_Chipped.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromBottom_Chipped.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom_Chipped.Text = m_fStartPixelFromBottomPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromBottom_Chipped.Text = m_fStartPixelFromBottomPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromBottom_Chipped.Text = m_fStartPixelFromBottomPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromBottom_Chipped.Text = m_fStartPixelFromBottomPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelFromEdge_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Chipped.Text = fStartPixelFromEdge.ToString();
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                    }
                }
            }

            CheckChippedOffInwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromLeft_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromLeft_Chipped.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromLeft_Chipped.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromLeft_Chipped.Text = m_fStartPixelFromLeftPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromLeft_Chipped.Text = m_fStartPixelFromLeftPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelFromLeft_Chipped.Text = m_fStartPixelFromLeftPrev_Chipped.ToString();
                    else
                        txt_StartPixelFromLeft_Chipped.Text = m_fStartPixelFromLeftPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelFromEdge_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_Chipped.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Chipped.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom_Dark = fStartPixelFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight_Dark = fStartPixelFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft_Dark = fStartPixelFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromBottom = fStartPixelFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromEdge = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromRight = fStartPixelFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelFromLeft = fStartPixelFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelFromLeftPrev_Chipped_Dark = fStartPixelFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelFromEdgePrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromRightPrev_Chipped_Dark = fStartPixelFromEdge;
                    m_fStartPixelFromBottomPrev_Chipped_Dark = fStartPixelFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelFromLeftPrev_Chipped = fStartPixelFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelFromEdgePrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromRightPrev_Chipped = fStartPixelFromEdge;
                        m_fStartPixelFromBottomPrev_Chipped = fStartPixelFromEdge;
                    }
                }
            }

            CheckChippedOffInwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromEdge_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromEdge_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromEdge_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;
                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY)
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromRight_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromEdgePrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromRightPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashOuterROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromRight_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromRight_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromRight_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 2) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 3) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 4) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 2) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 3) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 4) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }

                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdge_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }
            m_fStartPixelFromRightPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgePrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashOuterROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromBottom_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromBottom_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromBottom_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdge_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromBottomPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgePrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromRightPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashOuterROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromLeft_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromLeft_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromLeft_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                        txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX)
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdge_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }
            m_fStartPixelFromLeftPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgePrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromRightPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashOuterROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_CrackViewMinArea_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (txt_CrackViewMinArea.Text == "")
                return;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }


            m_smVisionInfo.g_arrPad[intSelectedROI].ref_fCrackMinArea = Convert.ToInt32(txt_CrackViewMinArea.Text);


            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_VoidViewMinArea_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (txt_VoidViewMinArea.Text == "")
                return;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }


            m_smVisionInfo.g_arrPad[intSelectedROI].ref_fVoidMinArea = Convert.ToInt32(txt_VoidViewMinArea.Text);
            if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
            {
                m_smVisionInfo.g_arrPad[intSelectedROI].ref_fImage2SurfaceMinArea = Convert.ToSingle(txt_VoidViewMinArea.Text);
                m_smVisionInfo.g_arrPad[intSelectedROI].ref_fCrackMinArea = Convert.ToInt32(txt_VoidViewMinArea.Text);
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void srmInputBox2_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPad.Length == 1 || (m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                {
                    m_smVisionInfo.g_arrPad[i].ref_fMoldFlashMinArea = Convert.ToSingle(srmInputBox2.Text);
                    if (!m_smVisionInfo.g_blnWantUseDetailThreshold_PadPackage)
                    {
                        m_smVisionInfo.g_arrPad[i].ref_fSurfaceMinArea = Convert.ToSingle(srmInputBox2.Text);
                    }
                }
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void srmInputBox4_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPad.Length == 1 || (m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                    m_smVisionInfo.g_arrPad[i].ref_fImage2SurfaceMinArea = Convert.ToSingle(srmInputBox4.Text);
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void srmInputBox5_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPad.Length == 1 || (m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                    m_smVisionInfo.g_arrPad[i].ref_fSurfaceMinArea = Convert.ToSingle(srmInputBox5.Text);
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_GaugeSaveClose_Click(object sender, EventArgs e)
        {
            //Check is gauge ok or not
            if (chk_UseGauge.Checked)
            {
                bool blnGaugeOK = true;
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                        break;

                    if (i == 0 && m_smVisionInfo.g_arrPad.Length == 5 && m_smVisionInfo.g_arrPad[0].ref_blnMeasureCenterPkgSizeUsingSidePkg && m_smVisionInfo.g_blnCheck4Sides)
                        continue;

                    if (!m_smVisionInfo.g_arrPad[i].IsGaugeMeasureOK(i))
                    {
                        string strDirectionName;
                        switch (i)
                        {
                            case 0:
                            default:
                                strDirectionName = "Center";
                                break;
                            case 1:
                                strDirectionName = "Top";
                                break;
                            case 2:
                                strDirectionName = "Right";
                                break;
                            case 3:
                                strDirectionName = "Bottom";
                                break;
                            case 4:
                                strDirectionName = "Left";
                                break;

                        }
                        SRMMessageBox.Show("Gauge measurement in " + strDirectionName + " ROI is not good. Please adjust the ROI or gauge setting.");
                        blnGaugeOK = false;
                        break;

                    }
                }

                if (!blnGaugeOK)
                {
                    return;
                }
            }
            float fTotalThickness = 0;
            for (int i = 1; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == 1 || i == 3)
                    fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2;
                else if (i == 2 || i == 4)
                    fTotalThickness += (m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2;
            }

            //Save template width, height, thickness
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                m_smVisionInfo.g_arrPad[i].ref_fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[0].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                m_smVisionInfo.g_arrPad[i].ref_fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[0].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[0].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                if (m_smVisionInfo.g_blnCheck4Sides)
                    m_smVisionInfo.g_arrPad[i].ref_fUnitThickness = (float)Math.Round(fTotalThickness / 4, 4, MidpointRounding.AwayFromZero);
            }

            SavePadSetting(m_strFolderPath);

            //Load Package Image
            for (int intPadIndex = 0; intPadIndex < m_smVisionInfo.g_arrPad.Length; intPadIndex++)
            {
                if (intPadIndex > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;


                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadTemplateImage(m_strFolderPath + "Template\\", intPadIndex);
                m_smVisionInfo.g_arrPad[intPadIndex].LoadPadPackageTemplateImage(m_strFolderPathPkg + "Template\\", intPadIndex);
            }

            LoadROISetting(m_strFolderPath + "ROI.xml", m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrPad.Length);

            AttachImageToROI(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrImages[0]);

            DialogResult = DialogResult.OK;

            m_smVisionInfo.AT_PR_AttachImagetoROI = true;

            if (m_smCustomizeInfo.g_blnConfigShowNetwork && m_smCustomizeInfo.g_blnWantNetwork)
                m_smProductionInfo.g_blnSaveRecipeToServer = true;

            m_smVisionInfo.g_blnUpdateSECSGEMFile = true;

            this.Close();
            this.Dispose();
        }

        private void txt_BrightMinArea_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (txt_BrightMinArea.Text == "")
                return;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }


            m_smVisionInfo.g_arrPad[intSelectedROI].ref_intBrightFieldMinArea = Convert.ToInt32(txt_BrightMinArea.Text);


            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_DarkMinArea_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (txt_DarkMinArea.Text == "")
                return;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }


            m_smVisionInfo.g_arrPad[intSelectedROI].ref_intDarkFieldMinArea = Convert.ToInt32(txt_DarkMinArea.Text);


            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_BrightThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            //m_smVisionInfo.g_intSelectedImage = 0;    // 2019 02 13 - CCENG: Not need to set here. g_intSelectedImage will be set in SetupSteps() when user press Next button.    
            m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intBrightFieldLowThreshold;

            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            List<int> arrrThreshold = new List<int>();
            if (m_smVisionInfo.g_arrPad.Length > 0)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[0].ref_intBrightFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 1)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[1].ref_intBrightFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 2)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[2].ref_intBrightFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 3)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[3].ref_intBrightFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 4)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[4].ref_intBrightFieldLowThreshold);

            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            ThresholdForm objThresholdForm = new ThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][0], true, blnWantSetToAllROICheckBox, arrrThreshold); //[0]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(769, 310);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intBrightFieldLowThreshold = m_smVisionInfo.g_intThresholdValue;
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intBrightFieldLowThreshold = m_smVisionInfo.g_intThresholdValue;
                }
                lbl_BrightThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intBrightFieldLowThreshold.ToString();
            }
            else
            {

                m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intBrightFieldLowThreshold;
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_DarkThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            //m_smVisionInfo.g_intSelectedImage = 0;    // 2019 02 13 - CCENG: Not need to set here. g_intSelectedImage will be set in SetupSteps() when user press Next button.    
            m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intDarkFieldLowThreshold;
            m_smVisionInfo.g_fThresholdGainValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_fDarkFieldImageGain;


            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            m_smVisionInfo.g_intSelectedImage = m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[intSelectedROI].ref_intPadPkgDarkFieldImageViewNo, m_smVisionInfo.g_intVisionIndex);

            if (m_smVisionInfo.g_blnViewRotatedImage)
                m_smVisionInfo.g_arrPadROIs[intSelectedROI][0].AttachImage(m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);
            else
                m_smVisionInfo.g_arrPadROIs[intSelectedROI][0].AttachImage(m_smVisionInfo.g_arrImages[m_smVisionInfo.g_intSelectedImage]);

            List<int> arrrThreshold = new List<int>();
            if (m_smVisionInfo.g_arrPad.Length > 0)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[0].ref_intDarkFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 1)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[1].ref_intDarkFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 2)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[2].ref_intDarkFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 3)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[3].ref_intDarkFieldLowThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 4)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[4].ref_intDarkFieldLowThreshold);

            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            ThresholdWithGainForm objThresholdForm = new ThresholdWithGainForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][0], true, blnWantSetToAllROICheckBox, arrrThreshold); //[0]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(769, 310);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intDarkFieldLowThreshold = m_smVisionInfo.g_intThresholdValue;
                        m_smVisionInfo.g_arrPad[i].ref_fDarkFieldImageGain = m_smVisionInfo.g_fThresholdGainValue;
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intDarkFieldLowThreshold = m_smVisionInfo.g_intThresholdValue;
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_fDarkFieldImageGain = m_smVisionInfo.g_fThresholdGainValue;
                }
                lbl_DarkThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intDarkFieldLowThreshold.ToString();
            }
            else
            {

                m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intDarkFieldLowThreshold;
                m_smVisionInfo.g_fThresholdGainValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_fDarkFieldImageGain;
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_AddDontCareROI_Click(object sender, EventArgs e)
        {
            //if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count == 0)
            //{
            //    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Add(new List<ROI>());
            //}
            //if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count == 1)
            //{
            //    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Add(new List<ROI>());
            //}

            m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Add(new ROI());
            m_smVisionInfo.g_intSelectedDontCareROIIndex = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count - 1;
            m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count - 1].AttachImage(m_smVisionInfo.g_arrPadROIs[m_smVisionInfo.g_intSelectedROI][2]);


            //if (m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI].Count == 0)
            //    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI].Add(new List<Polygon>());
            //if (m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI].Count == 1)
            //    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI].Add(new List<Polygon>());

           
            m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Add(new Polygon());
            m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count - 1].ref_intFormMode = cbo_DontCareAreaDrawMethod.SelectedIndex;


            if (chk_BrightAndDarkSameDontCareArea.Checked)
            {

                if (m_smVisionInfo.g_intSelectedType == 0)
                {
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Add(new ROI());
                    m_smVisionInfo.g_intSelectedDontCareROIIndex = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count - 1;
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1][m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count - 1].AttachImage(m_smVisionInfo.g_arrPadROIs[m_smVisionInfo.g_intSelectedROI][2]);
                    
                    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][1].Add(new Polygon());
                    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][1][m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][1].Count - 1].ref_intFormMode = cbo_DontCareAreaDrawMethod.SelectedIndex;
                    
                }
                else
                {
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Add(new ROI());
                    m_smVisionInfo.g_intSelectedDontCareROIIndex = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count - 1;
                    m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0][m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count - 1].AttachImage(m_smVisionInfo.g_arrPadROIs[m_smVisionInfo.g_intSelectedROI][2]);
                    
                    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][0].Add(new Polygon());
                    m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][0][m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][0].Count - 1].ref_intFormMode = cbo_DontCareAreaDrawMethod.SelectedIndex;
                    
                }
            }
            if (!chk_BrightAndDarkSameDontCareArea.Checked)
            {
                if (radio_Bright.Checked)
                    txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
                else
                    txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
            }
            else
            {
                txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
                txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_DeleteDontCareROI_Click(object sender, EventArgs e)
        {
            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI].Count <= m_smVisionInfo.g_intSelectedType)
                return;

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count == 0)
                return;

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count <= m_smVisionInfo.g_intSelectedDontCareROIIndex)
            {
                m_smVisionInfo.g_intSelectedDontCareROIIndex = Math.Max(0, m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count - 1);
            }

            if (m_smVisionInfo.g_intSelectedDontCareROIIndex == -1)
                return;

            m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);
            m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);

            if (chk_BrightAndDarkSameDontCareArea.Checked)
            {
                if (m_smVisionInfo.g_intSelectedType == 0)
                {
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][1].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][1].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][1].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);

                }
                else
                {
                    if (m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][0].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][0].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);
                    if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                        m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][0].RemoveAt(m_smVisionInfo.g_intSelectedDontCareROIIndex);
                }

            }

            m_smVisionInfo.g_intSelectedDontCareROIIndex = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count - 1;
            if (m_intSelectedDontCareROIIndexPrev != m_smVisionInfo.g_intSelectedDontCareROIIndex)
            {
                m_intSelectedDontCareROIIndexPrev = m_smVisionInfo.g_intSelectedDontCareROIIndex;
                if ((m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex) && (m_smVisionInfo.g_intSelectedDontCareROIIndex != -1))
                {
                    if (m_smVisionInfo.g_arrPolygon_PadPackage.Count > m_smVisionInfo.g_intSelectedROI &&
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI].Count > m_smVisionInfo.g_intSelectedType &&
                        m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count > m_smVisionInfo.g_intSelectedDontCareROIIndex)
                    {
                        cbo_DontCareAreaDrawMethod.SelectedIndex = m_smVisionInfo.g_arrPolygon_PadPackage[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_intSelectedDontCareROIIndex].ref_intFormMode;
                    }
                }
                //else
                //    cbo_DontCareAreaDrawMethod.SelectedIndex = 0; // 2020 03 30 - CCENG: remain Dont Care Area Draw Method

                if (cbo_DontCareAreaDrawMethod.SelectedIndex == 2)
                {
                    pnl_DontCareFreeShape.Visible = true;
                }
                else
                {
                    pnl_DontCareFreeShape.Visible = false;
                }
            }
            if (!chk_BrightAndDarkSameDontCareArea.Checked)
            {
                if (radio_Bright.Checked)
                    txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
                else
                    txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
            }
            else
            {
                txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
                txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
            }

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void pic_Image3Picture_SelectedIndexChanged(object sender, EventArgs e)
        {

        }

        private void chk_SetToAllSideROI_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllSide_PadPackage", chk_SetToAllSideROI.Checked);

            CheckPkgROISetting();
        }

        private void chk_SetToAllSideROI_Chipped_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllSide_PadPackage_Chipped", chk_SetToAllSideROI_Chipped.Checked);

            CheckChippedOffOutwardROISetting();
            CheckChippedOffInwardROISetting();
        }

        private void txt_StartPixelFromEdgeInner_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromEdgeInner_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromEdgeInner_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;
                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY)
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromRightInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromEdgeInnerPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromRightInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftInnerPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashInnerROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_SetToAllSideROI_Mold_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllSide_PadPackage_Mold", chk_SetToAllSideROI_Mold.Checked);

            CheckMoldFlashOuterROISetting();
            CheckMoldFlashInnerROISetting();

        }

        private void txt_StartPixelFromRightInner_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromRightInner_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromRightInner_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 2) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 3) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 4) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 2) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 3) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if ((i == 4) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }

                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdgeInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }
            m_fStartPixelFromRightInnerPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgeInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftInnerPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashInnerROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromBottomInner_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromBottomInner_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromBottomInner_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdgeInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRightInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeftInner_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromBottomInnerPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgeInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromRightInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromLeftInnerPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashInnerROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromLeftInner_Mold_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromLeftInner_Mold.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromLeftInner_Mold.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);


                if (chk_SetToAll_Mold.Checked)
                {
                    //if ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)) ||
                    //    ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)) ||
                    //    (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromEdge_Mold.Text = m_fStartPixelFromEdgePrev_Mold.ToString();
                    //    txt_StartPixelFromRight_Mold.Text = m_fStartPixelFromRightPrev_Mold.ToString();
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    txt_StartPixelFromBottom_Mold.Text = m_fStartPixelFromBottomPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromEdgeInner_Mold.Text = m_fStartPixelFromEdgeInnerPrev_Mold.ToString();
                        txt_StartPixelFromRightInner_Mold.Text = m_fStartPixelFromRightInnerPrev_Mold.ToString();
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        txt_StartPixelFromBottomInner_Mold.Text = m_fStartPixelFromBottomInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                else
                {
                    //if (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX)
                    //{
                    //    SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    //    txt_StartPixelFromLeft_Mold.Text = m_fStartPixelFromLeftPrev_Mold.ToString();
                    //    m_blnUpdateSelectedROISetting = false;
                    //    return;
                    //}
                    if ((i == 0 || i == 1) && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 2 && (m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY - fStartPixelFromEdge <= m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 3 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIWidth) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalX + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIWidth)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                    else if (i == 4 && ((m_smVisionInfo.g_arrPadROIs[i][2].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][2].ref_ROIHeight) + fStartPixelFromEdge >= (m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalY + m_smVisionInfo.g_arrPadROIs[i][0].ref_ROIHeight)))
                    {
                        SRMMessageBox.Show("Edge tolerance cannot goes beyond Search ROI.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                        txt_StartPixelFromLeftInner_Mold.Text = m_fStartPixelFromLeftInnerPrev_Mold.ToString();
                        m_blnUpdateSelectedROISetting = false;
                        return;
                    }
                }
                if (chk_SetToAll_Mold.Checked)
                {
                    txt_StartPixelFromEdgeInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRightInner_Mold.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottomInner_Mold.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_Mold.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Mold.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_Mold.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fMoldStartPixelInnerFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }
            m_fStartPixelFromLeftInnerPrev_Mold = fStartPixelFromEdge;
            if (chk_SetToAll_Mold.Checked)
            {
                m_fStartPixelFromEdgeInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromRightInnerPrev_Mold = fStartPixelFromEdge;
                m_fStartPixelFromBottomInnerPrev_Mold = fStartPixelFromEdge;
            }
            UpdateMoldFlashForeColor();
            CheckMoldFlashInnerROISetting();

            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void cbo_DontCareAreaDrawMethod_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            //for (int i = 0; i < m_smVisionInfo.g_arrPadROIs.Count; i++)
            //{
            //    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
            //        break;

            //    for (int j = 0; j < 2; j++)
            //        m_smVisionInfo.g_arrPolygon_PadPackage[i][j].ref_intFormMode = cbo_DontCareAreaDrawMethod.SelectedIndex;
            //}
            if (cbo_DontCareAreaDrawMethod.SelectedIndex == 2)
            {
                pnl_DontCareFreeShape.Visible = true;
            }
            else
            {
                pnl_DontCareFreeShape.Visible = false;
            }
        }

        private void chk_SetToBrightDark_Chip_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToBrightDark_PadPackage_Chipped", chk_SetToBrightDark_Chip.Checked);

            CheckChippedOffOutwardROISetting();
            CheckChippedOffInwardROISetting();
        }

        private void cbo_ChippedOffDefectType_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (m_blnIgnoreComboboxIndexChange)
            {
                m_blnIgnoreComboboxIndexChange = false;
                return;
            }

            if (!IsChipInwardOutwardSettingCorrect(true))
            {
                m_blnIgnoreComboboxIndexChange = true;

                if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                    cbo_ChippedOffDefectType.SelectedIndex = 1;
                else
                    cbo_ChippedOffDefectType.SelectedIndex = 0;

                return;
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);
                ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                UpdateGUI();

                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = true;
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = false;
            }
            else
            {
                m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                UpdateGUI();

                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge = false;
                m_smVisionInfo.g_blnViewPadChipStartPixelFromEdge_Dark = true;
            }

            CheckChippedOffOutwardROISetting();
            CheckChippedOffInwardROISetting();
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelExtendFromEdge_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelExtendFromEdge = 0;
            if (!float.TryParse(txt_StartPixelExtendFromEdge_Chipped.Text, out fStartPixelExtendFromEdge))
                return;

            // 2021 07 27 - allow to set negative
            //if (!m_blnInitDone || txt_StartPixelExtendFromEdge_Chipped.Text == "" || fStartPixelExtendFromEdge < 0)
            if (!m_blnInitDone || txt_StartPixelExtendFromEdge_Chipped.Text == "")
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelExtendFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromEdge_Chipped.Text = m_fStartPixelExtendFromEdgePrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromEdge_Chipped.Text = m_fStartPixelExtendFromEdgePrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelExtendFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromEdge_Chipped.Text = m_fStartPixelExtendFromEdgePrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromEdge_Chipped.Text = m_fStartPixelExtendFromEdgePrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelExtendFromRight_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                    }
                }
            }

            CheckChippedOffOutwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelExtendFromRight_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelExtendFromEdge = 0;
            if (!float.TryParse(txt_StartPixelExtendFromRight_Chipped.Text, out fStartPixelExtendFromEdge))
                return;

            // 2021 07 27 - allow to set negative
            //if (!m_blnInitDone || txt_StartPixelExtendFromRight_Chipped.Text == "" || fStartPixelExtendFromEdge < 0)
            if (!m_blnInitDone || txt_StartPixelExtendFromRight_Chipped.Text == "")
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelExtendFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromRight_Chipped.Text = m_fStartPixelExtendFromRightPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromRight_Chipped.Text = m_fStartPixelExtendFromRightPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelExtendFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromRight_Chipped.Text = m_fStartPixelExtendFromRightPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromRight_Chipped.Text = m_fStartPixelExtendFromRightPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelExtendFromEdge_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                    }
                }
            }

            CheckChippedOffOutwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelExtendFromBottom_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelExtendFromEdge = 0;
            if (!float.TryParse(txt_StartPixelExtendFromBottom_Chipped.Text, out fStartPixelExtendFromEdge))
                return;

            // 2021 07 27 - allow to set negative
            //if (!m_blnInitDone || txt_StartPixelExtendFromBottom_Chipped.Text == "" || fStartPixelExtendFromEdge < 0)
            if (!m_blnInitDone || txt_StartPixelExtendFromBottom_Chipped.Text == "")
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelExtendFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromBottom_Chipped.Text = m_fStartPixelExtendFromBottomPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromBottom_Chipped.Text = m_fStartPixelExtendFromBottomPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelExtendFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromBottom_Chipped.Text = m_fStartPixelExtendFromBottomPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromBottom_Chipped.Text = m_fStartPixelExtendFromBottomPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelExtendFromEdge_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromRight_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromLeft_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                    }
                }
            }

            CheckChippedOffOutwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_ForeignMaterialMinArea_TextChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (txt_BrightMinArea.Text == "")
                return;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            m_smVisionInfo.g_arrPad[intSelectedROI].ref_intForeignMaterialBrightFieldMinArea = Convert.ToInt32(txt_ForeignMaterialMinArea.Text);
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void btn_ForeignMaterialThreshold_Click(object sender, EventArgs e)
        {
            // Clear Result drawing
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                m_smVisionInfo.g_arrPad[i].ref_blnViewPadResultDrawing = false;

            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][0].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }

            m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intForeignMaterialBrightFieldThreshold;

            if (m_smVisionInfo.g_arrPadROIs[intSelectedROI].Count == 0)
                return;

            List<int> arrrThreshold = new List<int>();
            if (m_smVisionInfo.g_arrPad.Length > 0)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[0].ref_intForeignMaterialBrightFieldThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 1)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[1].ref_intForeignMaterialBrightFieldThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 2)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[2].ref_intForeignMaterialBrightFieldThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 3)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[3].ref_intForeignMaterialBrightFieldThreshold);
            if (m_smVisionInfo.g_arrPad.Length > 4)
                arrrThreshold.Add(m_smVisionInfo.g_arrPad[4].ref_intForeignMaterialBrightFieldThreshold);

            bool blnWantSetToAllROICheckBox = (m_smVisionInfo.g_arrPadROIs.Count > 1) && m_smVisionInfo.g_blnCheck4Sides;
            ThresholdForm objThresholdForm = new ThresholdForm(m_smVisionInfo, m_smVisionInfo.g_arrPadROIs[intSelectedROI][0], true, blnWantSetToAllROICheckBox, arrrThreshold); //[0]
            Rectangle resolution = Screen.PrimaryScreen.Bounds;
            objThresholdForm.Location = new Point(resolution.Width - objThresholdForm.Size.Width, resolution.Height - objThresholdForm.Size.Height);
            //objThresholdForm.Location = new Point(769, 310);
            if (objThresholdForm.ShowDialog() == DialogResult.OK)
            {
                if (objThresholdForm.ref_blnSetToAllROI)
                {
                    // 2019 04 13-CCENG: Center ROI threshold setting allow set to other sides ROI. Side ROI threshold setting not allow set to center ROI.
                    for (int i = Math.Min(intSelectedROI, 1); i < m_smVisionInfo.g_arrPad.Length; i++)
                    {
                        if (!m_smVisionInfo.g_arrPad[i].ref_blnSelected)
                            continue;

                        m_smVisionInfo.g_arrPad[i].ref_intForeignMaterialBrightFieldThreshold = m_smVisionInfo.g_intThresholdValue;
                    }
                }
                else
                {
                    m_smVisionInfo.g_arrPad[intSelectedROI].ref_intForeignMaterialBrightFieldThreshold = m_smVisionInfo.g_intThresholdValue;
                }
                lbl_BrightThreshold.Text = m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_intForeignMaterialBrightFieldThreshold.ToString();
            }
            else
            {

                m_smVisionInfo.g_intThresholdValue = m_smVisionInfo.g_arrPad[intSelectedROI].ref_intForeignMaterialBrightFieldThreshold;
            }
            objThresholdForm.Dispose();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromEdge_ForeignMaterial_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromEdge_ForeignMaterial.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromEdge_ForeignMaterial.Text == "" || fStartPixelFromEdge < 0)
                return;

            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;

            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitHeight / 2) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromEdge_ForeignMaterial.Text = m_fStartPixelFromEdgePrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitWidth / 2) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromEdge_ForeignMaterial.Text = m_fStartPixelFromEdgePrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }

                if (chk_SetToAll_ForeignMaterial.Checked)
                {
                    txt_StartPixelFromRight_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                        }
                        break;
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_ForeignMaterial.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromEdgePrev_ForeignMaterial = fStartPixelFromEdge;
            if (chk_SetToAll_ForeignMaterial.Checked)
            {
                m_fStartPixelFromRightPrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_ForeignMaterial = fStartPixelFromEdge;
            }
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromLeft_ForeignMaterial_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromLeft_ForeignMaterial.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromLeft_ForeignMaterial.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitWidth / 2) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromLeft_ForeignMaterial.Text = m_fStartPixelFromLeftPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitHeight / 2) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromLeft_ForeignMaterial.Text = m_fStartPixelFromLeftPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_ForeignMaterial.Checked)
                {
                    txt_StartPixelFromEdge_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_ForeignMaterial.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromLeftPrev_ForeignMaterial = fStartPixelFromEdge;
            if (chk_SetToAll_ForeignMaterial.Checked)
            {
                m_fStartPixelFromEdgePrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromRightPrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_ForeignMaterial = fStartPixelFromEdge;
            }
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromRight_ForeignMaterial_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromRight_ForeignMaterial.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromRight_ForeignMaterial.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitWidth / 2) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromRight_ForeignMaterial.Text = m_fStartPixelFromRightPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitHeight / 2) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromRight_ForeignMaterial.Text = m_fStartPixelFromRightPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_ForeignMaterial.Checked)
                {
                    txt_StartPixelFromEdge_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromBottom_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_ForeignMaterial.Checked)
                {
                    switch (i)
                    {
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }

            m_fStartPixelFromRightPrev_ForeignMaterial = fStartPixelFromEdge;
            if (chk_SetToAll_ForeignMaterial.Checked)
            {
                m_fStartPixelFromEdgePrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromBottomPrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_ForeignMaterial = fStartPixelFromEdge;
            }
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void txt_StartPixelFromBottom_ForeignMaterial_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelFromEdge = 0;
            if (!float.TryParse(txt_StartPixelFromBottom_ForeignMaterial.Text, out fStartPixelFromEdge))
                return;

            if (!m_blnInitDone || txt_StartPixelFromBottom_ForeignMaterial.Text == "" || fStartPixelFromEdge < 0)
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelFromEdge >= (fUnitHeight / 2) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromBottom_ForeignMaterial.Text = m_fStartPixelFromBottomPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelFromEdge >= (fUnitWidth / 2) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto half of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    txt_StartPixelFromBottom_ForeignMaterial.Text = m_fStartPixelFromBottomPrev_ForeignMaterial.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_ForeignMaterial.Checked)
                {
                    txt_StartPixelFromEdge_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromRight_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                    txt_StartPixelFromLeft_ForeignMaterial.Text = fStartPixelFromEdge.ToString();
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 2: // Right
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                        }
                        break;
                    case 3: // Bottom
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                    case 4: // Left
                        m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                        if (chk_SetToAll_ForeignMaterial.Checked)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_ForeignMaterial.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 2: // Right
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                            }
                            break;
                        case 3: // Bottom
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                        case 4: // Left
                            m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromRight = fStartPixelFromEdge;
                            if (chk_SetToAll_ForeignMaterial.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromEdge = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromBottom = fStartPixelFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fForeignMaterialStartPixelFromLeft = fStartPixelFromEdge;
                            }
                            break;
                    }
                }
            }
            m_fStartPixelFromBottomPrev_ForeignMaterial = fStartPixelFromEdge;
            if (chk_SetToAll_ForeignMaterial.Checked)
            {
                m_fStartPixelFromEdgePrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromRightPrev_ForeignMaterial = fStartPixelFromEdge;
                m_fStartPixelFromLeftPrev_ForeignMaterial = fStartPixelFromEdge;
            }
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_SetToAllSideROI_ForeignMaterial_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllSide_PadPackage_ForeignMaterial", chk_SetToAllSideROI_ForeignMaterial.Checked);
        }

        private void radio_Bright_Click(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            m_smVisionInfo.g_intSelectedType = 0;
            m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count == 0)
                txt_DunCareROIBright.Text = 0.ToString();
            else
                txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void radio_Dark_Click(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            m_smVisionInfo.g_intSelectedType = 1;
            m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);

            if (m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count == 0)
                txt_DunCareROIDark.Text = 0.ToString();
            else
                txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();

            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_SetToAll_ForeignMaterial_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToAllEdges_PadPackage_ForeignMaterial", chk_SetToAll_ForeignMaterial.Checked);
        }

        private void cbo_SelectROI_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            if (!IsChipInwardOutwardSettingCorrect(true))
            {
                cbo_SelectROI.SelectedIndex = m_smVisionInfo.g_intSelectedROI;
                return;
            }

            m_smVisionInfo.g_intSelectedROI = cbo_SelectROI.SelectedIndex;
            m_smVisionInfo.g_intSelectedROIMask = 0x01 << m_smVisionInfo.g_intSelectedROI;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if ((m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].VerifyROIArea(m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterX, m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterY);
                        }
                    }
                }
                else
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].ClearDragHandle();
                        }
                    }
                }

            }

            m_smVisionInfo.g_blnUpdateSelectedROI = true;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;

        }

        private void cbo_SelectROI_SelectedIndexChanged_1(object sender, EventArgs e)
        {
            if (!IsChipInwardOutwardSettingCorrect(true))
            {
                cbo_SelectROI.SelectedIndex = m_smVisionInfo.g_intSelectedROI;
                return;
            }

            m_smVisionInfo.g_intSelectedROI = cbo_SelectROI.SelectedIndex;
            m_smVisionInfo.g_intSelectedROIMask = 0x01 << m_smVisionInfo.g_intSelectedROI;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if ((m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].VerifyROIArea(m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterX, m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterY);
                        }
                    }
                }
                else
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].ClearDragHandle();
                        }
                    }
                }

            }

            m_smVisionInfo.g_blnUpdateSelectedROI = true;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void srmImageComboBox1_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!IsChipInwardOutwardSettingCorrect(true))
            {
                cbo_selectROI2.SelectedIndex = m_smVisionInfo.g_intSelectedROI;
                return;
            }

            m_smVisionInfo.g_intSelectedROI = cbo_selectROI2.SelectedIndex;
            m_smVisionInfo.g_intSelectedROIMask = 0x01 << m_smVisionInfo.g_intSelectedROI;
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if ((m_smVisionInfo.g_intSelectedROIMask & (0x01 << i)) > 0)
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].VerifyROIArea(m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterX, m_smVisionInfo.g_arrPadROIs[i][0].ref_ROITotalCenterY);
                        }
                    }
                }
                else
                {
                    if (i < m_smVisionInfo.g_arrPadROIs.Count)
                    {
                        if (m_smVisionInfo.g_arrPadROIs[i].Count > 0)
                        {
                            m_smVisionInfo.g_arrPadROIs[i][0].ClearDragHandle();
                        }
                    }
                }

            }

            m_smVisionInfo.g_blnUpdateSelectedROI = true;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;

        }

        private void txt_StartPixelExtendFromLeft_Chipped_TextChanged(object sender, EventArgs e)
        {
            float fStartPixelExtendFromEdge = 0;
            if (!float.TryParse(txt_StartPixelExtendFromLeft_Chipped.Text, out fStartPixelExtendFromEdge))
                return;

            // 2021 07 27 - allow to set negative
            //if (!m_blnInitDone || txt_StartPixelExtendFromLeft_Chipped.Text == "" || fStartPixelExtendFromEdge < 0)
            if (!m_blnInitDone || txt_StartPixelExtendFromLeft_Chipped.Text == "")
                return;
            if (m_blnUpdateSelectedROISetting)
                return;

            m_blnUpdateSelectedROISetting = true;
            float fUnitWidth;
            float fUnitHeight;

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                fUnitWidth = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultUpWidth_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultDownWidth_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);
                fUnitHeight = (float)Math.Round((m_smVisionInfo.g_arrPad[i].GetResultLeftHeight_RectGauge4L(1) + m_smVisionInfo.g_arrPad[i].GetResultRightHeight_RectGauge4L(1)) / 2, 4, MidpointRounding.AwayFromZero);

                if ((i == 0 || i == 1 || i == 3) && fStartPixelExtendFromEdge >= (fUnitWidth / 4) * m_smVisionInfo.g_fCalibPixelX)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromLeft_Chipped.Text = m_fStartPixelExtendFromLeftPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromLeft_Chipped.Text = m_fStartPixelExtendFromLeftPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                else if ((i == 2 || i == 4) && fStartPixelExtendFromEdge >= (fUnitHeight / 4) * m_smVisionInfo.g_fCalibPixelY)
                {
                    SRMMessageBox.Show("Edge tolerance can only goto quarter of unit size.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        txt_StartPixelExtendFromLeft_Chipped.Text = m_fStartPixelExtendFromLeftPrev_Chipped.ToString();
                    else
                        txt_StartPixelExtendFromLeft_Chipped.Text = m_fStartPixelExtendFromLeftPrev_Chipped_Dark.ToString();
                    m_blnUpdateSelectedROISetting = false;
                    return;
                }
                if (chk_SetToAll_Chipped.Checked)
                {
                    txt_StartPixelExtendFromEdge_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromRight_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                    txt_StartPixelExtendFromBottom_Chipped.Text = fStartPixelExtendFromEdge.ToString();
                }
            }

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i != m_smVisionInfo.g_intSelectedROI)
                    continue;

                switch (i)
                {
                    case 0: // Center
                    case 1: // Top
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 2: // Right
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 3: // Bottom
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                    case 4: // Left
                        if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        else
                        {
                            m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                            if (chk_SetToAll_Chipped.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                            }

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }
                            }
                        }
                        break;
                }
            }
            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (i == m_smVisionInfo.g_intSelectedROI || i == 0)
                    continue;

                if (chk_SetToAllSideROI_Chipped.Checked)
                {
                    switch (i)
                    {
                        case 0: // Center
                        case 1: // Top
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 2: // Right
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 3: // Bottom
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                        case 4: // Left
                            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            else
                            {
                                m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom_Dark = fStartPixelExtendFromEdge;
                                if (chk_SetToAll_Chipped.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight_Dark = fStartPixelExtendFromEdge;
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft_Dark = fStartPixelExtendFromEdge;
                                }

                                if (chk_SetToBrightDark_Chip.Checked)
                                {
                                    m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromBottom = fStartPixelExtendFromEdge;
                                    if (chk_SetToAll_Chipped.Checked)
                                    {
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromEdge = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromRight = fStartPixelExtendFromEdge;
                                        m_smVisionInfo.g_arrPad[i].ref_fChipStartPixelExtendFromLeft = fStartPixelExtendFromEdge;
                                    }
                                }
                            }
                            break;
                    }
                }
            }

            if (cbo_ChippedOffDefectType.SelectedIndex == 0)
            {
                m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    }
                }
            }
            else
            {
                m_fStartPixelExtendFromLeftPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                if (chk_SetToAll_Chipped.Checked)
                {
                    m_fStartPixelExtendFromEdgePrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromRightPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                    m_fStartPixelExtendFromBottomPrev_Chipped_Dark = fStartPixelExtendFromEdge;
                }

                if (chk_SetToBrightDark_Chip.Checked)
                {
                    m_fStartPixelExtendFromLeftPrev_Chipped = fStartPixelExtendFromEdge;
                    if (chk_SetToAll_Chipped.Checked)
                    {
                        m_fStartPixelExtendFromEdgePrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromRightPrev_Chipped = fStartPixelExtendFromEdge;
                        m_fStartPixelExtendFromBottomPrev_Chipped = fStartPixelExtendFromEdge;
                    }
                }
            }

            CheckChippedOffOutwardROISetting();
            IsChipInwardOutwardSettingCorrect(false);
            m_blnUpdateSelectedROISetting = false;
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void cbo_PkgDefectType_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;


            if (cbo_PkgDefectType.SelectedIndex == 0)
            {
                m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(0, m_smVisionInfo.g_intVisionIndex);
                ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                UpdateGUI();

                m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = true;
                m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = false;
            }
            else
            {
                m_smVisionInfo.g_intSelectedImage = ImageDrawing.GetArrayImageIndex(1, m_smVisionInfo.g_intVisionIndex);
                ROI.AttachROIToImage(m_smVisionInfo.g_arrPadROIs, m_smVisionInfo.g_arrRotatedImages[m_smVisionInfo.g_intSelectedImage]);

                UpdateGUI();

                m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge = false;
                m_smVisionInfo.g_blnViewPadPkgStartPixelFromEdge_Dark = true;
            }

            CheckPkgROISetting();
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_SetToBrightDark_Click(object sender, EventArgs e)
        {
            RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            subkey.SetValue("SetToBrightDark_PadPackage", chk_SetToBrightDark.Checked);

            CheckPkgROISetting();
        }

        private void btn_Undo_Click(object sender, EventArgs e)
        {
            m_smVisionInfo.g_blnDrawFreeShapeDone = true;
            int intSelectedROI = 0;
            for (int j = 0; j < m_smVisionInfo.g_arrPadROIs.Count; j++)
            {
                if (j > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                if (m_smVisionInfo.g_arrPadROIs[j].Count > 0)
                {
                    if (m_smVisionInfo.g_arrPadROIs[j][2].GetROIHandle())
                    {
                        intSelectedROI = j;
                        break;
                    }
                }
            }
            //if (m_smVisionInfo.g_blnUseSameDontCareForBrightAndDark)
            //    for (int j = 0; j < 2; j++)
            //        m_smVisionInfo.g_arrPolygon_PadPackage[intSelectedROI][j].UndoPolygon();
            //else
            //    m_smVisionInfo.g_arrPolygon_PadPackage[intSelectedROI][m_smVisionInfo.g_intSelectedType].UndoPolygon();
      
            m_smVisionInfo.g_arrPolygon_PadPackage[intSelectedROI][m_smVisionInfo.g_intSelectedType][m_smVisionInfo.g_intSelectedDontCareROIIndex].UndoPolygon();
            if (chk_BrightAndDarkSameDontCareArea.Checked)
            {
                if (m_smVisionInfo.g_intSelectedType == 0)
                    m_smVisionInfo.g_arrPolygon_PadPackage[intSelectedROI][1][m_smVisionInfo.g_intSelectedDontCareROIIndex].UndoPolygon();
                else
                    m_smVisionInfo.g_arrPolygon_PadPackage[intSelectedROI][0][m_smVisionInfo.g_intSelectedDontCareROIIndex].UndoPolygon();
            }
            m_smVisionInfo.ALL_VM_UpdatePictureBox = true;
        }

        private void chk_BrightAndDarkSameDontCareArea_Click(object sender, EventArgs e)
        {
            if (!m_blnInitDone)
                return;

            // 2020 03 30 - CCENG: Dont save during change, user may cancel the form.
            //RegistryKey key = Registry.LocalMachine.OpenSubKey("Software", true);
            //RegistryKey subkey = key.CreateSubKey("SVG\\AutoMode");
            //subkey.SetValue("BrightAndDarkSameDontCareArea_PadPackage", chk_BrightAndDarkSameDontCareArea.Checked);
            m_smVisionInfo.g_blnUseSameDontCareForBrightAndDark = chk_BrightAndDarkSameDontCareArea.Checked;

            if (chk_BrightAndDarkSameDontCareArea.Checked)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPadROIs.Count; i++)
                {
                    if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                        break;

                    if (m_smVisionInfo.g_intSelectedType == 0)
                    {
                        if (SRMMessageBox.Show("Bright Field Don't Care ROI will overwrite Dark Field Dont Care ROI. Do you want to continue?",
                            "", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
                        {
                            chk_BrightAndDarkSameDontCareArea.Checked = false;
                            m_smVisionInfo.g_blnUseSameDontCareForBrightAndDark = chk_BrightAndDarkSameDontCareArea.Checked;
                            return;
                        }

                        m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Clear();
                        for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Count; j++)
                        {
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j].ClearPolygon();
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Add(new Polygon());
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j].CopyAllTo(m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j]);
                        }

                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1].Clear();
                        for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0].Count; j++)
                        {
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1].Add(new ROI());
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].LoadROISetting(
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].ref_ROIPositionX,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].ref_ROIPositionY,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].ref_ROIWidth,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].ref_ROIHeight);
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                        }
                    }
                    else
                    {
                        if (SRMMessageBox.Show("Dark Field Don't Care ROI will overwrite Bright Field Dont Care ROI. Do you want to continue?",
                            "", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
                        {
                            chk_BrightAndDarkSameDontCareArea.Checked = false;
                            m_smVisionInfo.g_blnUseSameDontCareForBrightAndDark = chk_BrightAndDarkSameDontCareArea.Checked;
                            return;
                        }

                        m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Clear();
                        for (int j = 0; j < m_smVisionInfo.g_arrPolygon_PadPackage[i][1].Count; j++)
                        {
                            //m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j].ClearPolygon();
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][0].Add(new Polygon());
                            m_smVisionInfo.g_arrPolygon_PadPackage[i][1][j].CopyAllTo(m_smVisionInfo.g_arrPolygon_PadPackage[i][0][j]);
                        }

                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0].Clear();
                        for (int j = 0; j < m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1].Count; j++)
                        {
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0].Add(new ROI());
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].LoadROISetting(
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].ref_ROIPositionX,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].ref_ROIPositionY,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].ref_ROIWidth,
                                                        m_smVisionInfo.g_arrPadPackageDontCareROIs[i][1][j].ref_ROIHeight);
                            m_smVisionInfo.g_arrPadPackageDontCareROIs[i][0][j].AttachImage(m_smVisionInfo.g_arrPadROIs[i][2]);
                        }
                    }
                }
            }
            txt_DunCareROIBright.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
            txt_DunCareROIDark.Text = m_smVisionInfo.g_arrPadPackageDontCareROIs[m_smVisionInfo.g_intSelectedROI][m_smVisionInfo.g_intSelectedType].Count.ToString();
        }

        private void DefineMostSelectedImageNo()
        {
            int[] intCountImage = { 0, 0, 0, 0, 0 };

            for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
            {
                if (i > 0 && !m_smVisionInfo.g_blnCheck4Sides)
                    break;

                int[] arrPackageSizeImageIndex = ImageDrawing.GetArrayImageIndex(m_smVisionInfo.g_arrPad[i].GetEdgeImageViewNo(), m_smVisionInfo.g_intVisionIndex);

                for (int j = 0; j < 4; j++)
                {
                    switch (arrPackageSizeImageIndex[j])
                    {
                        case 0:
                            intCountImage[0]++;
                            break;
                        case 1:
                            intCountImage[1]++;
                            break;
                        case 2:
                            intCountImage[2]++;
                            break;
                        case 3:
                            intCountImage[3]++;
                            break;
                        case 4:
                            intCountImage[4]++;
                            break;
                    }
                }
            }

            int intMostOccurValue = Math.Max(Math.Max(Math.Max(intCountImage[0], intCountImage[1]), Math.Max(intCountImage[2], intCountImage[3])), intCountImage[4]);
            m_smVisionInfo.g_intSelectedImage = Array.IndexOf(intCountImage, intMostOccurValue);
        }

        private void CheckPkgROISetting()
        {
            
            bool blnTopSame = true, blnRightSame = true, blnBottomSame = true, blnLeftSame = true;

            if (chk_SetToBrightDark.Checked)
            {
                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge_Dark)
                    blnTopSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom_Dark)
                    blnBottomSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft_Dark)
                    blnLeftSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight_Dark)
                    blnRightSame = false;
            }

            if (chk_SetToAllSideROI.Checked && m_smVisionInfo.g_arrPad.Length > 1 && m_smVisionInfo.g_blnCheck4Sides)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (m_smVisionInfo.g_intSelectedROI != 0 && i == 0)
                        continue;

                    switch (i)
                    {
                        case 0:// Center
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }

                            break;
                        case 1:// Top
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 2:// Right
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 3:// Bottom
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 4:// Left
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromLeft_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromEdge_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromEdge_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromRight_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromRight_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromBottom_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[2].ref_fPkgStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[3].ref_fPkgStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fPkgStartPixelFromBottom_Dark != m_smVisionInfo.g_arrPad[1].ref_fPkgStartPixelFromLeft_Dark))
                                        blnLeftSame = false;
                            }
                            break;

                    }
                }
            }

            bool blnSame = true;

            //if (chk_SetToAll.Checked)// && blnTopSame && blnRightSame && blnBottomSame && blnLeftSame)
            //{
            //    if ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromBottom) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromLeft) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fPkgStartPixelFromRight))
            //        blnSame = false;
            //}

            if (blnTopSame)
                lbl_PkgTop.ForeColor = Color.Black;
            else
                lbl_PkgTop.ForeColor = Color.Red;

            if (blnRightSame)
                lbl_PkgRight.ForeColor = Color.Black;
            else
                lbl_PkgRight.ForeColor = Color.Red;

            if (blnBottomSame)
                lbl_PkgBottom.ForeColor = Color.Black;
            else
                lbl_PkgBottom.ForeColor = Color.Red;

            if (blnLeftSame)
                lbl_PkgLeft.ForeColor = Color.Black;
            else
                lbl_PkgLeft.ForeColor = Color.Red;

            if (blnSame)
            {
                if (blnTopSame)
                    lbl_PkgTop.ForeColor = Color.Black;
                if (blnRightSame)
                    lbl_PkgRight.ForeColor = Color.Black;
                if (blnBottomSame)
                    lbl_PkgBottom.ForeColor = Color.Black;
                if (blnLeftSame)
                    lbl_PkgLeft.ForeColor = Color.Black;
            }
            else
            {
                lbl_PkgTop.ForeColor = Color.Red;
                lbl_PkgRight.ForeColor = Color.Red;
                lbl_PkgBottom.ForeColor = Color.Red;
                lbl_PkgLeft.ForeColor = Color.Red;
            }
            
        }
        private void CheckChippedOffOutwardROISetting()
        {

            bool blnTopSame = true, blnRightSame = true, blnBottomSame = true, blnLeftSame = true;

            if (chk_SetToBrightDark_Chip.Checked)
            {
                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromEdge_Dark)
                    blnTopSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromRight_Dark)
                    blnRightSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromBottom_Dark)
                    blnBottomSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelExtendFromLeft_Dark)
                    blnLeftSame = false;
            }

            if (chk_SetToAllSideROI_Chipped.Checked && m_smVisionInfo.g_arrPad.Length > 1 && m_smVisionInfo.g_blnCheck4Sides)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (m_smVisionInfo.g_intSelectedROI != 0 && i == 0)
                        continue;

                    switch (i)
                    {
                        case 0:// Center
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 1:// Top
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 2:// Right
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 3:// Bottom
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 4:// Left
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromEdge_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromRight_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromBottom_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelExtendFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelExtendFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelExtendFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelExtendFromLeft_Dark))
                                        blnLeftSame = false;
                            }
                            break;

                    }
                }
            }

            bool blnSame = true;

            //if (chk_SetToAll_Chipped.Checked)//  && blnTopSame && blnRightSame && blnBottomSame && blnLeftSame)
            //{
            //    if ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight))
            //        blnSame = false;
            //}

            if (blnTopSame)
            {
                lbl_ChipOutwardTop.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipOutwardTop.ForeColor = Color.Red;
            }

            if (blnRightSame)
            {
                lbl_ChipOutwardRight.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipOutwardRight.ForeColor = Color.Red;
            }

            if (blnBottomSame)
            {
                lbl_ChipOutwardBottom.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipOutwardBottom.ForeColor = Color.Red;
            }

            if (blnLeftSame)
            {
                lbl_ChipOutwardLeft.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipOutwardLeft.ForeColor = Color.Red;
            }

            if (blnSame)
            {
                if (blnTopSame)
                {
                    lbl_ChipOutwardTop.ForeColor = Color.Black;
                }
                if (blnRightSame)
                {
                    lbl_ChipOutwardRight.ForeColor = Color.Black;
                }
                if (blnBottomSame)
                {
                    lbl_ChipOutwardBottom.ForeColor = Color.Black;
                }
                if (blnLeftSame)
                {
                    lbl_ChipOutwardLeft.ForeColor = Color.Black;
                }
            }
            else
            {
                lbl_ChipOutwardTop.ForeColor = Color.Red;
                lbl_ChipOutwardRight.ForeColor = Color.Red;
                lbl_ChipOutwardBottom.ForeColor = Color.Red;
                lbl_ChipOutwardLeft.ForeColor = Color.Red;
            }

        }
        private void CheckChippedOffInwardROISetting()
        {

            bool blnTopSame = true, blnRightSame = true, blnBottomSame = true, blnLeftSame = true;

            if (chk_SetToBrightDark_Chip.Checked)
            {
                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge_Dark)
                    blnTopSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight_Dark)
                    blnRightSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom_Dark)
                    blnBottomSame = false;

                if (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft_Dark)
                    blnLeftSame = false;
            }

            if (chk_SetToAllSideROI_Chipped.Checked && m_smVisionInfo.g_arrPad.Length > 1 && m_smVisionInfo.g_blnCheck4Sides)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (m_smVisionInfo.g_intSelectedROI != 0 && i == 0)
                        continue;

                    switch (i)
                    {
                        case 0:// Center
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[0].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 1:// Top
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 2:// Right
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 3:// Bottom
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom_Dark))
                                        blnLeftSame = false;
                            }
                            break;
                        case 4:// Left
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft))
                                    blnLeftSame = false;

                            if (chk_SetToBrightDark_Chip.Checked)
                            {
                                if (blnTopSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromEdge_Dark))
                                        blnTopSame = false;

                                if (blnRightSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromBottom_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromRight_Dark))
                                        blnRightSame = false;

                                if (blnBottomSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromLeft_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromBottom_Dark))
                                        blnBottomSame = false;

                                if (blnLeftSame)
                                    if ((m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fChipStartPixelFromEdge_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fChipStartPixelFromRight_Dark) ||
                                        (m_smVisionInfo.g_arrPad[4].ref_fChipStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fChipStartPixelFromLeft_Dark))
                                        blnLeftSame = false;
                            }
                            break;

                    }
                }
            }

            bool blnSame = true;

            //if (chk_SetToAll_Chipped.Checked)//  && blnTopSame && blnRightSame && blnBottomSame && blnLeftSame)
            //{
            //    if ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromBottom) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromLeft) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fChipStartPixelFromRight))
            //        blnSame = false;
            //}

            if (blnTopSame)
            {
                lbl_ChipInwardTop.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipInwardTop.ForeColor = Color.Red;
            }

            if (blnRightSame)
            {
                lbl_ChipInwardRight.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipInwardRight.ForeColor = Color.Red;
            }

            if (blnBottomSame)
            {
                lbl_ChipInwardBottom.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipInwardBottom.ForeColor = Color.Red;
            }

            if (blnLeftSame)
            {
                lbl_ChipInwardLeft.ForeColor = Color.Black;
            }
            else
            {
                lbl_ChipInwardLeft.ForeColor = Color.Red;
            }

            if (blnSame)
            {
                if (blnTopSame)
                {
                    lbl_ChipInwardTop.ForeColor = Color.Black;
                }
                if (blnRightSame)
                {
                    lbl_ChipInwardRight.ForeColor = Color.Black;
                }
                if (blnBottomSame)
                {
                    lbl_ChipInwardBottom.ForeColor = Color.Black;
                }
                if (blnLeftSame)
                {
                    lbl_ChipInwardLeft.ForeColor = Color.Black;
                }
            }
            else
            {
                lbl_ChipInwardTop.ForeColor = Color.Red;
                lbl_ChipInwardRight.ForeColor = Color.Red;
                lbl_ChipInwardBottom.ForeColor = Color.Red;
                lbl_ChipInwardLeft.ForeColor = Color.Red;
            }

        }
        private void CheckMoldFlashOuterROISetting()
        {

            bool blnTopSame = true, blnRightSame = true, blnBottomSame = true, blnLeftSame = true;

            if (chk_SetToAllSideROI_Mold.Checked && m_smVisionInfo.g_arrPad.Length > 1 && m_smVisionInfo.g_blnCheck4Sides)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (m_smVisionInfo.g_intSelectedROI != 0 && i == 0)
                        continue;

                    switch (i)
                    {
                        case 0:// Center
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 1:// Top
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 2:// Right
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 3:// Bottom
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 4:// Left
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft))
                                    blnLeftSame = false;
                            break;

                    }
                }
            }

            bool blnSame = true;

            //if (chk_SetToAll_Mold.Checked)//  && blnTopSame && blnRightSame && blnBottomSame && blnLeftSame)
            //{
            //    if ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight))
            //        blnSame = false;
            //}

            if (blnTopSame)
                lbl_StartPixelFromEdgeOuter_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromEdgeOuter_Mold.ForeColor = Color.Red;

            if (blnRightSame)
                lbl_StartPixelFromRightOuter_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromRightOuter_Mold.ForeColor = Color.Red;

            if (blnBottomSame)
                lbl_StartPixelFromBottomOuter_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromBottomOuter_Mold.ForeColor = Color.Red;

            if (blnLeftSame)
                lbl_StartPixelFromLeftOuter_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromLeftOuter_Mold.ForeColor = Color.Red;

            if (blnSame)
            {
                if (blnTopSame)
                    lbl_StartPixelFromEdgeOuter_Mold.ForeColor = Color.Black;
                if (blnRightSame)
                    lbl_StartPixelFromRightOuter_Mold.ForeColor = Color.Black;
                if (blnBottomSame)
                    lbl_StartPixelFromBottomOuter_Mold.ForeColor = Color.Black;
                if (blnLeftSame)
                    lbl_StartPixelFromLeftOuter_Mold.ForeColor = Color.Black;
            }
            else
            {
                lbl_StartPixelFromEdgeOuter_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromRightOuter_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromBottomOuter_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromLeftOuter_Mold.ForeColor = Color.Red;
            }

        }
        private void CheckMoldFlashInnerROISetting()
        {

            bool blnTopSame = true, blnRightSame = true, blnBottomSame = true, blnLeftSame = true;

            if (chk_SetToAllSideROI_Mold.Checked && m_smVisionInfo.g_arrPad.Length > 1 && m_smVisionInfo.g_blnCheck4Sides)
            {
                for (int i = 0; i < m_smVisionInfo.g_arrPad.Length; i++)
                {
                    if (m_smVisionInfo.g_intSelectedROI != 0 && i == 0)
                        continue;

                    switch (i)
                    {
                        case 0:// Center
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[0].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 1:// Top
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 2:// Right
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 3:// Bottom
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom))
                                    blnLeftSame = false;

                            break;
                        case 4:// Left
                            if (blnTopSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromLeft != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromEdge))
                                    blnTopSame = false;

                            if (blnRightSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromBottom) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromRight))
                                    blnRightSame = false;

                            if (blnBottomSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromLeft) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromRight != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromBottom))
                                    blnBottomSame = false;

                            if (blnLeftSame)
                                if ((m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[2].ref_fMoldStartPixelFromEdge) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[3].ref_fMoldStartPixelFromRight) ||
                                    (m_smVisionInfo.g_arrPad[4].ref_fMoldStartPixelFromBottom != m_smVisionInfo.g_arrPad[1].ref_fMoldStartPixelFromLeft))
                                    blnLeftSame = false;
                            break;

                    }
                }
            }

            bool blnSame = true;

            //if (chk_SetToAll_Mold.Checked)//  && blnTopSame && blnRightSame && blnBottomSame && blnLeftSame)
            //{
            //    if ((m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromBottom) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromLeft) ||
            //                (m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromEdge != m_smVisionInfo.g_arrPad[m_smVisionInfo.g_intSelectedROI].ref_fMoldStartPixelFromRight))
            //        blnSame = false;
            //}

            if (blnTopSame)
                lbl_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;

            if (blnRightSame)
                lbl_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromRightInner_Mold.ForeColor = Color.Red;

            if (blnBottomSame)
                lbl_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;

            if (blnLeftSame)
                lbl_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
            else
                lbl_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;

            if (blnSame)
            {
                if (blnTopSame)
                    lbl_StartPixelFromEdgeInner_Mold.ForeColor = Color.Black;
                if (blnRightSame)
                    lbl_StartPixelFromRightInner_Mold.ForeColor = Color.Black;
                if (blnBottomSame)
                    lbl_StartPixelFromBottomInner_Mold.ForeColor = Color.Black;
                if (blnLeftSame)
                    lbl_StartPixelFromLeftInner_Mold.ForeColor = Color.Black;
            }
            else
            {
                lbl_StartPixelFromEdgeInner_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromRightInner_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromBottomInner_Mold.ForeColor = Color.Red;
                lbl_StartPixelFromLeftInner_Mold.ForeColor = Color.Red;
            }

        }
        private bool IsChipInwardOutwardSettingCorrect(bool blnShowMessage)
        {
            bool blnSettingOK = true;
            float fInwardLimit = 0;
            if (!float.TryParse(txt_StartPixelFromEdge_Chipped.Text, out fInwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelFromEdge_Chipped.BackColor = txt_StartPixelFromEdge_Chipped.NormalBackColor = txt_StartPixelFromEdge_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }
            }

            float fOutwardLimit = 0;
            if (!float.TryParse(txt_StartPixelExtendFromEdge_Chipped.Text, out fOutwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelExtendFromEdge_Chipped.BackColor = txt_StartPixelExtendFromEdge_Chipped.NormalBackColor = txt_StartPixelExtendFromEdge_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Outward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;

                }
            }

            if (fInwardLimit < fOutwardLimit)
            {
                blnSettingOK = false;
                txt_StartPixelFromEdge_Chipped.BackColor = txt_StartPixelFromEdge_Chipped.NormalBackColor = txt_StartPixelFromEdge_Chipped.FocusBackColor = Color.Pink;
                txt_StartPixelExtendFromEdge_Chipped.BackColor = txt_StartPixelExtendFromEdge_Chipped.NormalBackColor = txt_StartPixelExtendFromEdge_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward should not smaller than Outward. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }
            else
            {
                txt_StartPixelFromEdge_Chipped.BackColor = txt_StartPixelFromEdge_Chipped.NormalBackColor = txt_StartPixelFromEdge_Chipped.FocusBackColor = Color.White;
                txt_StartPixelExtendFromEdge_Chipped.BackColor = txt_StartPixelExtendFromEdge_Chipped.NormalBackColor = txt_StartPixelExtendFromEdge_Chipped.FocusBackColor = Color.White;
            }

            //--------------------

            fInwardLimit = 0;
            if (!float.TryParse(txt_StartPixelFromRight_Chipped.Text, out fInwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelFromRight_Chipped.BackColor = txt_StartPixelFromRight_Chipped.NormalBackColor = txt_StartPixelFromRight_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }

            fOutwardLimit = 0;
            if (!float.TryParse(txt_StartPixelExtendFromRight_Chipped.Text, out fOutwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelExtendFromRight_Chipped.BackColor = txt_StartPixelExtendFromRight_Chipped.NormalBackColor = txt_StartPixelExtendFromRight_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Outward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }

            if (fInwardLimit < fOutwardLimit)
            {
                blnSettingOK = false;
                txt_StartPixelFromRight_Chipped.BackColor = txt_StartPixelFromRight_Chipped.NormalBackColor = txt_StartPixelFromRight_Chipped.FocusBackColor = Color.Pink;
                txt_StartPixelExtendFromRight_Chipped.BackColor = txt_StartPixelExtendFromRight_Chipped.NormalBackColor = txt_StartPixelExtendFromRight_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward should not smaller than Outward. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }
            else
            {
                txt_StartPixelFromRight_Chipped.BackColor = txt_StartPixelFromRight_Chipped.NormalBackColor = txt_StartPixelFromRight_Chipped.FocusBackColor = Color.White;
                txt_StartPixelExtendFromRight_Chipped.BackColor = txt_StartPixelExtendFromRight_Chipped.NormalBackColor = txt_StartPixelExtendFromRight_Chipped.FocusBackColor = Color.White;
            }

            //--------------------

            fInwardLimit = 0;
            if (!float.TryParse(txt_StartPixelFromBottom_Chipped.Text, out fInwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelFromBottom_Chipped.BackColor = txt_StartPixelFromBottom_Chipped.NormalBackColor = txt_StartPixelFromBottom_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }

            fOutwardLimit = 0;
            if (!float.TryParse(txt_StartPixelExtendFromBottom_Chipped.Text, out fOutwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelExtendFromBottom_Chipped.BackColor = txt_StartPixelExtendFromBottom_Chipped.NormalBackColor = txt_StartPixelExtendFromBottom_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Outward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }

            if (fInwardLimit < fOutwardLimit)
            {
                blnSettingOK = false;
                txt_StartPixelFromBottom_Chipped.BackColor = txt_StartPixelFromBottom_Chipped.NormalBackColor = txt_StartPixelFromBottom_Chipped.FocusBackColor = Color.Pink;
                txt_StartPixelExtendFromBottom_Chipped.BackColor = txt_StartPixelExtendFromBottom_Chipped.NormalBackColor = txt_StartPixelExtendFromBottom_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward should not smaller than Outward. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }


            }
            else
            {
                txt_StartPixelFromBottom_Chipped.BackColor = txt_StartPixelFromBottom_Chipped.NormalBackColor = txt_StartPixelFromBottom_Chipped.FocusBackColor = Color.White;
                txt_StartPixelExtendFromBottom_Chipped.BackColor = txt_StartPixelExtendFromBottom_Chipped.NormalBackColor = txt_StartPixelExtendFromBottom_Chipped.FocusBackColor = Color.White;
            }

            //--------------------

            fInwardLimit = 0;
            if (!float.TryParse(txt_StartPixelFromLeft_Chipped.Text, out fInwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelFromLeft_Chipped.BackColor = txt_StartPixelFromLeft_Chipped.NormalBackColor = txt_StartPixelFromLeft_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;

                }

            }

            fOutwardLimit = 0;
            if (!float.TryParse(txt_StartPixelExtendFromLeft_Chipped.Text, out fOutwardLimit))
            {
                blnSettingOK = false;
                txt_StartPixelExtendFromLeft_Chipped.BackColor = txt_StartPixelExtendFromLeft_Chipped.NormalBackColor = txt_StartPixelExtendFromLeft_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Outward not correct. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;

                }

            }

            if (fInwardLimit < fOutwardLimit)
            {
                blnSettingOK = false;
                txt_StartPixelFromLeft_Chipped.BackColor = txt_StartPixelFromLeft_Chipped.NormalBackColor = txt_StartPixelFromLeft_Chipped.FocusBackColor = Color.Pink;
                txt_StartPixelExtendFromLeft_Chipped.BackColor = txt_StartPixelExtendFromLeft_Chipped.NormalBackColor = txt_StartPixelExtendFromLeft_Chipped.FocusBackColor = Color.Pink;
                if (blnShowMessage)
                {
                    SRMMessageBox.Show("Chipped Off ROI Setting - Inward should not smaller than Outward. Please set again.", "Incorrect Setting", MessageBoxButtons.OK, MessageBoxIcon.Stop);
                    return false;
                }
            }
            else
            {
                txt_StartPixelFromLeft_Chipped.BackColor = txt_StartPixelFromLeft_Chipped.NormalBackColor = txt_StartPixelFromLeft_Chipped.FocusBackColor = Color.White;
                txt_StartPixelExtendFromLeft_Chipped.BackColor = txt_StartPixelExtendFromLeft_Chipped.NormalBackColor = txt_StartPixelExtendFromLeft_Chipped.FocusBackColor = Color.White;
            }


            return blnSettingOK;
        }
    }
}